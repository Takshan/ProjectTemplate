{
	"auto_complete":
	{
		"selected_items":
		[
			[
				"Except",
				"Exception as e:\n\traise ValueError"
			],
			[
				"Da",
				"DataFrame"
			],
			[
				"file",
				"file_path"
			],
			[
				"isins",
				"isinstance(file_path, str):\n\tfile"
			],
			[
				"kwargs",
				"kwargs.get(\"match\", False)"
			],
			[
				"aut",
				"autobox[0"
			],
			[
				"verbose",
				"verbose = False"
			],
			[
				"Data",
				"DataFrame"
			],
			[
				"iter",
				"itertools.combinations"
			],
			[
				"write",
				"write_affinity"
			],
			[
				"patter",
				"pattern_id"
			],
			[
				"start",
				"startswith(\"MODEL\"):\n\ts"
			],
			[
				"elif",
				"elif algo_format.lower()"
			],
			[
				"manu",
				"manual_config_format"
			],
			[
				"cluster",
				"cluster=cluster,\n )\n else:"
			],
			[
				"dir_name",
				"dir_name_cwd"
			],
			[
				"dir",
				"dir_name"
			],
			[
				"chec",
				"check_names(manual_"
			],
			[
				"enter_out",
				"enter_output}\" if enter_output else \"\""
			],
			[
				"enter",
				"enter_output"
			],
			[
				"kwaRG",
				"kwargs.get(\""
			],
			[
				"output",
				"output= output_file_name"
			],
			[
				"Inva",
				"Invalid cluster name\"\n"
			],
			[
				"cl",
				"cluster_grp"
			],
			[
				"CUSTOM_SCORE",
				"CUSTOM_SCORE is not None and"
			],
			[
				"C",
				"CUSTOM_SCORE"
			],
			[
				"Gene",
				"Generated"
			],
			[
				"Ge",
				"Generated/"
			],
			[
				"file_",
				"file_format = \""
			],
			[
				"Va",
				"ValueError:\n\ttable.add_row(\"[bold green]"
			],
			[
				"except",
				"except ValueError:\n\t            table.add_row("
			],
			[
				"add_",
				"add_row"
			],
			[
				"tab",
				"table.add_"
			],
			[
				"excep",
				"except ValueError:\n\t"
			],
			[
				"Mol",
				"MolView"
			],
			[
				"Ser",
				"ServerPath"
			],
			[
				"Instacne",
				"isinstance"
			],
			[
				"Docking",
				"DockingTools"
			],
			[
				"KinaseMod",
				"KinaseModule import *"
			],
			[
				"setSty",
				"setStyle"
			],
			[
				"element",
				"element}\"}, {\"stick\": {\"colorscheme\": self.lig_color}"
			],
			[
				"Excep",
				"Exception as e:\n\t"
			],
			[
				"config",
				"config_file_name)\n"
			],
			[
				"mana",
				"manual_config"
			],
			[
				"manual",
				"manual_config="
			],
			[
				"clear",
				"clear_output()"
			],
			[
				"msg",
				"msg_header"
			],
			[
				"default",
				"default_checkbox"
			],
			[
				"sty",
				"style_avaiable"
			],
			[
				"view_obj",
				"view_object = self.view"
			],
			[
				"smi2",
				"smi2viewer"
			],
			[
				"entered",
				"entered_smiles"
			],
			[
				"interac",
				"interactive"
			],
			[
				"get",
				"get('size')\n"
			],
			[
				"__init",
				"__init__"
			],
			[
				"self",
				"self.box_size_z = 15\nself"
			],
			[
				"bo",
				"box_size_y"
			],
			[
				"box",
				"box_size_x"
			],
			[
				"el",
				"elif key == 'box_size_z':"
			],
			[
				"box_cen",
				"box_center_z"
			],
			[
				"box_center",
				"box_center_y"
			],
			[
				"ligand",
				"ligand = ligand\n"
			],
			[
				"inte",
				"interactive"
			]
		]
	},
	"buffers":
	[
		{
			"file": "Project.py",
			"settings":
			{
				"buffer_size": 10100,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			}
		},
		{
			"file": "DockingTools.py",
			"settings":
			{
				"buffer_size": 37840,
				"encoding": "UTF-8",
				"line_ending": "Windows"
			},
			"undo_stack":
			[
				[
					6475,
					1,
					"insert",
					{
						"characters": "\\n"
					},
					"AgAAAOw7AAAAAAAA7TsAAAAAAAAAAAAA7TsAAAAAAADuOwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADsOwAAAAAAAOw7AAAAAAAAAAAAAAAA8L8"
				],
				[
					6479,
					1,
					"black",
					null,
					"AQAAAAAAAAAAAAAAzpMAAAAAAADOkwAAIyBGdW5jdGlvbnMgaW52bG92ZWQgaW4gZG9ja2luZyB1c2luZyBzbWluYQoKaW1wb3J0IHJlCmltcG9ydCBvcwppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgaXB5d2lkZ2V0cwppbXBvcnQgaXRlcnRvb2xzCmZyb20gaXB5d2lkZ2V0cyBpbXBvcnQgKAogICAgRmlsZVVwbG9hZCwKICAgIEludFNsaWRlciwKICAgIGZpeGVkLAogICAgaW50ZXJhY3RpdmUsCiAgICBpbnRlcmFjdGl2ZV9vdXRwdXQsCiAgICB3aWRnZXRzLAogICAgTGF5b3V0LAopCmZyb20gSVB5dGhvbi5kaXNwbGF5IGltcG9ydCBIVE1MLCBkaXNwbGF5CmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHQKZnJvbSBtYXRwbG90bGliLm9mZnNldGJveCBpbXBvcnQgQW5jaG9yZWRUZXh0CmZyb20gY3NmZG9jay51dGlscyBpbXBvcnQgZ2l2ZV9pZApmcm9tIHNrbGVhcm4uZGF0YXNldHMgaW1wb3J0IG1ha2VfY2xhc3NpZmljYXRpb24KZnJvbSBza2xlYXJuLmxpbmVhcl9tb2RlbCBpbXBvcnQgTGluZWFyUmVncmVzc2lvbiwgTG9naXN0aWNSZWdyZXNzaW9uCmZyb20gc2tsZWFybi5tZXRyaWNzIGltcG9ydCBhY2N1cmFjeV9zY29yZSwgcm9jX2F1Y19zY29yZSwgcm9jX2N1cnZlCmZyb20gc2tsZWFybi5tb2RlbF9zZWxlY3Rpb24gaW1wb3J0IEtGb2xkLCB0cmFpbl90ZXN0X3NwbGl0CmZyb20gc2NpcHkuc3BlY2lhbCBpbXBvcnQgZXhwaXQKaW1wb3J0IHNlYWJvcm4gYXMgc25zCmZyb20gcmljaC5jb25zb2xlIGltcG9ydCBDb25zb2xlCgpjb25zb2xlID0gQ29uc29sZSgpCgoKZGVmIGFkZF9oeWRyb2dlbihsaXN0X3h5eik6CiAgICAiIiJBIGZ1bmN0aW9uIHRvIGFkZCBoeWRyb2dlbiBhdG9tcyB1c2luZwogICAgb3BlbmJhYmVsIHRvIGEgbGlzdCBvZiBtb2xlY3VsZXMuCiAgICBDcmVhdGVzIHN1YiBmb2xkZXIgInByb3RlaW5faWQvcG9zZXMiIGluCiAgICBpbnB1dCBmaWxlIGRpcmVjdG9yeSBhbmQgZHVtcCB0aGVyZS4KICAgIEFyZ3M6CiAgICAgICAgbGlzdF94eXogKGxpc3QpOiBNb2xlY3VsZXMgdG8gYmUgYWRkZWQgSHlkcm9nZW4KICAgIFJldHVybnM6CiAgICAgICAgeHl6OiBzYXZlcyB4eXogaW4gcHJvdGVpbl9pZC9wb3NlcyB3aXRoIHN1ZmZpeCAiX2FkZEhzLnh5eiIKICAgICIiIgogICAgIyBGT1IgU0VSVkVSIG9yIHVzZSBvd24gcGF0aC4uCiAgICBPQkFCRUxfUEFUSCA9ICIvc2hhcmUvb3BlbmJhYmVsLTMuMS4xL2Jpbi9vYmFiZWwiCiAgICBmb3IgaSBpbiBsaXN0X3h5ejoKICAgICAgICBkaXJfbmFtZSwgaWQsIGZpbGVfZm9ybWF0ID0gZ2l2ZV9pZChpKQogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmIntkaXJfbmFtZX0vYWRkSC97aWRbOjRdfSIpOgogICAgICAgICAgICBvcy5tYWtlZGlycyhmIntkaXJfbmFtZX0vYWRkSC97aWRbOjRdfSIpCiAgICAgICAgY29tbWFuZCA9IGYie09CQUJFTF9QQVRIfSB7aX0gLU8ge2Rpcl9uYW1lfS9hZGRIL3tpZFs6NF19L3tpZH1fYWRkSHMueHl6IC1oIgogICAgICAgIHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIGN3ZD1mIntkaXJfbmFtZX0iLCBzaGVsbD1UcnVlKQogICAgcmV0dXJuICJTdWNjZXNzZnVsbHkgQ29tcGxldGVkLiIKCgpkZWYgcm1zZF9jYWxjdWxhdG9yKHJlZmVyZW5jZSwgcG9zZXNfbGlzdCwga2V5PU5vbmUsIG5vbWF0Y2g9RmFsc2UsIHZlcmJvc2U9VHJ1ZSk6CiAgICAiIiJDYWxjdWxhdGVzIFJNU0QgYmV0d2VlbiByZWZlcmVuY2UgYW5kIHBvc2UgdXNpbmcgb2JybXMgaW4gc2VydmVyLgogICAgQXJnczoKICAgICAgICByZWZlcmVuY2UgKHJlZmVyZW5jZSBtb2xlY3VsZSk6IFJlZmVyZW5jZSBtb2xlY3VsZQogICAgICAgIHBvc2VzX2xpc3QgKHRlc3RfcG9zZXMpOiBMaXN0IG9mIHBvc2VzIHRvIHRlc3Qgd2l0aCB0aGUgcmVmZXJlbmNlLgogICAgICAgIGtleT0gQW55IHN1ZmZpeCB0byBhZGQgdG8gdGhlIG5hbWUgb2YgdGhlIGZpbGUuCiAgICBSZXR1cm5zOgogICAgICAgIFR4dCBmaWxlOiBXcml0ZXMgcmVmZXJlbmNlLCBwb3NlcyBuYW1lIGFuZCBSTVNEIHRvIGEgbG9nIGZpbGUuCiAgICAiIiIKICAgIGNvdW50ID0gMAogICAgdHJ5OgogICAgICAgIGZvciByZWYgaW4gcmVmZXJlbmNlOgogICAgICAgICAgICBfLCByZWZfbmFtZSwgX2RpciA9IGdpdmVfaWQocmVmKQogICAgICAgICAgICByZWZfaWQgPSBvcy5wYXRoLmJhc2VuYW1lKHJlZikKICAgICAgICAgICAgcmVmX2RpciA9IG9zLnBhdGguZGlybmFtZShyZWYpCiAgICAgICAgICAgIHJlZl9kaXIgPSBvcy5wYXRoLmRpcm5hbWUocmVmX2RpcikKICAgICAgICAgICAgZm9yIHBvc2UgaW4gcG9zZXNfbGlzdDoKICAgICAgICAgICAgICAgIHBvc2VfaWQgPSBvcy5wYXRoLmJhc2VuYW1lKHBvc2UpCiAgICAgICAgICAgICAgICBpZiByZWZfaWRbOjRdLmxvd2VyKCkgPT0gcG9zZV9pZFs6NF0ubG93ZXIoKSBvciAobm9tYXRjaCBpcyBUcnVlKToKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gZiIvc2hhcmUvb3BlbmJhYmVsLTMuMS4xL2Jpbi9vYnJtcyB7cmVmfSBcdCB7cG9zZX0iCiAgICAgICAgICAgICAgICAgICAgcG9zZV9pZCA9IG9zLnBhdGguYmFzZW5hbWUocG9zZSkKICAgICAgICAgICAgICAgICAgICBybXNkX291dCA9IHN1YnByb2Nlc3MucnVuKAogICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kLAogICAgICAgICAgICAgICAgICAgICAgICBjd2Q9ZiJ7cmVmX2Rpcn0iLAogICAgICAgICAgICAgICAgICAgICAgICBjYXB0dXJlX291dHB1dD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0PVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHNoZWxsPVRydWUsCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmIntyZWZfZGlyfS9yZXN1bHQvUk1TRCIpOgogICAgICAgICAgICAgICAgICAgICAgICBvcy5tYWtlZGlycyhmIntyZWZfZGlyfS9yZXN1bHQvUk1TRCIpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBvcGVuKAogICAgICAgICAgICAgICAgICAgICAgICBmIntyZWZfZGlyfS9yZXN1bHQvUk1TRC97cmVmX2lkWzo0XX1fUk1TRF97a2V5fS50eHQiLCAiYSsiCiAgICAgICAgICAgICAgICAgICAgKSBhcyB3cml0ZV9vdXQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHJtc2RfcmVzdWx0ID0gZiJ7cG9zZV9pZC5sb3dlcigpfVx0IiArIHN0cihybXNkX291dC5zdGRvdXQpCiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfcm1zZCA9IGYie3JlZl9uYW1lfVx0e3Bvc2VfaWQubG93ZXIoKX1cdCIgKyBzdHIoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdChybXNkX291dC5zdGRvdXQuc3BsaXQoKVstMV0pCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQocm1zZF9yZXN1bHQsIGZpbGU9d3JpdGVfb3V0KQogICAgICAgICAgICAgICAgICAgIGNvdW50ICs9IDEKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJObyBtYXRjaGVkIGhlYWRlciBmb3VuZCIKICAgICAgICBpZiB2ZXJib3NlOgogICAgICAgICAgICBwcmludChmIlRvdGFsIG9mIHtjb3VudH0gcm1zZCBjYWxjdWxhdGVkLiIpCiAgICAgICAgcmV0dXJuIHRlbXBfcm1zZAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlcjoKICAgICAgICBwcmludChlcikKCgpkZWYgcm1zZF9tYXRyaXhfcHJlcChybXNkX3Jlc3VsdHMsIHByaW50X2l0PVRydWUsIHJldHVybl9kZj1UcnVlLCBvbmx5X2Jlc3Q9RmFsc2UpOgogICAgZGVmYXVsdF9zY29yaW5nXyA9IHt9CiAgICBhZDRfc2NvcmluZ18gPSB7fQogICAgZGtvZXNfZmFzdF9zY29yaW5nXyA9IHt9CiAgICBka29lc19zY29yaW5nX29sZF9zY29yaW5nXyA9IHt9CiAgICB2aW5hX3Njb3JpbmdfID0ge30KICAgIHZpbmFyZG9fc2NvcmluZ18gPSB7fQogICAgY3VzdG9tX3Njb3JpbmdfID0ge30KICAgIGJlc3QgPSB7fQogICAgd2l0aCBvcGVuKHJtc2RfcmVzdWx0c1swXSwgInIiKSBhcyBybXNkX3Jlc3VsdHNfcmVhZDoKICAgICAgICBmb3IgY291bnQsIGxpbmUgaW4gZW51bWVyYXRlKHJtc2RfcmVzdWx0c19yZWFkKToKICAgICAgICAgICAgbGluZV9pbmZvID0gbGluZS5yc3BsaXQoIi8iKVstMV0KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAga2V5LCB2YWx1ZSA9IGxpbmVfaW5mby5zcGxpdCgiLnBkYiIpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXI6CiAgICAgICAgICAgICAgICAjIHByaW50KGVyKQogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBpZiAiX2FkNF9zY29yaW5nXyIgaW4gbGluZToKICAgICAgICAgICAgICAgIGFkNF9zY29yaW5nX1trZXldID0gdmFsdWUuc3RyaXAoKQogICAgICAgICAgICBlbGlmICJfZGVmYXVsdF8iIGluIGtleToKICAgICAgICAgICAgICAgIGRlZmF1bHRfc2NvcmluZ19ba2V5XSA9IHZhbHVlLnN0cmlwKCkKICAgICAgICAgICAgZWxpZiAiX2Rrb2VzX2Zhc3RfIiBpbiBrZXk6CiAgICAgICAgICAgICAgICBka29lc19mYXN0X3Njb3JpbmdfW2tleV0gPSB2YWx1ZS5zdHJpcCgpCiAgICAgICAgICAgIGVsaWYgIl9ka29lc19zY29yaW5nX29sZF8iIGluIGtleToKICAgICAgICAgICAgICAgIGRrb2VzX3Njb3Jpbmdfb2xkX3Njb3JpbmdfW2tleV0gPSB2YWx1ZS5zdHJpcCgpCiAgICAgICAgICAgIGVsaWYgIl92aW5hXyIgaW4ga2V5OgogICAgICAgICAgICAgICAgdmluYV9zY29yaW5nX1trZXldID0gdmFsdWUuc3RyaXAoKQogICAgICAgICAgICBlbGlmICJfdmluYXJkb18iIGluIGtleToKICAgICAgICAgICAgICAgIHZpbmFyZG9fc2NvcmluZ19ba2V5XSA9IHZhbHVlLnN0cmlwKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGN1c3RvbV9zY29yaW5nX1trZXldID0gdmFsdWUuc3RyaXAoKQogICAgICAgICMgcHJpbnQoY291bnQpCiAgICB0cnk6CiAgICAgICAgYWQ0X2RmID0gcGQuRGF0YUZyYW1lLmZyb21fZGljdCgKICAgICAgICAgICAgYWQ0X3Njb3JpbmdfLCBvcmllbnQ9ImluZGV4IiwgY29sdW1ucz0oWyJhZDRfc2NvcmluZyJdKQogICAgICAgICkKICAgICAgICBkZWZhdWx0X2RmID0gcGQuRGF0YUZyYW1lLmZyb21fZGljdCgKICAgICAgICAgICAgZGVmYXVsdF9zY29yaW5nXywgb3JpZW50PSJpbmRleCIsIGNvbHVtbnM9KFsiZGVmYXVsdF9zY29yaW5nIl0pCiAgICAgICAgKQogICAgICAgIGRrb2VzX2Zhc3RfZGYgPSBwZC5EYXRhRnJhbWUuZnJvbV9kaWN0KAogICAgICAgICAgICBka29lc19mYXN0X3Njb3JpbmdfLCBvcmllbnQ9ImluZGV4IiwgY29sdW1ucz0oWyJka29lc19mYXN0X3Njb3JpbmciXSkKICAgICAgICApCiAgICAgICAgZGtvZXNfc2NvcmluZ19vbGRfZGYgPSBwZC5EYXRhRnJhbWUuZnJvbV9kaWN0KAogICAgICAgICAgICBka29lc19mYXN0X3Njb3JpbmdfLCBvcmllbnQ9ImluZGV4IiwgY29sdW1ucz0oWyJka29lc19mYXN0X3Njb3JpbmciXSkKICAgICAgICApCiAgICAgICAgdmluYV9kZiA9IHBkLkRhdGFGcmFtZS5mcm9tX2RpY3QoCiAgICAgICAgICAgIHZpbmFfc2NvcmluZ18sIG9yaWVudD0iaW5kZXgiLCBjb2x1bW5zPShbInZpbmFfc2NvcmluZyJdKQogICAgICAgICkKICAgICAgICB2aW5hcmRvX2RmID0gcGQuRGF0YUZyYW1lLmZyb21fZGljdCgKICAgICAgICAgICAgdmluYXJkb19zY29yaW5nXywgb3JpZW50PSJpbmRleCIsIGNvbHVtbnM9KFsidmluYXJkb19zY29yaW5nIl0pCiAgICAgICAgKQogICAgICAgIGN1c3RvbV9kZiA9IHBkLkRhdGFGcmFtZS5mcm9tX2RpY3QoCiAgICAgICAgICAgIGN1c3RvbV9zY29yaW5nXywgb3JpZW50PSJpbmRleCIsIGNvbHVtbnM9KFsiY3VzdG9tX3Njb3JpbmciXSkKICAgICAgICApCiAgICAgICAgcmV0dXJuX2RmID0gcGQuY29uY2F0KAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICBhZDRfZGYsCiAgICAgICAgICAgICAgICBkZWZhdWx0X2RmLAogICAgICAgICAgICAgICAgZGtvZXNfZmFzdF9kZiwKICAgICAgICAgICAgICAgIGRrb2VzX3Njb3Jpbmdfb2xkX2RmLAogICAgICAgICAgICAgICAgdmluYV9kZiwKICAgICAgICAgICAgICAgIHZpbmFyZG9fZGYsCiAgICAgICAgICAgICAgICBjdXN0b21fZGYsCiAgICAgICAgICAgIF0KICAgICAgICApCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGVyOgogICAgICAgIHByaW50KGYie2VyfVxuIGVycm9yIGluIGRhdGEgZnJhbWUiKQogICAgaWYgcHJpbnRfaXQ6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBhZDRfYmVzdCA9IG1pbihhZDRfc2NvcmluZ18uaXRlbXMoKSwga2V5PWxhbWJkYSB4OiB4WzFdKQogICAgICAgICAgICBwcmludCgiPT09PT09PT09PT1CRVNUIFJNU0Q9PT09PT09PT09PT09PT09PT09IikKICAgICAgICAgICAgYmVzdFthZDRfYmVzdFswXV0gPSBhZDRfYmVzdFsxXQogICAgICAgICAgICBwcmludChmInthZDRfYmVzdFswXX0gOiB7YWQ0X2Jlc3RbMV19IikKICAgICAgICAgICAgZGVmYXVsdF9iZXN0ID0gbWluKGRlZmF1bHRfc2NvcmluZ18uaXRlbXMoKSwga2V5PWxhbWJkYSB4OiB4WzFdKQogICAgICAgICAgICBiZXN0W2RlZmF1bHRfYmVzdFswXV0gPSBkZWZhdWx0X2Jlc3RbMV0KICAgICAgICAgICAgcHJpbnQoZiJ7ZGVmYXVsdF9iZXN0WzBdfSA6IHtkZWZhdWx0X2Jlc3RbMV19IikKICAgICAgICAgICAgZGtvZXNfZmFzdF9iZXN0ID0gbWluKGRrb2VzX2Zhc3Rfc2NvcmluZ18uaXRlbXMoKSwga2V5PWxhbWJkYSB4OiB4WzFdKQogICAgICAgICAgICBiZXN0W2Rrb2VzX2Zhc3RfYmVzdFswXV0gPSBka29lc19mYXN0X2Jlc3RbMV0KICAgICAgICAgICAgcHJpbnQoZiJ7ZGtvZXNfZmFzdF9iZXN0WzBdfSA6IHtka29lc19mYXN0X2Jlc3RbMV19IikKICAgICAgICAgICAgZGtvZXNfc2NvcmluZ19vbGRfYmVzdCA9IG1pbigKICAgICAgICAgICAgICAgIGRrb2VzX3Njb3Jpbmdfb2xkX3Njb3JpbmdfLml0ZW1zKCksIGtleT1sYW1iZGEgeDogeFsxXQogICAgICAgICAgICApCiAgICAgICAgICAgIGJlc3RbZGtvZXNfc2NvcmluZ19vbGRfYmVzdFswXV0gPSBka29lc19zY29yaW5nX29sZF9iZXN0WzFdCiAgICAgICAgICAgIHByaW50KGYie2Rrb2VzX3Njb3Jpbmdfb2xkX2Jlc3RbMF19IDp7ZGtvZXNfc2NvcmluZ19vbGRfYmVzdFsxXX0iKQogICAgICAgICAgICB2aW5hX2Jlc3QgPSBtaW4odmluYV9zY29yaW5nXy5pdGVtcygpLCBrZXk9bGFtYmRhIHg6IHhbMV0pCiAgICAgICAgICAgIGJlc3RbdmluYV9iZXN0WzBdXSA9IHZpbmFfYmVzdFsxXQogICAgICAgICAgICBwcmludChmInt2aW5hX2Jlc3RbMF19IDoge3ZpbmFfYmVzdFsxXX0iKQogICAgICAgICAgICB2aW5hcmRvX2Jlc3QgPSBtaW4odmluYXJkb19zY29yaW5nXy5pdGVtcygpLCBrZXk9bGFtYmRhIHg6IHhbMV0pCiAgICAgICAgICAgIGJlc3RbdmluYXJkb19iZXN0WzBdXSA9IHZpbmFyZG9fYmVzdFsxXQogICAgICAgICAgICBwcmludChmInt2aW5hcmRvX2Jlc3RbMF19IDoge3ZpbmFyZG9fYmVzdFstMV19IikKICAgICAgICAgICAgY3VzdG9tX2Jlc3QgPSBtaW4oY3VzdG9tX3Njb3JpbmdfLml0ZW1zKCksIGtleT1sYW1iZGEgeDogeFsxXSkKICAgICAgICAgICAgYmVzdFtjdXN0b21fYmVzdFswXV0gPSBjdXN0b21fYmVzdFsxXQogICAgICAgICAgICBwcmludChmIntjdXN0b21fYmVzdFswXX0gOiB7Y3VzdG9tX2Jlc3RbMV19IikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGVyOgogICAgICAgICAgICBwcmludChlcikKICAgIGlmIG9ubHlfYmVzdDoKICAgICAgICByZXR1cm4gYmVzdAogICAgaWYgcmV0dXJuX2RmIGlzIFRydWU6CiAgICAgICAgcmV0dXJuIHJldHVybl9kZgogICAgZWxzZToKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBkZWZhdWx0X3Njb3JpbmdfLAogICAgICAgICAgICBhZDRfc2NvcmluZ18sCiAgICAgICAgICAgIGRrb2VzX2Zhc3Rfc2NvcmluZ18sCiAgICAgICAgICAgIGRrb2VzX3Njb3Jpbmdfb2xkX3Njb3JpbmdfLAogICAgICAgICAgICB2aW5hX3Njb3JpbmdfLAogICAgICAgICAgICB2aW5hcmRvX3Njb3JpbmdfLAogICAgICAgICAgICBjdXN0b21fc2NvcmluZ18sCiAgICAgICAgKQoKCmRlZiBjb25mb3JtZXJfc3BsaXQoZmlsZW5hbWVzLCB0YXJnZXQpOgogICAgZm9yIGkgaW4gZmlsZW5hbWVzOgogICAgICAgIGZpbGVfZGlyLCBmaWxlX2lkLCBmaWxlX2Zvcm1hdCA9IGdpdmVfaWQoaSkKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoZiJ7ZmlsZV9kaXJ9L3Bvc2VzIik6CiAgICAgICAgICAgIG9zLm1ha2VkaXJzKGYie2ZpbGVfZGlyfS9wb3NlcyIpCiAgICAgICAgY29tbWFuZCA9ICgKICAgICAgICAgICAgZiIvc2hhcmUvb3BlbmJhYmVsLTMuMS4xL2Jpbi9vYmFiZWwge2l9IC1ve3RhcmdldH0gLU8iCiAgICAgICAgICAgIGYiIC4vcG9zZXMve2ZpbGVfaWR9Xy57dGFyZ2V0fSAtbSIKICAgICAgICApCiAgICAgICAgc3VicHJvY2Vzcy5ydW4oY29tbWFuZCwgY3dkPWYie2ZpbGVfZGlyfSIsIHNoZWxsPVRydWUpCiAgICByZXR1cm4gIlN1Y2Nlc3NmdWxseSBjb21wbGV0ZWQuIgoKCmRlZiBzbWluYV9oaXN0b2dyYW0oc29ydGVkX1JFUywgc2F2ZT1GYWxzZSk6CiAgICAiIiJDcmVhdGVzIGhpc3RvZ3JhbSBvZiBkb2NraW5nIGZyb20gc21pbmEgb3V0cHV0CiAgICBBcmdzOgogICAgICAgIHNvcnRlZF9SRVMgKGxpc3QpOiBTb3J0ZWQgbGlzdCBvZiBhZmZpbml0eSB2YWx1ZXMgZnJvbSBzbWluYSBvdXRwdXQuCiAgICAgICAgc2F2ZSAoYm9vbCwgb3B0aW9uYWwpOiBTYXZlIHBsb3QgaW4gLi9pbWFnZS9zbWluYV9oaXN0b2dyYW0ucG5nCiAgICAiIiIKICAgIG5hbWUsIGJlbmVyZ3kgPSB6aXAoKnNvcnRlZF9SRVMuaXRlbXMoKSkKICAgIGJlbmVyZ3kgPSBucC5hcnJheSgoYmVuZXJneSksIGR0eXBlPW5wLmZsb2F0MzIpCiAgICBtZWFuID0gYmVuZXJneS5tZWFuKCkKICAgIGJlc3QgPSBiZW5lcmd5Lm1pbigpCiAgICB3b3JzdCA9IGJlbmVyZ3kubWF4KCkKICAgIGZpZywgYXhzID0gcGx0LnN1YnBsb3RzKDEsIHNoYXJleT1GYWxzZSwgc2hhcmV4PUZhbHNlLCB0aWdodF9sYXlvdXQ9VHJ1ZSkKICAgIGF4cy5hZGRfYXJ0aXN0KAogICAgICAgIEFuY2hvcmVkVGV4dCgKICAgICAgICAgICAgZiJUb3RhbDoge2xlbihuYW1lKX1cbk1lYW46IHttZWFuOi4yZn1cbkJlc3Q6IHtiZXN0Oi4yZn1cbldvcnN0OiIKICAgICAgICAgICAgZiIge3dvcnN0Oi4yZn0iLAogICAgICAgICAgICBsb2M9MSwKICAgICAgICApCiAgICApCiAgICBheHMuaGlzdChiZW5lcmd5KQogICAgYXhzLnlheGlzLnNldF9sYWJlbF90ZXh0KCJOdW1iZXIgb2YgRGF0YXNldHMiKQogICAgYXhzLnhheGlzLnNldF9sYWJlbF90ZXh0KCJCaW5kaW5nIEVuZXJneSBSYW5nZSIpCiAgICBheHMuc2V0X3RpdGxlKCJEaXN0cmlidXRpb24gb2YgYmluZGluZyBlbmVyZ3kiKQogICAgaWYgc2F2ZToKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoIi4vaW1hZ2VzIik6CiAgICAgICAgICAgIG9zLm1ha2VkaXJzKCIuL2ltYWdlcyIpCiAgICAgICAgcGx0LnNhdmVmaWcoIi4vaW1hZ2VzL3NtaW5hX2hpc3RvZ3JhbS5wbmciLCBkcGk9NjAwKQogICAgcGx0LnNob3coKQoKCmRlZiBzbWluYV9tb25pdG9yKHNtaW5hX291dHB1dF9tb25pdG9yLCBwbG90PUZhbHNlLCBzYXZlPUZhbHNlKToKICAgICIiIkRpc3BsYXkgc21pbmEgcHJvY2VzcyB3aGlsZSBlbnRlciBzbWluYSBzdGRvdXQKICAgIEFyZ3M6CiAgICAgICAgc21pbmFfb3V0cHV0X21vbml0b3IgKHN0ZG91dCk6IHN0ZG91dCBmcm9tIHFzdGF0L3FzdWIKICAgIFJldHVybnM6CiAgICAgICAgZGljdDogRGlzcGxheXMgcmVzdWx0IGluIGp1cHl0ZXIKICAgICIiIgogICAgUkVTID0ge30KICAgIGNvdW50ID0gMAogICAgZm9yIGkgaW4gc21pbmFfb3V0cHV0X21vbml0b3I6CiAgICAgICAgYWxnb19kaXIsIGFsZ29fbmFtZSwgYWxnb19mb3JtYXQgPSBnaXZlX2lkKGkpCiAgICAgICAgaWYgYWxnb19mb3JtYXQubG93ZXIoKSA9PSAicGRiIjoKICAgICAgICAgICAgd2l0aCBvcGVuKGksICJyIikgYXMgcmVhZF9zbWluYToKICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIHJlYWRfc21pbmE6CiAgICAgICAgICAgICAgICAgICAgaWYgbGluZVs6NV0gPT0gIk1PREVMIjoKICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyID0gbGluZVs1Ol0uc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIGVsaWYgIlJFTUFSSyIgaW4gbGluZToKICAgICAgICAgICAgICAgICAgICAgICAgZW5lcmd5ID0gZmxvYXQobGluZS5yc3BsaXQoIiAiKVstMV0uc3RyaXAoKSkKICAgICAgICAgICAgICAgICAgICAgICAgUkVTW2Yie2FsZ29fbmFtZX1fe251bWJlcn0iXSA9IGYie2VuZXJneX0iCiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ICs9IDEKICAgICAgICBlbGlmIGFsZ29fZm9ybWF0Lmxvd2VyKCkgPT0gInNkZiI6CiAgICAgICAgICAgIHBhdHRlcm5faWQgPSByIl5bYS16QS1aXVxTIgogICAgICAgICAgICBwYXR0ZXJuX2FmZmluaXR5ID0gciJePlxzPFthLXpBLVpdKz4iCiAgICAgICAgICAgIHdpdGggb3BlbihpLCAiciIpIGFzIHJlYWRfc21pbmE6CiAgICAgICAgICAgICAgICB3cml0ZV9hZmZpbml0eSA9IEZhbHNlCiAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiByZWFkX3NtaW5hOgogICAgICAgICAgICAgICAgICAgIGlmIHdyaXRlX2FmZmluaXR5OgogICAgICAgICAgICAgICAgICAgICAgICBlbmVyZ3kgPSBmbG9hdChsaW5lLnN0cmlwKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICMgcHJpbnQoZW5lcmd5KQogICAgICAgICAgICAgICAgICAgICAgICBSRVNbZiJ7YWxnb19uYW1lfV97bnVtYmVyfSJdID0gZiJ7ZW5lcmd5fSIKICAgICAgICAgICAgICAgICAgICAgICAgY291bnQgKz0gMQogICAgICAgICAgICAgICAgICAgICAgICB3cml0ZV9hZmZpbml0eSA9IEZhbHNlCiAgICAgICAgICAgICAgICAgICAgaWYgcmUubWF0Y2gocGF0dGVybl9pZCwgbGluZSk6CiAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlciA9IGxpbmUuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIGVsaWYgcmUubWF0Y2gocGF0dGVybl9hZmZpbml0eSwgbGluZSk6CiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlX2FmZmluaXR5ID0gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAiRmlsZSBmb3JtYXQgbm90IHN1cHBvcnRlZCB5ZXQuIFsncGRiJywgJ3NkZiddIgoKICAgIHByaW50KGYiVG90YWwgbnVtYmVyIG9mIHBvc2VzIGdlbmVyYXRlZDoge2NvdW50fSIpCiAgICBzb3J0ZWRfUkVTID0gZGljdChzb3J0ZWQoUkVTLml0ZW1zKCksIGtleT1sYW1iZGEgeDogeFsxXSkpCiAgICBwcmludCgiX19fX19fX19fX19fX0RldGFpbCBsaXN0X19fX19fX19fX19fX19fX1xuIikKICAgIGZvciBrZXksIHZhbHVlIGluIHNvcnRlZF9SRVMuaXRlbXMoKToKICAgICAgICBwcmludChrZXksICI6IiwgdmFsdWUpCiAgICBpZiBwbG90OgogICAgICAgIHNtaW5hX2hpc3RvZ3JhbShzb3J0ZWRfUkVTLCBzYXZlPXNhdmUpCgogICAgcmV0dXJuIHNvcnRlZF9SRVMKCgpkZWYgYXVjX3Bsb3QobW9kZWwsIFhfdGVzdCwgeV90ZXN0LCBzYXZlPUZhbHNlKToKICAgICIiIlBsb3QgQVVDIHBsb3QgZnJvbSBtb2RlbCwgYW5kIFhfdGV4dChkYXRhIHBvaW50KSB5X3Rlc3QobGFiZWwpLgogICAgQXJnczoKICAgICAgICBtb2RlbCAoc2tsZWFybiBvYmopXzogTW9kZWwgb2JqZWN0IGZyb20gc2tsZWFybiB0cmFpbmVkIG1vZGVsLgogICAgICAgIFhfdGVzdCAocGQuRGF0YUZyYW1lKTogRGF0YSBwb2ludCBmb3IgdGVzdC4KICAgICAgICB5X3Rlc3QgKHBkLkRhdGFGcmFtZSk6IExhYmVsIGZvciB0aGUgZGF0YSBwb2ludC4KICAgICAgICBzYXZlIChib29sLCBvcHRpb25hbCk6IFNhdmUgQVVDIHBsb3QuCiAgICAiIiIKICAgICMgYXNzZXJ0IGlzaW5zdGFuY2UobW9kZWwsIExpbmVhclJlZ3Jlc3Npb24pLCBmInttb2RlbH0gaXMgbm90IGEgdmFsaWQgbW9kZWwiCiAgICAjIGFzc2VydCBpc2luc3RhbmNlKFhfdGVzdCwgcGQuRGF0YUZyYW1lKSwgZiJ7WF90ZXN0fSBpcyBub3QgYSBEYXRhRnJhbWUiCiAgICAjIGFzc2VydCBpc2luc3RhbmNlKHlfdGVzdCwgcGQuRGF0YUZyYW1lKSwgZiJ7eV90ZXN0fSBpcyBub3QgYSBEYXRhRnJhbWUiCiAgICBtb2RlbF9yZWdyZXNzaW9uX3Byb2JhYmlsaXR5ID0gbW9kZWwucHJlZGljdF9wcm9iYShYX3Rlc3QpCiAgICBtb2RlbF9yZWdyZXNzaW9uX3Byb2JhYmlsaXR5ID0gbW9kZWxfcmVncmVzc2lvbl9wcm9iYWJpbGl0eVs6LCAxXQogICAgcmFuZG9tX3Byb2JhYmlsaXR5ID0gWzAgZm9yIF8gaW4gcmFuZ2UobGVuKHlfdGVzdCkpXQogICAgcmFuZG9tX2F1YyA9IHJvY19hdWNfc2NvcmUoeV90ZXN0LCByYW5kb21fcHJvYmFiaWxpdHkpCiAgICBtb2RlbF9hdWMgPSByb2NfYXVjX3Njb3JlKHlfdGVzdCwgbW9kZWxfcmVncmVzc2lvbl9wcm9iYWJpbGl0eSkKICAgIHByaW50KGYiUmFuZG9tOiBST0MgQVVDPXtyYW5kb21fYXVjfSIpCiAgICBwcmludChmIk1vZGVsOiBST0MgQVVDPXttb2RlbF9hdWN9IikKICAgIHJhbmRvbV9mYWxzZV9wb3NpdGl2ZV9yYXRlLCByYW5kb21fdHJ1ZV9wb3NpdGl2ZV9yYXRlLCBfID0gcm9jX2N1cnZlKAogICAgICAgIHlfdGVzdCwgcmFuZG9tX3Byb2JhYmlsaXR5CiAgICApCiAgICBtb2RlbF9mYWxzZV9wb3NpdGl2ZV9yYXRlLCBtb2RlbF90cnVlX3Bvc2l0aXZlX3JhdGUsIF8gPSByb2NfY3VydmUoCiAgICAgICAgeV90ZXN0LCBtb2RlbF9yZWdyZXNzaW9uX3Byb2JhYmlsaXR5CiAgICApCiAgICBwbHQucGxvdCgKICAgICAgICByYW5kb21fZmFsc2VfcG9zaXRpdmVfcmF0ZSwKICAgICAgICByYW5kb21fdHJ1ZV9wb3NpdGl2ZV9yYXRlLAogICAgICAgIGxpbmVzdHlsZT0iLS0iLAogICAgICAgIGxhYmVsPSJSYW5kb20iLAogICAgKQogICAgcGx0LnBsb3QoCiAgICAgICAgbW9kZWxfZmFsc2VfcG9zaXRpdmVfcmF0ZSwKICAgICAgICBtb2RlbF90cnVlX3Bvc2l0aXZlX3JhdGUsCiAgICAgICAgbWFya2VyPSIuIiwKICAgICAgICBsYWJlbD1mIk1vZGVsIChBVUM6e21vZGVsX2F1YzouMmZ9KSIsCiAgICApCiAgICBwbHQueGxhYmVsKCJGYWxzZSBQb3NpdGl2ZSBSYXRlIikKICAgIHBsdC55bGFiZWwoIlRydWUgUG9zaXRpdmUgUmF0ZSIpCiAgICBwbHQueGxpbSh4bWluPTAuMCkKICAgIHBsdC55bGltKHltaW49MC4wKQogICAgcGx0LnRpdGxlKCJST0MiKQogICAgcGx0LmxlZ2VuZCgpCiAgICBpZiBzYXZlOgogICAgICAgIHByZWZpeCA9ICJpbWFnZSIKICAgICAgICB3aGlsZSBvcy5wYXRoLmV4aXN0cyhmIi4vR2VuZXJhdGVkL2ltYWdlcy97cHJlZml4fS5wbmciKToKICAgICAgICAgICAgc3VmZml4ICs9IDEKICAgICAgICAgICAgbmFtZSA9IGYie3ByZWZpeH17c3VmZml4fS5wbmciCiAgICAgICAgcGx0LnNhdmVmaWcoIi4vR2VuZXJhdGVkL2ltYWdlcy97bmFtZX0iLCBkcGk9NjAwKQogICAgcGx0LnNob3coKQoKCmRlZiBzbWluYV9tb2RlbF9zY29yZSgKICAgIGZpbGVfcGF0aCwKICAgIG51bV9mZWF0dXJlcz0zLAogICAgaW50ZXJjZXB0PUZhbHNlLAogICAgdHNpemU9MC4zLAogICAgcGxvdF9hdWM9RmFsc2UsCiAgICBwbG90X3NhdmU9RmFsc2UsCik6CiAgICAiIiJHZW5lcmF0ZXMgcmVncmVzc2lvbiBtb2RlbCB1c2luZyBza2xlYXJuLiBXaWxsIFByaW50IG91dCBjb2VmZmljaWVudHMKICAgIEFyZ3M6CiAgICAgICAgZmlsZV9wYXRoIChzdHIpOiBjc3YvZXhjZWwgZmlsZSBwYXRoCiAgICAgICAgbnVtX2ZlYXR1cmVzIChpbnQsIG9wdGlvbmFsKTogTnVtYmVyIG9mIGZlYXR1cmVzIHRvIHVzZS4gRGVmYXVsdDogMwogICAgICAgIGludGVyY2VwdCAoYm9vbCwgb3B0aW9uYWwpOiBNZWFuIEVycm9yCiAgICAgICAgdHNpemUgKGZsb2F0LCBvcHRpb25hbCk6IFBlcmNlbnRhZ2Ugb2YgZGF0YXRvIHVzZSBmb3IgdGVzdC4gRGVmYXVsdCAwLjMoMzAlKQogICAgICAgIHBsb3RfYXVjIChib29sLCBvcHRpb25hbCk6IFBsb3QgUk9DIEFVQyBjdXJ2ZQogICAgICAgIHBsb3Rfc2F2ZSAoYm9vbCwgb3B0aW9uYWwpOiBTYXZlIFJPQyBBVUMgcGxvdAogICAgIiIiCiAgICB0cnk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShmaWxlX3BhdGgsIHN0cik6CiAgICAgICAgICAgIGZpbGVfZGlyLCBmaWxlX25hbWUsIGZpbGVfZm9ybWF0ID0gZ2l2ZV9pZChmaWxlX3BhdGgpCiAgICAgICAgICAgIHN1cHBvcnRlZF9maWxlX2Zvcm1hdCA9IFsiY3N2IiwgImV4Y2VsIl0gICMgZm9yIG5vdyB8IHNtaW5hIHJlc3VsdCBmaWxlCiAgICAgICAgICAgIGFzc2VydCBmaWxlX2Zvcm1hdCBpbiBzdXBwb3J0ZWRfZmlsZV9mb3JtYXQsICgKICAgICAgICAgICAgICAgICJOb3RlOiBGaWxlVHlwZSBFcnJvcjogTm90IHN1cHBvcnRlZCBmaWxlIGZvcm1hdC4gVXNlIgogICAgICAgICAgICAgICAgZiIge3N1cHBvcnRlZF9maWxlX2Zvcm1hdH0iCiAgICAgICAgICAgICkKICAgICAgICAgICAgaWYgZmlsZV9mb3JtYXQgPT0gImV4Y2VsIjoKICAgICAgICAgICAgICAgIGRmID0gcGQucmVhZF9leGNlbChmaWxlX3BhdGgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBkZiA9IHBkLnJlYWRfY3N2KGZpbGVfcGF0aCkKCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZSkKCiAgICBpZiBpc2luc3RhbmNlKGZpbGVfcGF0aCwgcGQuRGF0YUZyYW1lKToKICAgICAgICBkZiA9IGZpbGVfcGF0aAogICAgdHJ5OgogICAgICAgIFgsIHkgPSBkZi5pbG9jWzE6LCAxOi0yXSwgZGYuaWxvY1sxOiwgLTFdCiAgICAgICAgWCA9IHBkLkRhdGFGcmFtZShYKQogICAgICAgIGhlYWRlciA9IFguaWxvY1s6MCwgOl0KICAgICAgICBYLCB5ID0gbWFrZV9jbGFzc2lmaWNhdGlvbihuX2ZlYXR1cmVzPW51bV9mZWF0dXJlcykKICAgICAgICBYX3RyYWluLCBYX3Rlc3QsIHlfdHJhaW4sIHlfdGVzdCA9IHRyYWluX3Rlc3Rfc3BsaXQoCiAgICAgICAgICAgIFgsIHksIHRlc3Rfc2l6ZT10c2l6ZQogICAgICAgICkgICMgVE9ETyAvL2luY2x1ZGUgSy1Gb2xkIFRlc3QKICAgICAgICBtb2RlbCA9IExvZ2lzdGljUmVncmVzc2lvbihmaXRfaW50ZXJjZXB0PWludGVyY2VwdCkKICAgICAgICBtb2RlbC5maXQoWF90cmFpbiwgeV90cmFpbikgICMgVE9ET0QgYWNjZXB0IHVzZSBtb2RlbCBpbnB1dAogICAgICAgIHdlaWdodCA9IG1vZGVsLmNvZWZfCiAgICAgICAgd2VpZ2h0ID0gW2l0ZW0gZm9yIGkgaW4gd2VpZ2h0IGZvciBpdGVtIGluIGldCiAgICAgICAgY29uc29sZS5wcmludCgiW2JvbGQgY3lhbl1Nb2RlbCB3ZWlnaHRzIGFyZSA6flsvYm9sZCBjeWFuXVxuIikKICAgICAgICBmb3IgaGVhZCwgY29lZmYgaW4gemlwKGhlYWRlciwgd2VpZ2h0KToKICAgICAgICAgICAgcHJpbnQoY29lZmYsIGhlYWQsIGVuZD0iXG4iKQogICAgICAgIG1vZGVsLnByZWRpY3QoWF90ZXN0KQogICAgICAgIG1vZGVsLnByZWRpY3RfcHJvYmEoWF90ZXN0KQogICAgICAgIHNjb3JlID0gbW9kZWwuc2NvcmUoWF90ZXN0LCB5X3Rlc3QpCiAgICAgICAgcHJpbnQoZiJNb2RlbCBzY29yZToge3Njb3JlfSIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGVyOgogICAgICAgIHByaW50KGVyKQogICAgaWYgcGxvdF9hdWM6CiAgICAgICAgYXVjX3Bsb3QobW9kZWwsIFhfdGVzdCwgeV90ZXN0LCBzYXZlPXBsb3Rfc2F2ZSkKICAgICAgICAjIHRyYWluX3Bsb3QobW9kZWwsIFgsIHksIFhfdGVzdCwgeV90ZXN0KQogICAgcmV0dXJuIG1vZGVsCgoKZGVmIHRyYWluX3Bsb3QobW9kZWwsIFgsIHksIFhfdGVzdCwgeV90ZXN0KToKICAgIHBsdC5maWd1cmUoMSwgZmlnc2l6ZT0oNCwgMykpCiAgICBwbHQuY2xmKCkKICAgIHByaW50KGxlbihYKSkKICAgIHByaW50KGxlbih5KSkKICAgIHBsdC5zY2F0dGVyKFgucmF2ZWwoKSwgeSwgY29sb3I9ImJsYWNrIiwgem9yZGVyPTIwKQogICAgIyBwbHQuc2NhdHRlcih5X3Rlc3QsIFhfdGVzdC5pbG9jWzosMF0udmFsdWVzKQogICAgbG9zcyA9IGV4cGl0KFhfdGVzdCAqIG1vZGVsLmNvZWZfICsgbW9kZWwuaW50ZXJjZXB0XykucmF2ZWwoKQogICAgcGx0LnBsb3QoWF90ZXN0LCBsb3NzLCBjb2xvcj0icmVkIiwgbGluZXdpZHRoPTMpCgogICAgb2xzID0gTGluZWFyUmVncmVzc2lvbigpCiAgICBvbHMuZml0KFgsIHkpCiAgICBwbHQucGxvdChYX3Rlc3QsIG9scy5jb2VmXyAqIFhfdGVzdCArIG9scy5pbnRlcmNlcHRfLCBsaW5ld2lkdGg9MSkKICAgIHBsdC5heGhsaW5lKDAuNSwgY29sb3I9Ii41IikKCiAgICBwbHQueWxhYmVsKCJ5IikKICAgIHBsdC54bGFiZWwoIlgiKQogICAgcGx0Lnh0aWNrcyhyYW5nZSgtNSwgMTApKQogICAgcGx0Lnl0aWNrcyhbMCwgMC41LCAxXSkKICAgIHBsdC55bGltKC0wLjI1LCAxLjI1KQogICAgcGx0LnhsaW0oLTQsIDEwKQogICAgcGx0LmxlZ2VuZCgKICAgICAgICAoIkxvZ2lzdGljIFJlZ3Jlc3Npb24gTW9kZWwiLCAiTGluZWFyIFJlZ3Jlc3Npb24gTW9kZWwiKSwKICAgICAgICBsb2M9Imxvd2VyIHJpZ2h0IiwKICAgICAgICBmb250c2l6ZT0ic21hbGwiLAogICAgKQogICAgcGx0LnRpZ2h0X2xheW91dCgpCiAgICBwbHQuc2hvdygpCgoKZGVmIGlucHV0X2N1c3RvbV9zY29yaW5nKCk6CiAgICAiIiJHVUkgd2luZG93IHRvIGVudGVyIGN1c3RvbSBzY29yaW5nIGZ1bmN0aW9uIiIiCiAgICAjIGluaXRpYWxpemUgc29tZSBtc2cgYW5kIG91dHB1dCBlbnYKICAgIG91dHB1dF9jc2YgPSB3aWRnZXRzLk91dHB1dCgpCiAgICBtc2dfZW1wdHlfbmFtZSA9ICJFbnRlciBhbnkgbmFtZSBmb3IgdGhlIGZpbGUuIgogICAgd2Fybl9lbXB0eV9uYW1lID0gd2lkZ2V0cy5IVE1MKHZhbHVlPWYiPGI+PGZvbnQgY29sb3I9J3JlZCc+e21zZ19lbXB0eV9uYW1lfTwvYj4iKQogICAgIyBzYXZlIHRoZSBpbnB1dCBjdXN0b20gc2NvcmluZyB2YWx1ZQogICAgZGVmIHNhdmVfc2NvcmluZyhkYXRhKToKICAgICAgICBvdXRwdXRfY3NmLmNsZWFyX291dHB1dCgpCiAgICAgICAgbXNnX2NvbmZpcm1fd2FybiA9ICJQbGVhc2UgY29uZmlybSBpZiB0aGUgdmFsdWVzIGFyZSByaWdodC4iCiAgICAgICAgaW5mb3JtYXRpb24gPSBpcHl3aWRnZXRzLndpZGdldHMuSFRNTCgKICAgICAgICAgICAgdmFsdWU9ZiI8Yj48Zm9udCBjb2xvcj0ncmVkJz57bXNnX2NvbmZpcm1fd2Fybn08L2I+IgogICAgICAgICkKICAgICAgICBnbG9iYWwgc2NvcmluZ19kYXRhCiAgICAgICAgZ2xvYmFsIHRlbXBfbmFtZQogICAgICAgIHRlbXBfbmFtZSA9IGZpbGVfbmFtZS52YWx1ZQogICAgICAgIGlmIG5vdCB0ZW1wX25hbWU6CiAgICAgICAgICAgIHdpdGggb3V0cHV0X2NzZjoKICAgICAgICAgICAgICAgIGRpc3BsYXkod2Fybl9lbXB0eV9uYW1lKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNwbGl0dGVkID0gY3VzdG9tX3Njb3JpbmdfYXJlYS52YWx1ZS5zcGxpdCgiXG4iKQogICAgICAgICAgICBzY29yaW5nX2RhdGEgPSBbXQogICAgICAgICAgICBmb3Igc3BsaXQgaW4gc3BsaXR0ZWQ6CiAgICAgICAgICAgICAgICBzcGxpdCA9IHNwbGl0LnN0cmlwKCkKICAgICAgICAgICAgICAgIHNjb3JpbmdfZGF0YS5hcHBlbmQoc3BsaXQpCiAgICAgICAgICAgIHdpdGggb3V0cHV0X2NzZjoKICAgICAgICAgICAgICAgIHByaW50KGYiRW50ZXJlZCBmaWxlIG5hbWUgOiB7dGVtcF9uYW1lfSIpCiAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiBzY29yaW5nX2RhdGE6CiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZWN0ID09ICJjdXN0b21fc2NvcmluZyI6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihsaW5lLnJzdHJpcCgpKSAhPSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUsIGl0ZW0gPSBsaW5lLnNwbGl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYie3ZhbHVlfVx0e2l0ZW19IikKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludChsaW5lKQogICAgICAgICAgICAgICAgZGlzcGxheShpbmZvcm1hdGlvbikKCiAgICAjIHdyaXRlcyB0aGUgc2F2ZSBzY29yaW5nIGRhdGEgdG8gYSBmaWxlCiAgICBkZWYgY29uZmlybV9zY29yaW5nKGRhdGEpOgogICAgICAgIG91dHB1dF9jc2YuY2xlYXJfb3V0cHV0KCkKICAgICAgICBpZiBub3QgdGVtcF9uYW1lOgogICAgICAgICAgICB3aXRoIG91dHB1dF9jc2Y6CiAgICAgICAgICAgICAgICBkaXNwbGF5KHdhcm5fZW1wdHlfbmFtZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBtc2dfc3VjY2VzcyA9ICJDb25maXJtZWQgYW5kIFNhdmVkISIKICAgICAgICAgICAgaW5mb3JtYXRpb24gPSBpcHl3aWRnZXRzLndpZGdldHMuSFRNTCgKICAgICAgICAgICAgICAgIHZhbHVlPWYiPGI+PGZvbnQgY29sb3I9J2dyZWVuJz57bXNnX3N1Y2Nlc3N9PC9iPiIKICAgICAgICAgICAgKQogICAgICAgICAgICBmaWxlX25hbWVfc2F2ZSA9IHRlbXBfbmFtZQogICAgICAgICAgICBmaWxlX2NvbnRlbnQgPSBzY29yaW5nX2RhdGEKICAgICAgICAgICAgaWYgc2VsZWN0ID09ICJjdXN0b21fc2NvcmluZyI6CiAgICAgICAgICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoIi4vR2VuZXJhdGVkL2N1c3RvbV9mdW5jdGlvbiIpOgogICAgICAgICAgICAgICAgICAgIG9zLm1ha2VkaXJzKCIuL0dlbmVyYXRlZC9jdXN0b21fZnVuY3Rpb24iKQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKAogICAgICAgICAgICAgICAgICAgIGYiLi9HZW5lcmF0ZWQvY3VzdG9tX2Z1bmN0aW9uL3tmaWxlX25hbWVfc2F2ZX1fY3NmLnR4dCIsICJ3KyIKICAgICAgICAgICAgICAgICkgYXMgd3JpdGVfc2NvcmluZ19mdW5jdGlvbjoKICAgICAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiBmaWxlX2NvbnRlbnQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihsaW5lLnJzdHJpcCgpKSAhPSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUsIGl0ZW0gPSBsaW5lLnNwbGl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYie3ZhbHVlfVx0e2l0ZW19IiwgZmlsZT13cml0ZV9zY29yaW5nX2Z1bmN0aW9uKQoKICAgICAgICAgICAgICAgIGluZm8gPSAoCiAgICAgICAgICAgICAgICAgICAgZiJmaWxlIHNhdmUgYXQgLi9HZW5lcmF0ZWQvY3VzdG9tX2Z1bmN0aW9uL3tmaWxlX25hbWVfc2F2ZX1fY3NmLnR4dCIKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cygiLi9HZW5lcmF0ZWQvc21pbmFfaW5wdXQiKToKICAgICAgICAgICAgICAgICAgICBvcy5tYWtlZGlycygiLi9HZW5lcmF0ZWQvc21pbmFfaW5wdXQiKQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKAogICAgICAgICAgICAgICAgICAgIGYiLi9HZW5lcmF0ZWQvc21pbmFfaW5wdXQve2ZpbGVfbmFtZV9zYXZlfV9tY29uZmlnLnR4dCIsICJ3KyIKICAgICAgICAgICAgICAgICkgYXMgd3JpdGVfY29uZmlnOgogICAgICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIGZpbGVfY29udGVudDoKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJ7bGluZX0iLCBmaWxlPXdyaXRlX2NvbmZpZykKCiAgICAgICAgICAgICAgICBpbmZvID0gKAogICAgICAgICAgICAgICAgICAgIGYiZmlsZSBzYXZlIGF0IC4vR2VuZXJhdGVkL3NtaW5hX2lucHV0L3tmaWxlX25hbWVfc2F2ZX1fbWNvbmZpZy50eHQiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIHdpdGggb3V0cHV0X2NzZjoKICAgICAgICAgICAgICAgIHByaW50KGluZm8pCiAgICAgICAgICAgICAgICBkaXNwbGF5KGluZm9ybWF0aW9uKQoKICAgICMgZGVmIGFsbF9jbGVhcihkYXRhKToKICAgICMgICAgd2l0aCBvdXRwdXRfY3NmOgogICAgIyAgICAgICAgb3V0cHV0X2NzZi5jbGVhcl9vdXRwdXQoKQogICAgIyAjdGV4dCBhcmVhIHRvIG9ic2VydmUgYWxsIGlucHV0IHRleHQKICAgIGNvbmZpZ19wbGFjZWhvbGRlciA9ICgKICAgICAgICAiUGFzdGUgaGVyZVxuICAgICAgICBcbiAgICAgICAgU2FtcGxlIGNvbmZpZy50eHQgRG9ja2luZyBwYXJhbWV0ZXJzIGZpbGVcbiAgICAgIgogICAgICAgICIgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICNJbnB1dHNcbiAgICAgICAgcmVjZXB0b3IgPSIKICAgICAgICAiIC4vM0w2Ql9wcm90LnBkYnF0XG4gICAgICAgIGxpZ2FuZCA9IC4vM0w2Ql9saWcucGRicXRcbiAgICAgICAgI091dHB1dHNcbiAgICAgIgogICAgICAgICIgICBvdXQgPSAzTDZCLW5vd2F0LVZpbmEucGRicXRcbiAgICAgICAgbG9nID0gM0w2Qi1ub3dhdC1WaW5hLmxvZ1xuICAgICAgICIKICAgICAgICAiICNCb3ggY2VudGVyXG4gICAgICAgIGNlbnRlcl94ID0gNC41MDBcbiAgICAgICAgY2VudGVyX3kgPSAtMi45NDRcbiAgICAgICAiCiAgICAgICAgIiBjZW50ZXJfeiA9IC01LjI1MFxuICAgICAgICAjQm94IHNpemVcbiAgICAgICAgc2l6ZV94ID0gNTBcbiAgICAgICAgc2l6ZV95ID0iCiAgICAgICAgIiA1MFxuICAgICAgICBzaXplX3ogPSA1MFxuICAgICAgICAjUGFyYW1ldGVyc1xuICAgICAgICBleGhhdXN0aXZlbmVzcyA9IDhcbiAgICIKICAgICAgICAiICAgICBzZWVkID0gMTIzNDU2XG4iCiAgICApCiAgICBjc2ZfcGxhY2Vob2xkZXIgPSAoCiAgICAgICAgIiBQYXN0ZSBoZXJlXG4gICAgICAgIFxuICAgICAgICAgICAgU2FtcGxlIGZvcm1hdCBvZiBjdXN0b20gc2NvcmluZ1xuICAgICAgICIKICAgICAgICAiIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLTAuMDM1NTc5ICAgIgogICAgICAgICIgZ2F1c3Mobz0wLF93PTAuNSxfYz04KVxuICAgICAgICAtMC4wMDUxNTYgICAgZ2F1c3Mobz0zLF93PTIsX2M9OFxuICAgICAgICIKICAgICAgICAiIDAuODQwMjQ1ICAgICByZXB1bHNpb24obz0wLF9jPTgpXG4gICAgICAgIC0wLjAzNTA2OSAgICIKICAgICAgICAiIGh5ZHJvcGhvYmljKGc9MC41LF9iPTEuNSxfYz04KVxuICAgICAgICAtMC41ODc0MzkgICAiCiAgICAgICAgIiBub25fZGlyX2hfYm9uZChnPS0wLjcsX2I9MCxfYz04KVxuICAgICAgICAxLjkyMyAgICAgICAgbnVtX3RvcnNfZGl2XG4gICAgICAgIgogICAgICAgICIgLTEwMC4wICAgICAgIGF0b21fdHlwZV9nYXVzc2lhbih0MT1DaGxvcmluZSx0Mj1TdWxmdXIsbz0wLF93PTMsX2M9OClcbiIKICAgICkKCiAgICBkZWYgZXZhbHVhdGUoc2VsZWN0ZWQpOgogICAgICAgIG91dHB1dF9jc2YuY2xlYXJfb3V0cHV0KCkKICAgICAgICBhcmVhX2xheW91dCA9IExheW91dCh3aWR0aD0iMTAwJSIsIGhlaWdodD0iNDAwcHgiLCBmbGV4PSJyb3ciKQogICAgICAgIGdsb2JhbCBzZWxlY3QKICAgICAgICBzZWxlY3QgPSBzZWxlY3RlZAogICAgICAgIGlmIHNlbGVjdGVkID09ICJjdXN0b21fc2NvcmluZyI6CiAgICAgICAgICAgIGdsb2JhbCBjdXN0b21fc2NvcmluZ19hcmVhCiAgICAgICAgICAgIGN1c3RvbV9zY29yaW5nX2FyZWEgPSB3aWRnZXRzLlRleHRhcmVhKAogICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9Y3NmX3BsYWNlaG9sZGVyLAogICAgICAgICAgICAgICAgZGVzY3JpcHRpb249IkVudGVyOiIsCiAgICAgICAgICAgICAgICBkaXNhYmxlZD1GYWxzZSwKICAgICAgICAgICAgICAgIGp1c3RpZnlfY29udGVudD0ic3BhY2VfYmV0d2VlbiIsCiAgICAgICAgICAgICAgICBjb250aW51b3VzX3VwZGF0ZT1UcnVlLAogICAgICAgICAgICAgICAgbGF5b3V0PWFyZWFfbGF5b3V0LAogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY3VzdG9tX3Njb3JpbmdfYXJlYSA9IHdpZGdldHMuVGV4dGFyZWEoCiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1jb25maWdfcGxhY2Vob2xkZXIsCiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj0iRW50ZXI6IiwKICAgICAgICAgICAgICAgIGRpc2FibGVkPUZhbHNlLAogICAgICAgICAgICAgICAganVzdGlmeV9jb250ZW50PSJzcGFjZV9iZXR3ZWVuIiwKICAgICAgICAgICAgICAgIGNvbnRpbnVvdXNfdXBkYXRlPVRydWUsCiAgICAgICAgICAgICAgICBsYXlvdXQ9YXJlYV9sYXlvdXQsCiAgICAgICAgICAgICkKICAgICAgICBkaXNwbGF5KGN1c3RvbV9zY29yaW5nX2FyZWEpCiAgICAgICAgb3V0cHV0X2NzZi5jbGVhcl9vdXRwdXQoKQoKICAgIHNlbGVjdF9vcHRpb24gPSB3aWRnZXRzLlJhZGlvQnV0dG9ucygKICAgICAgICBvcHRpb25zPVsiY3VzdG9tX3Njb3JpbmciLCAibWFudWFsX2NvbmZpZyJdLAogICAgICAgIHZhbHVlPSJjdXN0b21fc2NvcmluZyIsCiAgICAgICAgZGVzY3JpcHRpb249IldoYXQ6IiwKICAgICAgICBkaXNhYmxlZD1GYWxzZSwKICAgICkKICAgIHVpID0gd2lkZ2V0cy5IQm94KFtzZWxlY3Rfb3B0aW9uXSkKICAgIG9wdGlvbnMgPSB3aWRnZXRzLmludGVyYWN0aXZlX291dHB1dChldmFsdWF0ZSwgeyJzZWxlY3RlZCI6IHNlbGVjdF9vcHRpb259KQogICAgaW5zdHJ1Y3Rpb24gPSBpcHl3aWRnZXRzLndpZGdldHMuSFRNTCgKICAgICAgICAiPGZvbnQgc2l6ZSA9IDQ+PGI+PGZvbnQgZmFtaWx5OiBUaW1lcyBOZXcgUm9tYW4+Q29weSBhbmQgUGFzdGUgdGhlIHNjb3JpbmciCiAgICAgICAgIiBmdW5jdGlvbiBiZWxvdyBhbmQgZW50ZXI8L2I+PC9mb250LWZhbWlseT48L2ZvbnQgc2l6ZT4iCiAgICApCiAgICBkaXNwbGF5KGluc3RydWN0aW9uKQogICAgIyBidXR0b25zIHdpZGdldHMKICAgIGZpbGVfbmFtZSA9IHdpZGdldHMuVGV4dChkZXNjcmlwdGlvbj0iRmlsZW5hbWU6IiwgcGxhY2Vob2xkZXI9ImZpbGUgbmFtZSAiKQogICAgc2F2ZV9idXR0b24gPSB3aWRnZXRzLkJ1dHRvbihkZXNjcmlwdGlvbj0iU2F2ZSIpCiAgICBzYXZlX2J1dHRvbi5zdHlsZS5idXR0b25fY29sb3IgPSAibGlnaHRncmVlbiIKICAgIGNvbmZpcm1fYnV0dG9uID0gd2lkZ2V0cy5CdXR0b24oZGVzY3JpcHRpb249IkNvbmZpcm0iKQogICAgY29uZmlybV9idXR0b24uc3R5bGUuYnV0dG9uX2NvbG9yID0gInNhbG1vbiIKICAgICMgY2xlYXJfYnV0dG9uID0gd2lkZ2V0cy5CdXR0b24oZGVzY3JpcHRpb249IkNsZWFyIikKICAgICMgY2xlYXJfYnV0dG9uLnN0eWxlLmJ1dHRvbl9jb2xvciA9ICJsaWdodGdyZWVuIgogICAgZGlzcGxheSgod2lkZ2V0cy5WQm94KFtmaWxlX25hbWUsIHVpLCBvcHRpb25zXSkpLCBvdXRwdXRfY3NmKQogICAgZGlzcGxheSgod2lkZ2V0cy5IQm94KFtzYXZlX2J1dHRvbiwgY29uZmlybV9idXR0b25dKSkpCiAgICBzYXZlX2J1dHRvbi5vbl9jbGljayhzYXZlX3Njb3JpbmcpCiAgICBjb25maXJtX2J1dHRvbi5vbl9jbGljayhjb25maXJtX3Njb3JpbmcpCiAgICAjIGNsZWFyX2J1dHRvbi5vbl9jbGljayhhbGxfY2xlYXIpCgoKZGVmIHhnX21vZGVsKFgsIHkpOgogICAgZnJvbSBza2xlYXJuLmRhdGFzZXRzIGltcG9ydCBtYWtlX2NsYXNzaWZpY2F0aW9uCgogICAgbnVtX2NsYXNzZXMgPSAzCiAgICBYLCB5ID0gbWFrZV9jbGFzc2lmaWNhdGlvbihuX3NhbXBsZXM9MTAwMCwgbl9pbmZvcm1hdGl2ZT01LCBuX2NsYXNzZXM9bnVtX2NsYXNzZXMpCiAgICBkdHJhaW4gPSB4Z2IuRE1hdHJpeChkYXRhPVgsIGxhYmVsPXkpCiAgICBudW1fcGFyYWxsZWxfdHJlZSA9IDQKICAgIG51bV9ib29zdF9yb3VuZCA9IDE2CiAgICAjIHRvdGFsIG51bWJlciBvZiBidWlsdCB0cmVlcyBpcyBudW1fcGFyYWxsZWxfdHJlZSAqIG51bV9jbGFzc2VzICogbnVtX2Jvb3N0X3JvdW5kCgogICAgIyBXZSBidWlsZCBhIGJvb3N0ZWQgcmFuZG9tIGZvcmVzdCBmb3IgY2xhc3NpZmljYXRpb24gaGVyZS4KICAgIGJvb3N0ZXIgPSB4Z2IudHJhaW4oCiAgICAgICAgeyJudW1fcGFyYWxsZWxfdHJlZSI6IDQsICJzdWJzYW1wbGUiOiAwLjUsICJudW1fY2xhc3MiOiAzfSwKICAgICAgICBudW1fYm9vc3Rfcm91bmQ9bnVtX2Jvb3N0X3JvdW5kLAogICAgICAgIGR0cmFpbj1kdHJhaW4sCiAgICApCgogICAgIyBUaGlzIGlzIHRoZSBzbGljZWQgbW9kZWwsIGNvbnRhaW5pbmcgWzMsIDcpIGZvcmVzdHMKICAgICMgc3RlcCBpcyBhbHNvIHN1cHBvcnRlZCB3aXRoIHNvbWUgbGltaXRhdGlvbnMgbGlrZSBuZWdhdGl2ZSBzdGVwIGlzIGludmFsaWQuCiAgICBzbGljZWQ6IHhnYi5Cb29zdGVyID0gYm9vc3RlclszOjddCgogICAgcmV0dXJuIFtfIGZvciBfIGluIGJvb3N0ZXJdCgoKZGVmIHhnYl9ib29zdChmaWxlX3RyYWluLCBmaWxlX3Rlc3QpOgogICAgaW1wb3J0IHhnYm9vc3QgYXMgeGdiCgogICAgQ1VSUkVOVF9ESVIgPSBvcy5wYXRoLmRpcm5hbWUoX19maWxlX18pCiAgICBkdHJhaW4gPSB4Z2IuRE1hdHJpeChvcy5wYXRoLmpvaW4oQ1VSUkVOVF9ESVIsICJmaWxlX3RyYWluIikpCiAgICBkdGVzdCA9IHhnYi5ETWF0cml4KG9zLnBhdGguam9pbihDVVJSRU5UX0RJUiwgImZpbGVfdGVzdCIpKQogICAgcGFyYW0gPSB7CiAgICAgICAgIm9iamVjdGl2ZSI6ICJiaW5hcnk6bG9naXN0aWMiLAogICAgICAgICJib29zdGVyIjogImdibGluZWFyIiwKICAgICAgICAiYWxwaGEiOiAwLjAwMDEsCiAgICAgICAgImxhbWJkYSI6IDEsCiAgICB9CiAgICB3YXRjaGxpc3QgPSBbKGR0ZXN0LCAiZXZhbCIpLCAoZHRyYWluLCAidHJhaW4iKV0KICAgIG51bV9yb3VuZCA9IDQKICAgIGJzdCA9IHhnYi50cmFpbihwYXJhbSwgZHRyYWluLCBudW1fcm91bmQsIHdhdGNobGlzdCkKICAgIHByZWRzID0gYnN0LnByZWRpY3QoZHRlc3QpCiAgICBsYWJlbHMgPSBkdGVzdC5nZXRfbGFiZWwoKQogICAgcHJpbnQoCiAgICAgICAgImVycm9yPSVmIgogICAgICAgICUgKAogICAgICAgICAgICBzdW0oaW50KHByZWRzW2ldID4gMC41KSAhPSBsYWJlbHNbaV0gZm9yIGkgaW4gcmFuZ2UobGVuKHByZWRzKSkpCiAgICAgICAgICAgIC8gZmxvYXQobGVuKHByZWRzKSkKICAgICAgICApCiAgICApCgoKZGVmIHJ1bl9zbWluYShkaXJfbmFtZV8sIGNvbmZpZ19maWxlX25hbWUsICoqa3dhcmdzKToKICAgICIiIiBDcmVhdGVzIGZvbGRlciB3aXRoaW4gdGhlIGN3ZCB3aXRoIHRoZSBuYW1lIGlkIGFuZCBzdWJcCiAgICBmb2xkZXIgcnVuIHdoZXJlIGl0IHdpbGwgd3JpdGUgc2guQWxzbyBjcmVhdGVzIGEgZHVtcCBmb2xkZXJcCiAgICB3aGVyZSBlcnJvciBhbmQgb3V0cHV0IGxvZyB3aWxsIGJlIGR1bXBlZC4KCiAgICAiIiIKICAgIG1vZGUgPSBrd2FyZ3MuZ2V0KCJtb2RlIiwgRmFsc2UpCiAgICBsb2cgPSBrd2FyZ3MuZ2V0KCJsb2ciLCAibG9nLnR4dCIpCiAgICBvdXRwdXQgPSBrd2FyZ3MuZ2V0KCJvdXRwdXQiLCAib3V0cHV0LnNkZiIpCiAgICBsb2NhbCA9IGt3YXJncy5nZXQoImxvY2FsIiwgRmFsc2UpCiAgICBjcHVfbnVtID0ga3dhcmdzLmdldCgiY3B1IiwgMikKICAgIGpvYl9uYW1lID0ga3dhcmdzLmdldCgiam9iX25hbWUiLCBOb25lKQogICAgc2NvcmluZyA9IGt3YXJncy5nZXQoInNjb3JpbmciKQogICAgY3VzdG9tID0ga3dhcmdzLmdldCgiY3VzdG9tIiwgRmFsc2UpCiAgICBlbnRlcl9vdXRwdXQgPSBrd2FyZ3MuZ2V0KCJlbnRlcl9vdXRwdXQiLCBUcnVlKQogICAgZW50ZXJfbG9nID0ga3dhcmdzLmdldCgiZW50ZXJfbG9nIiwgVHJ1ZSkKICAgIGNsdXN0ZXIgPSBrd2FyZ3MuZ2V0KCJjbHVzdGVyIiwgTm9uZSkKICAgIGNsdXN0ZXJfZ3JwID0gWyJhbGwucSIsICJncDEiLCAiZ3AyIl0KICAgIGlmIChjbHVzdGVyIGlzIG5vdCBOb25lKSBhbmQgKGNsdXN0ZXIgbm90IGluIGNsdXN0ZXJfZ3JwKToKICAgICAgICByZXR1cm4gZiJJbnZhbGlkIGNsdXN0ZXIgbmFtZS4gQXZhaWxhYmxlIGNsdXN0ZXIgbmFtZXM6IHtjbHVzdGVyX2dycH0iCiAgICBuYW1lX2lkID0gY29uZmlnX2ZpbGVfbmFtZVs6NF0ubG93ZXIoKSAgIyBGSVgKICAgIGRpcl9uYW1lX2N3ZCA9IG9zLmdldGN3ZCgpCiAgICBkaXJfbmFtZSA9IG9zLnBhdGguZGlybmFtZShkaXJfbmFtZV8pCiAgICBQQVRIID0ga3dhcmdzLmdldCgiUEFUSCIsIEZhbHNlKQogICAgZGlyX25hbWUgPSBmIntkaXJfbmFtZX0iIGlmIFBBVEggZWxzZSBmIntkaXJfbmFtZV9jd2R9IgoKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmIntkaXJfbmFtZX0vR2VuZXJhdGVkL2pvYnMve25hbWVfaWR9L3J1biIpOgogICAgICAgIG9zLm1ha2VkaXJzKGYie2Rpcl9uYW1lfS9HZW5lcmF0ZWQvam9icy97bmFtZV9pZH0vcnVuIikKICAgIGlmIGxvY2FsIGlzIEZhbHNlOgogICAgICAgIFNNSU5BX1BBVEggPSAiL3NoYXJlL3ZpbmEvc21pbmEiCiAgICAgICAgd2l0aCBvcGVuKAogICAgICAgICAgICBmIntkaXJfbmFtZX0vR2VuZXJhdGVkL2pvYnMve25hbWVfaWR9L3J1bi97bmFtZV9pZH1fU01pbmEuc2giLCAidyIKICAgICAgICApIGFzIG91dDoKICAgICAgICAgICAgaWYgam9iX25hbWUgaXMgTm9uZToKICAgICAgICAgICAgICAgIGpvYl9uYW1lID0gbmFtZV9pZAogICAgICAgICAgICBpZiBqb2JfbmFtZVswXS5pc2RpZ2l0KCk6CiAgICAgICAgICAgICAgICBqb2JfbmFtZSA9ICJTIiArIGpvYl9uYW1lCiAgICAgICAgICAgIHByaW50KGYiIyQgLU4ge2pvYl9uYW1lfSIsIGZpbGU9b3V0KQogICAgICAgICAgICBwcmludCgiIyQgLVYiLCBmaWxlPW91dCkKICAgICAgICAgICAgcHJpbnQoIiMkIC1TIC9iaW4vYmFzaCIsIGZpbGU9b3V0KQogICAgICAgICAgICBpZiBjbHVzdGVyIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgcHJpbnQoZiIjJCAtcSB7Y2x1c3Rlcn0iLCBmaWxlPW91dCkKICAgICAgICAgICAgcHJpbnQoZiIjJCAtcGUge2NwdV9udW19Y3B1IHtjcHVfbnVtfSIsIGZpbGU9b3V0KQogICAgICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoZiJ7ZGlyX25hbWV9L0dlbmVyYXRlZC9qb2JzL3tuYW1lX2lkfS9kdW1wLyIpOgogICAgICAgICAgICAgICAgb3MubWFrZWRpcnMoZiJ7ZGlyX25hbWV9L0dlbmVyYXRlZC9qb2JzL3tuYW1lX2lkfS9kdW1wLyIpCiAgICAgICAgICAgIHByaW50KGYiIyQgLW8ge2Rpcl9uYW1lfS9HZW5lcmF0ZWQvam9icy97bmFtZV9pZH0vZHVtcC8iLCBmaWxlPW91dCkKICAgICAgICAgICAgcHJpbnQoZiIjJCAtZSAge2Rpcl9uYW1lfS9HZW5lcmF0ZWQvam9icy97bmFtZV9pZH0vZHVtcC8iLCBmaWxlPW91dCkKICAgICAgICAgICAgcHJpbnQoIiMkIC1jd2QiLCBmaWxlPW91dCkKCiAgICAgICAgICAgICMgQ29uZGl0aW9uYWwgdG8gd3JpdGUgbG9nIGFuZCBvdXRwdXQKICAgICAgICAgICAgZW50ZXJfbG9nID0gZiItLWxvZyB7bG9nfSIgaWYgZW50ZXJfbG9nIGVsc2UgIiIKICAgICAgICAgICAgZW50ZXJfb3V0cHV0ID0gZiItLW91dCB7b3V0cHV0fSIgaWYgZW50ZXJfb3V0cHV0IGVsc2UgIiIKICAgICAgICAgICAgaWYgKG1vZGUgaXMgVHJ1ZSkgYW5kIChjdXN0b20gaXMgRmFsc2UpOgogICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgZiJ7U01JTkFfUEFUSH0gLS1jb25maWciCiAgICAgICAgICAgICAgICAgICAgZiIge2Rpcl9uYW1lfS9HZW5lcmF0ZWQvc21pbmFfaW5wdXQve2NvbmZpZ19maWxlX25hbWV9IgogICAgICAgICAgICAgICAgICAgIGYiIC0tc2NvcmluZyB7c2NvcmluZ30gLS1zY29yZV9vbmx5IHtlbnRlcl9sb2d9IHtlbnRlcl9vdXRwdXR9IiwKICAgICAgICAgICAgICAgICAgICBmaWxlPW91dCwKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgIGVsaWYgKG1vZGUgaXMgVHJ1ZSkgYW5kIChjdXN0b20gaXMgVHJ1ZSk6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIntTTUlOQV9QQVRIfSAtLWNvbmZpZyIKICAgICAgICAgICAgICAgICAgICBmIiB7ZGlyX25hbWV9L0dlbmVyYXRlZC9zbWluYV9pbnB1dC97Y29uZmlnX2ZpbGVfbmFtZX0iCiAgICAgICAgICAgICAgICAgICAgZiIgLS1jdXN0b21fc2NvcmluZyB7c2NvcmluZ30gLS1zY29yZV9vbmx5ICB7ZW50ZXJfb3V0cHV0fSIKICAgICAgICAgICAgICAgICAgICBmIiB7ZW50ZXJfbG9nfSIsCiAgICAgICAgICAgICAgICAgICAgZmlsZT1vdXQsCiAgICAgICAgICAgICAgICApCgogICAgICAgICAgICBlbGlmIChtb2RlIGlzIEZhbHNlKSBhbmQgKGN1c3RvbSBpcyBGYWxzZSk6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIntTTUlOQV9QQVRIfSAtLWNvbmZpZyIKICAgICAgICAgICAgICAgICAgICBmIiB7ZGlyX25hbWV9L0dlbmVyYXRlZC9zbWluYV9pbnB1dC97Y29uZmlnX2ZpbGVfbmFtZX0gLS1zY29yaW5nIgogICAgICAgICAgICAgICAgICAgIGYiIHtzY29yaW5nfSAge2VudGVyX2xvZ30ge2VudGVyX291dHB1dH0gIiwKICAgICAgICAgICAgICAgICAgICBmaWxlPW91dCwKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgIGVsaWYgKG1vZGUgaXMgRmFsc2UpIGFuZCAoY3VzdG9tIGlzIFRydWUpOgogICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgZiJ7U01JTkFfUEFUSH0gLS1jb25maWciCiAgICAgICAgICAgICAgICAgICAgZiIge2Rpcl9uYW1lfS9HZW5lcmF0ZWQvc21pbmFfaW5wdXQve2NvbmZpZ19maWxlX25hbWV9IgogICAgICAgICAgICAgICAgICAgIGYiIC0tY3VzdG9tX3Njb3Jpbmcge3Njb3Jpbmd9ICB7ZW50ZXJfbG9nfSB7ZW50ZXJfb3V0cHV0fSAiLAogICAgICAgICAgICAgICAgICAgIGZpbGU9b3V0LAogICAgICAgICAgICAgICAgKQoKICAgICAgICBjb21tYW5kID0gZiJxc3ViIHtkaXJfbmFtZX0vR2VuZXJhdGVkL2pvYnMve25hbWVfaWR9L3J1bi97bmFtZV9pZH1fU01pbmEuc2giCiAgICBlbHNlOgogICAgICAgIGlmIGN1c3RvbSBpcyBGYWxzZToKICAgICAgICAgICAgY29tbWFuZCA9ICgKICAgICAgICAgICAgICAgIGYic21pbmEgLS1jb25maWcge2Rpcl9uYW1lfS9HZW5lcmF0ZWQvc21pbmFfaW5wdXQve2NvbmZpZ19maWxlX25hbWV9IgogICAgICAgICAgICAgICAgZiIgLS1zY29yaW5nIHtzY29yaW5nfSB7ZW50ZXJfbG9nfSB7ZW50ZXJfb3V0cHV0fSIKICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbW1hbmQgPSAoCiAgICAgICAgICAgICAgICBmInNtaW5hIC0tY29uZmlnIHtkaXJfbmFtZX0vR2VuZXJhdGVkL3NtaW5hX2lucHV0L3tjb25maWdfZmlsZV9uYW1lfSIKICAgICAgICAgICAgICAgIGYiIC0tY3VzdG9tX3Njb3Jpbmcge3Njb3Jpbmd9ICB7ZW50ZXJfbG9nfSB7ZW50ZXJfb3V0cHV0fSIKICAgICAgICAgICAgKQoKICAgIHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIGN3ZD1mIntkaXJfbmFtZX0vR2VuZXJhdGVkL2pvYnMve25hbWVfaWR9Iiwgc2hlbGw9VHJ1ZSkKCiAgICByZXR1cm4gIlN1Y2Nlc2Z1bGx5IGNvbXBsZXRlZC4iCgoKIyBSRUNPUkRTIE9GIEFMTCBTQ09SSU5HIEZVTkNUSU9OCiMgU0YgPSBbICAiYWQ0X3Njb3JpbmciLAojICAgICAgICAiZGVmYXVsdCIsCiMgICAgICAgICJka29lc19mYXN0IiwKIyAgICAgICAgImRrb2VzX3Njb3JpbmciLAojICAgICAgICAiZGtvZXNfc2NvcmluZ19vbGQiLAojICAgICAgICAidmluYSIsCiMgICAgICAgICJ2aW5hcmRvIiwKIyAgICBdCgojIENTRiA9IFsiY3VzdG9tIl0gIyBmb3IgY3VzdG9tIHNjb3JpbmcgIGFuZCBwYXNzIGN1c3RvbV9zY29yaW5nX2ZpbGU9UEFUSCB0byB0aGUgZnVuY3Rpb24KIyBPdGhlcndpc2UgYWxsIHRoZSBvdGhlciBTRiB3aWxsIGJlIHJ1biBidXQgd2lsbCBiZSBjYWxjdWxhdGUgd2l0aCBjc2YKIyAgZm9yIG51bWVyb3VzIHRpbWUKCgpkZWYgc21pbmFfcnVuKHByb3RlaW5fbGlzdCwgbGlnYW5kX2xpc3QsICoqa3dhcmdzKToKCiAgICAiIiJQcmVwYXJlcyBjb25maWcgZmlsZSBmb3Igc21pbmEgd2hlbiBlbnRlciBwcm90ZXJpbiBhbmQgbGlnYW5kCiAgICBBYm92ZSBzaF9ydW4gZnVuY3Rpb24gbXVzdCBiZSBpbml0aWFsZXplZCBiZWZvcmUgaW4gbm90ZWJvb2siIiIKCiAgICBTRiA9IGt3YXJncy5nZXQoIlNGIikKICAgIGlmIG5vdCBpc2luc3RhbmNlKFNGLCBsaXN0KToKICAgICAgICByZXR1cm4gIlN1cHBsaWVkIFNGIGlzIG5vdCBhIGxpc3QiCiAgICBjbHVzdGVyID0ga3dhcmdzLmdldCgiY2x1c3RlciIsIE5vbmUpCiAgICBjbHVzdGVyX2dycCA9IFsiYWxsLnEiLCAiZ3AxIiwgImdwMiJdCiAgICBpZiAoY2x1c3RlciBpcyBub3QgTm9uZSkgYW5kIChjbHVzdGVyIG5vdCBpbiBjbHVzdGVyX2dycCk6CiAgICAgICAgcmV0dXJuIGYiSW52YWxpZCBjbHVzdGVyIG5hbWUuIEF2YWlsYWJsZSBjbHVzdGVyIG5hbWVzOiB7Y2x1c3Rlcl9ncnB9IgogICAgYXV0b2JveCA9IGt3YXJncy5nZXQoImF1dG9ib3giLCBOb25lKQogICAgaWYgaXNpbnN0YW5jZShhdXRvYm94LCBsaXN0KToKICAgICAgICBhdXRvYm94ID0gYXV0b2JveFswXQogICAgbWFudWFsX2NvbmZpZyA9IGt3YXJncy5nZXQoIm1hbnVhbF9jb25maWciLCBOb25lKQogICAgaWYgaXNpbnN0YW5jZShtYW51YWxfY29uZmlnLCBsaXN0KToKICAgICAgICBtYW51YWxfY29uZmlnID0gbWFudWFsX2NvbmZpZ1swXQogICAgcnVuID0ga3dhcmdzLmdldCgicnVuIiwgRmFsc2UpCiAgICBtb2RlID0ga3dhcmdzLmdldCgibW9kZSIsIEZhbHNlKQogICAgbG9jYWwgPSBrd2FyZ3MuZ2V0KCJsb2NhbCIsIEZhbHNlKQogICAgam9iX25hbWUgPSBrd2FyZ3MuZ2V0KCJqb2JfbmFtZSIsIE5vbmUpCiAgICBOVU1fTU9ERVMgPSBrd2FyZ3MuZ2V0KCJudW1fbW9kZXMiLCAxMCkKICAgIEVYSEFVU1RJVkUgPSBrd2FyZ3MuZ2V0KCJleGhhdXN0aXZlIiwgNTApCiAgICBFTkVSR1lfUkFOR0UgPSBrd2FyZ3MuZ2V0KCJlbmVyZ3lfcmFuZ2UiLCAxMCkKICAgIFNFRUQgPSBrd2FyZ3MuZ2V0KCJzZWVkIiwgTm9uZSkKICAgIEFVVE9CT1hfUEFEID0ga3dhcmdzLmdldCgicGFkIiwgNCkKICAgIENQVV9OVU0gPSBrd2FyZ3MuZ2V0KCJjcHUiLCA4KQogICAgbm9tYXRjaCA9IGt3YXJncy5nZXQoIm1hdGNoIiwgRmFsc2UpCiAgICBPVVRfRk9STUFUID0ga3dhcmdzLmdldCgib3V0X2Zvcm1hdCIsICJzZGYiKQogICAgY3VzdG9tID0ga3dhcmdzLmdldCgiY3VzdG9tIiwgRmFsc2UpCgogICAgIyBpZiBDVVNUT01fU0NPUkUgaXMgbm90IE5vbmU6CiAgICAjICAgIENTRl9GTEFHID0gVHJ1ZQogICAgIyBlbHNlOgogICAgIyAgICBDU0ZfRkxBRyA9IEZhbHNlCgogICAgZGVmIHdyaXRlX2NvbmZpZygKICAgICAgICByZWNlcHRvciwKICAgICAgICBsaWdhbmQsCiAgICAgICAgY29uZmlnX2ZpbGVfbmFtZSwKICAgICAgICBvdXRwdXRfZmlsZV9uYW1lLAogICAgICAgIGxvZ19maWxlX25hbWUsCiAgICAgICAgIyBzY29yaW5nPU5vbmUsICMgTW92ZWQgdG8gQ0xJCiAgICApOgogICAgICAgICIiIldyaXRlcyBjb25maWcgaW50byBuZXcgZmlsZXMsIGlmIGFscmVhZHkgXAogICAgICAgIGV4aXN0IGFwcGVuZCB0byBpdC4iIiIKCiAgICAgICAgIyBkaXJfbmFtZSA9IG9zLnBhdGguZGlybmFtZShyZWNlcHRvcikKICAgICAgICBkaXJfbmFtZSA9IG9zLmdldGN3ZCgpCgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmIntkaXJfbmFtZX0vR2VuZXJhdGVkL3NtaW5hX2lucHV0Iik6CiAgICAgICAgICAgIG9zLm1ha2VkaXJzKGYie2Rpcl9uYW1lfS9HZW5lcmF0ZWQvc21pbmFfaW5wdXQvIikKICAgICAgICB3aXRoIG9wZW4oCiAgICAgICAgICAgIGYie2Rpcl9uYW1lfS9HZW5lcmF0ZWQvc21pbmFfaW5wdXQve2NvbmZpZ19maWxlX25hbWV9IiwgIncrIgogICAgICAgICkgYXMgY29uZmlnX2ZpbGU6CgogICAgICAgICAgICAjIHJlcXVpcmVkIGNvbmZpZyBhcmd1bWVudHMKICAgICAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgcHJpbnQoZiJyZWNlcHRvciA9IHtyZWNlcHRvcn0gIiwgZmlsZT1jb25maWdfZmlsZSkKICAgICAgICAgICAgcHJpbnQoZiJsaWdhbmQgPSB7bGlnYW5kfSIsIGZpbGU9Y29uZmlnX2ZpbGUpCiAgICAgICAgICAgIGlmIGF1dG9ib3ggaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwcmludChmImF1dG9ib3hfbGlnYW5kID0ge2F1dG9ib3h9IiwgZmlsZT1jb25maWdfZmlsZSkKICAgICAgICAgICAgICAgIHByaW50KGYiYXV0b2JveF9hZGQgPSB7QVVUT0JPWF9QQUR9IiwgZmlsZT1jb25maWdfZmlsZSkKCiAgICAgICAgICAgICMgT3B0aW9uYWxzIGNvbiAgIyBNT1ZFRCBUTyBDTEkKICAgICAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgcHJpbnQoZiJvdXQgPSB7b3V0cHV0X2ZpbGVfbmFtZX0iLCBmaWxlPWNvbmZpZ19maWxlKQogICAgICAgICAgICBwcmludChmImxvZyA9IHtsb2dfZmlsZV9uYW1lfSIsIGZpbGU9Y29uZmlnX2ZpbGUpCiAgICAgICAgICAgICMgcHJpbnQoZiJzY29yaW5nID0ge3Njb3Jpbmd9IiwgZmlsZT1jb25maWdfZmlsZSkgICMjIGNoYW5nZSB0byBydW4gaW4gQ0xJCgogICAgICAgICAgICAjIE1pc2Mob3B0aW9uYWwpIGNvbmZpZ3MKICAgICAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICAjIGlmIENVU1RPTV9TQ09SRSBpcyBub3QgTm9uZTogICMjIE1PVkVEIFRPIENMSQogICAgICAgICAgICAjICAgIHByaW50KGYiY3VzdG9tX3Njb3JpbmcgPSB7Q1VTVE9NX1NDT1JFfSIsIGZpbGU9Y29uZmlnX2ZpbGUpCiAgICAgICAgICAgICMgaWYgU01JTkFfTU9ERSBpcyBub3QgTm9uZToKICAgICAgICAgICAgIyAgICBwcmludChmIntTTUlOQV9NT0RFfSIsIGZpbGU9Y29uZmlnX2ZpbGUpCgogICAgICAgICAgICBwcmludChmImNwdSA9IHtDUFVfTlVNfSIsIGZpbGU9Y29uZmlnX2ZpbGUpCiAgICAgICAgICAgIGlmIFNFRUQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwcmludChmIlxuXG5zZWVkID0ge1NFRUR9IiwgZmlsZT1jb25maWdfZmlsZSkKICAgICAgICAgICAgcHJpbnQoZiJleGhhdXN0aXZlbmVzcyA9IHtFWEhBVVNUSVZFfSIsIGZpbGU9Y29uZmlnX2ZpbGUpCiAgICAgICAgICAgICMgaWYgQ1VTVE9NX1NDT1JFIGlzIE5vbmU6ICMjIGNoYW5nZSB0byBydW4gaW4gQ0xJCiAgICAgICAgICAgIHByaW50KGYibnVtX21vZGVzID0ge05VTV9NT0RFU30iLCBmaWxlPWNvbmZpZ19maWxlKQogICAgICAgICAgICBwcmludChmImVuZXJneV9yYW5nZSA9IHtFTkVSR1lfUkFOR0UgfSIsIGZpbGU9Y29uZmlnX2ZpbGUpCgogICAgZm9yIHNjb3JpbmcgaW4gU0Y6CiAgICAgICAgZm9yIGxpZ2FuZCBpbiBsaWdhbmRfbGlzdDoKICAgICAgICAgICAgcHJvdGVpbl9kaXIsIHByb3RlaW5faWQsIHByb3RfZm9ybWF0ID0gZ2l2ZV9pZChwcm90ZWluX2xpc3RbMF0pCiAgICAgICAgICAgIGxpZ2FuZF9kaXIsIGxpZ2FuZF9pZCwgbGlnX2Zvcm1hdCA9IGdpdmVfaWQobGlnYW5kKQogICAgICAgICAgICBpZiBjdXN0b206CiAgICAgICAgICAgICAgICBfZGlyLCBfbmFtZSwgX2Zvcm1hdCA9IGdpdmVfaWQoc2NvcmluZykKICAgICAgICAgICAgICAgIHNjb3JpbmcgPSBfbmFtZQogICAgICAgICAgICBpZiBwcm90ZWluX2lkWzo0XS5sb3dlcigpID09IGxpZ2FuZF9pZFs6NF0ubG93ZXIoKSBvciAobm9tYXRjaCA9PSBUcnVlKToKICAgICAgICAgICAgICAgIG91dHB1dF9maWxlX25hbWUgPSBsaWdhbmRfaWQgKyBmIl9vdXRwdXRfe3Njb3Jpbmd9LntPVVRfRk9STUFUfSIKICAgICAgICAgICAgICAgIGxvZ19maWxlX25hbWUgPSBsaWdhbmRfaWQgKyBmIl9sb2dfe3Njb3Jpbmd9LnR4dCIKICAgICAgICAgICAgICAgIGlmIG1hbnVhbF9jb25maWcgaXMgTm9uZToKCiAgICAgICAgICAgICAgICAgICAgY29uZmlnX2ZpbGVfbmFtZSA9IGxpZ2FuZF9pZC5sb3dlcigpICsgZiJfY29uZmlnX3tzY29yaW5nfS50eHQiCiAgICAgICAgICAgICAgICAgICAgZW50ZXJfb3V0cHV0ID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgIGVudGVyX2xvZyA9IFRydWUKICAgICAgICAgICAgICAgICAgICB3cml0ZV9jb25maWcoCiAgICAgICAgICAgICAgICAgICAgICAgIHByb3RlaW5fbGlzdFswXSwKICAgICAgICAgICAgICAgICAgICAgICAgbGlnYW5kLAogICAgICAgICAgICAgICAgICAgICAgICBjb25maWdfZmlsZV9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRfZmlsZV9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBsb2dfZmlsZV9uYW1lLAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGVsc2U6CgogICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgbWFudWFsX2NvbmZpZ19kaXIsCiAgICAgICAgICAgICAgICAgICAgICAgIG1hbnVhbF9jb25maWdfbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgbWFudWFsX2NvbmZpZ19mb3JtYXQsCiAgICAgICAgICAgICAgICAgICAgKSA9IGdpdmVfaWQobWFudWFsX2NvbmZpZykKICAgICAgICAgICAgICAgICAgICBjb25maWdfZmlsZV9uYW1lID0gZiJ7bWFudWFsX2NvbmZpZ19uYW1lfS57bWFudWFsX2NvbmZpZ19mb3JtYXR9IgogICAgICAgICAgICAgICAgICAgIGlmICJvdXRwdXQiIGluIG9wZW4obWFudWFsX2NvbmZpZykucmVhZCgpOgogICAgICAgICAgICAgICAgICAgICAgICBlbnRlcl9vdXRwdXQgPSBGYWxzZQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGVudGVyX291dHB1dCA9IFRydWUKICAgICAgICAgICAgICAgICAgICBpZiAibG9nIiBpbiBvcGVuKG1hbnVhbF9jb25maWcpLnJlYWQoKToKICAgICAgICAgICAgICAgICAgICAgICAgZW50ZXJfbG9nID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBlbnRlcl9sb2cgPSBUcnVlCgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoIlByb3RlaW4gYW5kIGxpZ2FuZCBwcmVmaXggWzQgbGV0dGVyXSBkaWRudCBtYXRjaCIpCiAgICAgICAgICAgIGlmIGN1c3RvbToKICAgICAgICAgICAgICAgIHNjb3JpbmcgPSBmIntfZGlyfS97X25hbWV9LntfZm9ybWF0fSIKICAgICAgICAgICAgaWYgcnVuIGlzIFRydWUgYW5kIG1vZGUgaXMgVHJ1ZToKICAgICAgICAgICAgICAgIHJ1bl9zbWluYSgKICAgICAgICAgICAgICAgICAgICBwcm90ZWluX2RpciwKICAgICAgICAgICAgICAgICAgICBjb25maWdfZmlsZV9uYW1lLAogICAgICAgICAgICAgICAgICAgIHNjb3Jpbmc9c2NvcmluZywKICAgICAgICAgICAgICAgICAgICBtb2RlPW1vZGUsCiAgICAgICAgICAgICAgICAgICAgbG9jYWw9bG9jYWwsCiAgICAgICAgICAgICAgICAgICAgIyBjcHU9Q1BVX05VTSwKICAgICAgICAgICAgICAgICAgICAjIGpvYl9uYW1lPWpvYl9uYW1lLAogICAgICAgICAgICAgICAgICAgIGN1c3RvbT1jdXN0b20sCiAgICAgICAgICAgICAgICAgICAgbG9nPWxvZ19maWxlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0PW91dHB1dF9maWxlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgZW50ZXJfb3V0cHV0PWVudGVyX291dHB1dCwKICAgICAgICAgICAgICAgICAgICBlbnRlcl9sb2c9ZW50ZXJfbG9nLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbGlmIHJ1biBpcyBUcnVlIGFuZCBtb2RlIGlzIEZhbHNlOgogICAgICAgICAgICAgICAgcnVuX3NtaW5hKAogICAgICAgICAgICAgICAgICAgIHByb3RlaW5fZGlyLAogICAgICAgICAgICAgICAgICAgIGNvbmZpZ19maWxlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgc2NvcmluZz1zY29yaW5nLAogICAgICAgICAgICAgICAgICAgIGxvY2FsPWxvY2FsLAogICAgICAgICAgICAgICAgICAgIGNwdT1DUFVfTlVNLAogICAgICAgICAgICAgICAgICAgIGpvYl9uYW1lPWpvYl9uYW1lLAogICAgICAgICAgICAgICAgICAgIGN1c3RvbT1jdXN0b20sCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0PW91dHB1dF9maWxlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgbG9nPWxvZ19maWxlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgZW50ZXJfb3V0cHV0PWVudGVyX291dHB1dCwKICAgICAgICAgICAgICAgICAgICBlbnRlcl9sb2c9ZW50ZXJfbG9nLAogICAgICAgICAgICAgICAgICAgIFBBVEg9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICBjbHVzdGVyPWNsdXN0ZXIsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICAiUnVuIGNvbW1hbmQgd2FzIG5vdCBwYXNzZWQgc28gb25seSBjcmVhdGVkIHRoZSIKICAgICAgICAgICAgICAgICAgICAiIGNvbmZpZyBhbmQgc2ggZmlsZSBidXQgbm90IGV4ZWN1dGVkIgogICAgICAgICAgICAgICAgKQogICAgICAgICMgcHJpbnQoYmFzZV9uYW1lKQogICAgcmV0dXJuICJTdWNjZXNmdWxseSBjb21wbGV0ZWQuIgoKCmRlZiB2aWV3X2FmZmluaXR5KHNvcnRlZF9SRVMsIGtleXdvcmQpOgogICAgZGYgPSBwZC5EYXRhRnJhbWUoCiAgICAgICAgWwogICAgICAgICAgICAoa2V5LCB2YWx1ZSkKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gc29ydGVkX1JFUy5pdGVtcygpCiAgICAgICAgICAgIGlmIGYie2tleXdvcmR9IiBpbiBrZXkubG93ZXIoKQogICAgICAgIF0sCiAgICAgICAgY29sdW1ucz1bIlBvc2UiLCAiQWZmaW5pdHkiXSwKICAgICkKICAgIHJldHVybiBkZgoKCmRlZiBzbWluYV9vdXRwdXRfZGYoc29ydGVkX1JFUyk6CiAgICByZXR1cm4gcGQuRGF0YUZyYW1lKAogICAgICAgIFsoa2V5LCB2YWx1ZSkgZm9yIGtleSwgdmFsdWUgaW4gc29ydGVkX1JFUy5pdGVtcygpXSwKICAgICAgICBjb2x1bW5zPVsiUG9zZSIsICJBZmZpbml0eSJdLAogICAgKQoKCmRlZiBybXNkX21hdHJpeCgKICAgIHJlZiwgbGVuZ3RoPTIsIGtleT0iTUFUUklYIiwgdmVyYm9zZT1GYWxzZSwgcGxvdD1UcnVlLCBzYXZlPUZhbHNlLCBhbm5vdD1GYWxzZQopOgogICAgX3Jtc2RfbGlzdCA9IGl0ZXJ0b29scy5jb21iaW5hdGlvbnMocmVmLCBsZW5ndGgpCiAgICBjb2xzID0gWyJSZWZlcmVuY2UiLCAiUG9zZSIsICJSTVNEIl0KICAgIGRmID0gcGQuRGF0YUZyYW1lKGNvbHVtbnM9Y29scykKICAgIGZvciBjb3VudCwgaSBpbiBlbnVtZXJhdGUoX3Jtc2RfbGlzdCk6CiAgICAgICAgcmVmLCBjb25mID0gbGlzdChbaVswXV0pLCBsaXN0KFtpWzFdXSkKICAgICAgICB4ID0gcm1zZF9jYWxjdWxhdG9yKHJlZiwgY29uZiwgbm9tYXRjaD1UcnVlLCBrZXk9a2V5LCB2ZXJib3NlPUZhbHNlKQogICAgICAgIGlmIHZlcmJvc2U6CiAgICAgICAgICAgIHByaW50KGYie2NvdW50fS4ge3h9Iiwgc2VwPSIgIiwgZmx1c2g9VHJ1ZSkKICAgICAgICB4MSwgeDIsIHgzID0geC5zcGxpdCgiXHQiKQogICAgICAgIGRmLmxvY1tjb3VudF0gPSBbeDEsIHgyLCB4M10KCiAgICBtZGYgPSBkZi5waXZvdChpbmRleD0iUmVmZXJlbmNlIiwgY29sdW1ucz0iUG9zZSIsIHZhbHVlcz0iUk1TRCIpCiAgICBtZGYuZmlsbG5hKDApCiAgICBtZGYgPSBtZGYuYXN0eXBlKGZsb2F0KQogICAgaWYgcGxvdDoKICAgICAgICAjIHBsdC5maWd1cmUoZmlnc2l6ZT1bMTUsIDhdKQogICAgICAgIGhtYXAgPSBzbnMuaGVhdG1hcChtZGYsIGFubm90PWFubm90KQogICAgICAgIGhtYXAuc2V0X3RpdGxlKCJSTVNEIE1BVFJJWCIpCiAgICAgICAgaWYgc2F2ZToKICAgICAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKCIuL0dlbmVyYXRlZC9pbWFnZXMvIik6CiAgICAgICAgICAgICAgICBvcy5tYWtlZGlycygiLi9HZW5lcmF0ZWQvaW1hZ2VzLyIpCiAgICAgICAgICAgIGZpZyA9IGhtYXAuZmlndXJlCiAgICAgICAgICAgIGltYWdlID0gZiIuL0dlbmVyYXRlZC9pbWFnZXMve2tleX0uanBnIgogICAgICAgICAgICBmaWcuc2F2ZWZpZyhpbWFnZSwgZHBpPTYwMCkKICAgICAgICAgICAgcHJpbnQoZiJTYXZlZCAhIHtpbWFnZX0iKQogICAgcmV0dXJuIG1kZgo",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAASOwAAAAAAABI7AAAAAAAAAAAAAAAA8L8"
				],
				[
					6486,
					1,
					"insert",
					{
						"characters": "\\n"
					},
					"AgAAAMg8AAAAAAAAyTwAAAAAAAAAAAAAyTwAAAAAAADKPAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADIPAAAAAAAAMg8AAAAAAAAAAAAAAAA8L8"
				],
				[
					6490,
					1,
					"black",
					null,
					"AQAAAAAAAAAAAAAA0JMAAAAAAADQkwAAIyBGdW5jdGlvbnMgaW52bG92ZWQgaW4gZG9ja2luZyB1c2luZyBzbWluYQoKaW1wb3J0IHJlCmltcG9ydCBvcwppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgaXB5d2lkZ2V0cwppbXBvcnQgaXRlcnRvb2xzCmZyb20gaXB5d2lkZ2V0cyBpbXBvcnQgKAogICAgRmlsZVVwbG9hZCwKICAgIEludFNsaWRlciwKICAgIGZpeGVkLAogICAgaW50ZXJhY3RpdmUsCiAgICBpbnRlcmFjdGl2ZV9vdXRwdXQsCiAgICB3aWRnZXRzLAogICAgTGF5b3V0LAopCmZyb20gSVB5dGhvbi5kaXNwbGF5IGltcG9ydCBIVE1MLCBkaXNwbGF5CmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHQKZnJvbSBtYXRwbG90bGliLm9mZnNldGJveCBpbXBvcnQgQW5jaG9yZWRUZXh0CmZyb20gY3NmZG9jay51dGlscyBpbXBvcnQgZ2l2ZV9pZApmcm9tIHNrbGVhcm4uZGF0YXNldHMgaW1wb3J0IG1ha2VfY2xhc3NpZmljYXRpb24KZnJvbSBza2xlYXJuLmxpbmVhcl9tb2RlbCBpbXBvcnQgTGluZWFyUmVncmVzc2lvbiwgTG9naXN0aWNSZWdyZXNzaW9uCmZyb20gc2tsZWFybi5tZXRyaWNzIGltcG9ydCBhY2N1cmFjeV9zY29yZSwgcm9jX2F1Y19zY29yZSwgcm9jX2N1cnZlCmZyb20gc2tsZWFybi5tb2RlbF9zZWxlY3Rpb24gaW1wb3J0IEtGb2xkLCB0cmFpbl90ZXN0X3NwbGl0CmZyb20gc2NpcHkuc3BlY2lhbCBpbXBvcnQgZXhwaXQKaW1wb3J0IHNlYWJvcm4gYXMgc25zCmZyb20gcmljaC5jb25zb2xlIGltcG9ydCBDb25zb2xlCgpjb25zb2xlID0gQ29uc29sZSgpCgoKZGVmIGFkZF9oeWRyb2dlbihsaXN0X3h5eik6CiAgICAiIiJBIGZ1bmN0aW9uIHRvIGFkZCBoeWRyb2dlbiBhdG9tcyB1c2luZwogICAgb3BlbmJhYmVsIHRvIGEgbGlzdCBvZiBtb2xlY3VsZXMuCiAgICBDcmVhdGVzIHN1YiBmb2xkZXIgInByb3RlaW5faWQvcG9zZXMiIGluCiAgICBpbnB1dCBmaWxlIGRpcmVjdG9yeSBhbmQgZHVtcCB0aGVyZS4KICAgIEFyZ3M6CiAgICAgICAgbGlzdF94eXogKGxpc3QpOiBNb2xlY3VsZXMgdG8gYmUgYWRkZWQgSHlkcm9nZW4KICAgIFJldHVybnM6CiAgICAgICAgeHl6OiBzYXZlcyB4eXogaW4gcHJvdGVpbl9pZC9wb3NlcyB3aXRoIHN1ZmZpeCAiX2FkZEhzLnh5eiIKICAgICIiIgogICAgIyBGT1IgU0VSVkVSIG9yIHVzZSBvd24gcGF0aC4uCiAgICBPQkFCRUxfUEFUSCA9ICIvc2hhcmUvb3BlbmJhYmVsLTMuMS4xL2Jpbi9vYmFiZWwiCiAgICBmb3IgaSBpbiBsaXN0X3h5ejoKICAgICAgICBkaXJfbmFtZSwgaWQsIGZpbGVfZm9ybWF0ID0gZ2l2ZV9pZChpKQogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmIntkaXJfbmFtZX0vYWRkSC97aWRbOjRdfSIpOgogICAgICAgICAgICBvcy5tYWtlZGlycyhmIntkaXJfbmFtZX0vYWRkSC97aWRbOjRdfSIpCiAgICAgICAgY29tbWFuZCA9IGYie09CQUJFTF9QQVRIfSB7aX0gLU8ge2Rpcl9uYW1lfS9hZGRIL3tpZFs6NF19L3tpZH1fYWRkSHMueHl6IC1oIgogICAgICAgIHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIGN3ZD1mIntkaXJfbmFtZX0iLCBzaGVsbD1UcnVlKQogICAgcmV0dXJuICJTdWNjZXNzZnVsbHkgQ29tcGxldGVkLiIKCgpkZWYgcm1zZF9jYWxjdWxhdG9yKHJlZmVyZW5jZSwgcG9zZXNfbGlzdCwga2V5PU5vbmUsIG5vbWF0Y2g9RmFsc2UsIHZlcmJvc2U9VHJ1ZSk6CiAgICAiIiJDYWxjdWxhdGVzIFJNU0QgYmV0d2VlbiByZWZlcmVuY2UgYW5kIHBvc2UgdXNpbmcgb2JybXMgaW4gc2VydmVyLgogICAgQXJnczoKICAgICAgICByZWZlcmVuY2UgKHJlZmVyZW5jZSBtb2xlY3VsZSk6IFJlZmVyZW5jZSBtb2xlY3VsZQogICAgICAgIHBvc2VzX2xpc3QgKHRlc3RfcG9zZXMpOiBMaXN0IG9mIHBvc2VzIHRvIHRlc3Qgd2l0aCB0aGUgcmVmZXJlbmNlLgogICAgICAgIGtleT0gQW55IHN1ZmZpeCB0byBhZGQgdG8gdGhlIG5hbWUgb2YgdGhlIGZpbGUuCiAgICBSZXR1cm5zOgogICAgICAgIFR4dCBmaWxlOiBXcml0ZXMgcmVmZXJlbmNlLCBwb3NlcyBuYW1lIGFuZCBSTVNEIHRvIGEgbG9nIGZpbGUuCiAgICAiIiIKICAgIGNvdW50ID0gMAogICAgdHJ5OgogICAgICAgIGZvciByZWYgaW4gcmVmZXJlbmNlOgogICAgICAgICAgICBfLCByZWZfbmFtZSwgX2RpciA9IGdpdmVfaWQocmVmKQogICAgICAgICAgICByZWZfaWQgPSBvcy5wYXRoLmJhc2VuYW1lKHJlZikKICAgICAgICAgICAgcmVmX2RpciA9IG9zLnBhdGguZGlybmFtZShyZWYpCiAgICAgICAgICAgIHJlZl9kaXIgPSBvcy5wYXRoLmRpcm5hbWUocmVmX2RpcikKICAgICAgICAgICAgZm9yIHBvc2UgaW4gcG9zZXNfbGlzdDoKICAgICAgICAgICAgICAgIHBvc2VfaWQgPSBvcy5wYXRoLmJhc2VuYW1lKHBvc2UpCiAgICAgICAgICAgICAgICBpZiByZWZfaWRbOjRdLmxvd2VyKCkgPT0gcG9zZV9pZFs6NF0ubG93ZXIoKSBvciAobm9tYXRjaCBpcyBUcnVlKToKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gZiIvc2hhcmUvb3BlbmJhYmVsLTMuMS4xL2Jpbi9vYnJtcyB7cmVmfSBcdCB7cG9zZX0iCiAgICAgICAgICAgICAgICAgICAgcG9zZV9pZCA9IG9zLnBhdGguYmFzZW5hbWUocG9zZSkKICAgICAgICAgICAgICAgICAgICBybXNkX291dCA9IHN1YnByb2Nlc3MucnVuKAogICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kLAogICAgICAgICAgICAgICAgICAgICAgICBjd2Q9ZiJ7cmVmX2Rpcn0iLAogICAgICAgICAgICAgICAgICAgICAgICBjYXB0dXJlX291dHB1dD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0PVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHNoZWxsPVRydWUsCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmIntyZWZfZGlyfS9yZXN1bHQvUk1TRCIpOgogICAgICAgICAgICAgICAgICAgICAgICBvcy5tYWtlZGlycyhmIntyZWZfZGlyfS9yZXN1bHQvUk1TRCIpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBvcGVuKAogICAgICAgICAgICAgICAgICAgICAgICBmIntyZWZfZGlyfS9yZXN1bHQvUk1TRC97cmVmX2lkWzo0XX1fUk1TRF97a2V5fS50eHQiLCAiYSsiCiAgICAgICAgICAgICAgICAgICAgKSBhcyB3cml0ZV9vdXQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHJtc2RfcmVzdWx0ID0gZiJ7cG9zZV9pZC5sb3dlcigpfVx0IiArIHN0cihybXNkX291dC5zdGRvdXQpCiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfcm1zZCA9IGYie3JlZl9uYW1lfVx0e3Bvc2VfaWQubG93ZXIoKX1cdCIgKyBzdHIoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdChybXNkX291dC5zdGRvdXQuc3BsaXQoKVstMV0pCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQocm1zZF9yZXN1bHQsIGZpbGU9d3JpdGVfb3V0KQogICAgICAgICAgICAgICAgICAgIGNvdW50ICs9IDEKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJObyBtYXRjaGVkIGhlYWRlciBmb3VuZCIKICAgICAgICBpZiB2ZXJib3NlOgogICAgICAgICAgICBwcmludChmIlRvdGFsIG9mIHtjb3VudH0gcm1zZCBjYWxjdWxhdGVkLiIpCiAgICAgICAgcmV0dXJuIHRlbXBfcm1zZAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlcjoKICAgICAgICBwcmludChlcikKCgpkZWYgcm1zZF9tYXRyaXhfcHJlcChybXNkX3Jlc3VsdHMsIHByaW50X2l0PVRydWUsIHJldHVybl9kZj1UcnVlLCBvbmx5X2Jlc3Q9RmFsc2UpOgogICAgZGVmYXVsdF9zY29yaW5nXyA9IHt9CiAgICBhZDRfc2NvcmluZ18gPSB7fQogICAgZGtvZXNfZmFzdF9zY29yaW5nXyA9IHt9CiAgICBka29lc19zY29yaW5nX29sZF9zY29yaW5nXyA9IHt9CiAgICB2aW5hX3Njb3JpbmdfID0ge30KICAgIHZpbmFyZG9fc2NvcmluZ18gPSB7fQogICAgY3VzdG9tX3Njb3JpbmdfID0ge30KICAgIGJlc3QgPSB7fQogICAgd2l0aCBvcGVuKHJtc2RfcmVzdWx0c1swXSwgInIiKSBhcyBybXNkX3Jlc3VsdHNfcmVhZDoKICAgICAgICBmb3IgY291bnQsIGxpbmUgaW4gZW51bWVyYXRlKHJtc2RfcmVzdWx0c19yZWFkKToKICAgICAgICAgICAgbGluZV9pbmZvID0gbGluZS5yc3BsaXQoIi8iKVstMV0KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAga2V5LCB2YWx1ZSA9IGxpbmVfaW5mby5zcGxpdCgiLnBkYiIpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXI6CiAgICAgICAgICAgICAgICAjIHByaW50KGVyKQogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBpZiAiX2FkNF9zY29yaW5nXyIgaW4gbGluZToKICAgICAgICAgICAgICAgIGFkNF9zY29yaW5nX1trZXldID0gdmFsdWUuc3RyaXAoKQogICAgICAgICAgICBlbGlmICJfZGVmYXVsdF8iIGluIGtleToKICAgICAgICAgICAgICAgIGRlZmF1bHRfc2NvcmluZ19ba2V5XSA9IHZhbHVlLnN0cmlwKCkKICAgICAgICAgICAgZWxpZiAiX2Rrb2VzX2Zhc3RfIiBpbiBrZXk6CiAgICAgICAgICAgICAgICBka29lc19mYXN0X3Njb3JpbmdfW2tleV0gPSB2YWx1ZS5zdHJpcCgpCiAgICAgICAgICAgIGVsaWYgIl9ka29lc19zY29yaW5nX29sZF8iIGluIGtleToKICAgICAgICAgICAgICAgIGRrb2VzX3Njb3Jpbmdfb2xkX3Njb3JpbmdfW2tleV0gPSB2YWx1ZS5zdHJpcCgpCiAgICAgICAgICAgIGVsaWYgIl92aW5hXyIgaW4ga2V5OgogICAgICAgICAgICAgICAgdmluYV9zY29yaW5nX1trZXldID0gdmFsdWUuc3RyaXAoKQogICAgICAgICAgICBlbGlmICJfdmluYXJkb18iIGluIGtleToKICAgICAgICAgICAgICAgIHZpbmFyZG9fc2NvcmluZ19ba2V5XSA9IHZhbHVlLnN0cmlwKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGN1c3RvbV9zY29yaW5nX1trZXldID0gdmFsdWUuc3RyaXAoKQogICAgICAgICMgcHJpbnQoY291bnQpCiAgICB0cnk6CiAgICAgICAgYWQ0X2RmID0gcGQuRGF0YUZyYW1lLmZyb21fZGljdCgKICAgICAgICAgICAgYWQ0X3Njb3JpbmdfLCBvcmllbnQ9ImluZGV4IiwgY29sdW1ucz0oWyJhZDRfc2NvcmluZyJdKQogICAgICAgICkKICAgICAgICBkZWZhdWx0X2RmID0gcGQuRGF0YUZyYW1lLmZyb21fZGljdCgKICAgICAgICAgICAgZGVmYXVsdF9zY29yaW5nXywgb3JpZW50PSJpbmRleCIsIGNvbHVtbnM9KFsiZGVmYXVsdF9zY29yaW5nIl0pCiAgICAgICAgKQogICAgICAgIGRrb2VzX2Zhc3RfZGYgPSBwZC5EYXRhRnJhbWUuZnJvbV9kaWN0KAogICAgICAgICAgICBka29lc19mYXN0X3Njb3JpbmdfLCBvcmllbnQ9ImluZGV4IiwgY29sdW1ucz0oWyJka29lc19mYXN0X3Njb3JpbmciXSkKICAgICAgICApCiAgICAgICAgZGtvZXNfc2NvcmluZ19vbGRfZGYgPSBwZC5EYXRhRnJhbWUuZnJvbV9kaWN0KAogICAgICAgICAgICBka29lc19mYXN0X3Njb3JpbmdfLCBvcmllbnQ9ImluZGV4IiwgY29sdW1ucz0oWyJka29lc19mYXN0X3Njb3JpbmciXSkKICAgICAgICApCiAgICAgICAgdmluYV9kZiA9IHBkLkRhdGFGcmFtZS5mcm9tX2RpY3QoCiAgICAgICAgICAgIHZpbmFfc2NvcmluZ18sIG9yaWVudD0iaW5kZXgiLCBjb2x1bW5zPShbInZpbmFfc2NvcmluZyJdKQogICAgICAgICkKICAgICAgICB2aW5hcmRvX2RmID0gcGQuRGF0YUZyYW1lLmZyb21fZGljdCgKICAgICAgICAgICAgdmluYXJkb19zY29yaW5nXywgb3JpZW50PSJpbmRleCIsIGNvbHVtbnM9KFsidmluYXJkb19zY29yaW5nIl0pCiAgICAgICAgKQogICAgICAgIGN1c3RvbV9kZiA9IHBkLkRhdGFGcmFtZS5mcm9tX2RpY3QoCiAgICAgICAgICAgIGN1c3RvbV9zY29yaW5nXywgb3JpZW50PSJpbmRleCIsIGNvbHVtbnM9KFsiY3VzdG9tX3Njb3JpbmciXSkKICAgICAgICApCiAgICAgICAgcmV0dXJuX2RmID0gcGQuY29uY2F0KAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICBhZDRfZGYsCiAgICAgICAgICAgICAgICBkZWZhdWx0X2RmLAogICAgICAgICAgICAgICAgZGtvZXNfZmFzdF9kZiwKICAgICAgICAgICAgICAgIGRrb2VzX3Njb3Jpbmdfb2xkX2RmLAogICAgICAgICAgICAgICAgdmluYV9kZiwKICAgICAgICAgICAgICAgIHZpbmFyZG9fZGYsCiAgICAgICAgICAgICAgICBjdXN0b21fZGYsCiAgICAgICAgICAgIF0KICAgICAgICApCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGVyOgogICAgICAgIHByaW50KGYie2VyfVxuIGVycm9yIGluIGRhdGEgZnJhbWUiKQogICAgaWYgcHJpbnRfaXQ6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBhZDRfYmVzdCA9IG1pbihhZDRfc2NvcmluZ18uaXRlbXMoKSwga2V5PWxhbWJkYSB4OiB4WzFdKQogICAgICAgICAgICBwcmludCgiPT09PT09PT09PT1CRVNUIFJNU0Q9PT09PT09PT09PT09PT09PT09IikKICAgICAgICAgICAgYmVzdFthZDRfYmVzdFswXV0gPSBhZDRfYmVzdFsxXQogICAgICAgICAgICBwcmludChmInthZDRfYmVzdFswXX0gOiB7YWQ0X2Jlc3RbMV19IikKICAgICAgICAgICAgZGVmYXVsdF9iZXN0ID0gbWluKGRlZmF1bHRfc2NvcmluZ18uaXRlbXMoKSwga2V5PWxhbWJkYSB4OiB4WzFdKQogICAgICAgICAgICBiZXN0W2RlZmF1bHRfYmVzdFswXV0gPSBkZWZhdWx0X2Jlc3RbMV0KICAgICAgICAgICAgcHJpbnQoZiJ7ZGVmYXVsdF9iZXN0WzBdfSA6IHtkZWZhdWx0X2Jlc3RbMV19IikKICAgICAgICAgICAgZGtvZXNfZmFzdF9iZXN0ID0gbWluKGRrb2VzX2Zhc3Rfc2NvcmluZ18uaXRlbXMoKSwga2V5PWxhbWJkYSB4OiB4WzFdKQogICAgICAgICAgICBiZXN0W2Rrb2VzX2Zhc3RfYmVzdFswXV0gPSBka29lc19mYXN0X2Jlc3RbMV0KICAgICAgICAgICAgcHJpbnQoZiJ7ZGtvZXNfZmFzdF9iZXN0WzBdfSA6IHtka29lc19mYXN0X2Jlc3RbMV19IikKICAgICAgICAgICAgZGtvZXNfc2NvcmluZ19vbGRfYmVzdCA9IG1pbigKICAgICAgICAgICAgICAgIGRrb2VzX3Njb3Jpbmdfb2xkX3Njb3JpbmdfLml0ZW1zKCksIGtleT1sYW1iZGEgeDogeFsxXQogICAgICAgICAgICApCiAgICAgICAgICAgIGJlc3RbZGtvZXNfc2NvcmluZ19vbGRfYmVzdFswXV0gPSBka29lc19zY29yaW5nX29sZF9iZXN0WzFdCiAgICAgICAgICAgIHByaW50KGYie2Rrb2VzX3Njb3Jpbmdfb2xkX2Jlc3RbMF19IDp7ZGtvZXNfc2NvcmluZ19vbGRfYmVzdFsxXX0iKQogICAgICAgICAgICB2aW5hX2Jlc3QgPSBtaW4odmluYV9zY29yaW5nXy5pdGVtcygpLCBrZXk9bGFtYmRhIHg6IHhbMV0pCiAgICAgICAgICAgIGJlc3RbdmluYV9iZXN0WzBdXSA9IHZpbmFfYmVzdFsxXQogICAgICAgICAgICBwcmludChmInt2aW5hX2Jlc3RbMF19IDoge3ZpbmFfYmVzdFsxXX0iKQogICAgICAgICAgICB2aW5hcmRvX2Jlc3QgPSBtaW4odmluYXJkb19zY29yaW5nXy5pdGVtcygpLCBrZXk9bGFtYmRhIHg6IHhbMV0pCiAgICAgICAgICAgIGJlc3RbdmluYXJkb19iZXN0WzBdXSA9IHZpbmFyZG9fYmVzdFsxXQogICAgICAgICAgICBwcmludChmInt2aW5hcmRvX2Jlc3RbMF19IDoge3ZpbmFyZG9fYmVzdFstMV19IikKICAgICAgICAgICAgY3VzdG9tX2Jlc3QgPSBtaW4oY3VzdG9tX3Njb3JpbmdfLml0ZW1zKCksIGtleT1sYW1iZGEgeDogeFsxXSkKICAgICAgICAgICAgYmVzdFtjdXN0b21fYmVzdFswXV0gPSBjdXN0b21fYmVzdFsxXQogICAgICAgICAgICBwcmludChmIntjdXN0b21fYmVzdFswXX0gOiB7Y3VzdG9tX2Jlc3RbMV19IikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGVyOgogICAgICAgICAgICBwcmludChlcikKICAgIGlmIG9ubHlfYmVzdDoKICAgICAgICByZXR1cm4gYmVzdAogICAgaWYgcmV0dXJuX2RmIGlzIFRydWU6CiAgICAgICAgcmV0dXJuIHJldHVybl9kZgogICAgZWxzZToKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBkZWZhdWx0X3Njb3JpbmdfLAogICAgICAgICAgICBhZDRfc2NvcmluZ18sCiAgICAgICAgICAgIGRrb2VzX2Zhc3Rfc2NvcmluZ18sCiAgICAgICAgICAgIGRrb2VzX3Njb3Jpbmdfb2xkX3Njb3JpbmdfLAogICAgICAgICAgICB2aW5hX3Njb3JpbmdfLAogICAgICAgICAgICB2aW5hcmRvX3Njb3JpbmdfLAogICAgICAgICAgICBjdXN0b21fc2NvcmluZ18sCiAgICAgICAgKQoKCmRlZiBjb25mb3JtZXJfc3BsaXQoZmlsZW5hbWVzLCB0YXJnZXQpOgogICAgZm9yIGkgaW4gZmlsZW5hbWVzOgogICAgICAgIGZpbGVfZGlyLCBmaWxlX2lkLCBmaWxlX2Zvcm1hdCA9IGdpdmVfaWQoaSkKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoZiJ7ZmlsZV9kaXJ9L3Bvc2VzIik6CiAgICAgICAgICAgIG9zLm1ha2VkaXJzKGYie2ZpbGVfZGlyfS9wb3NlcyIpCiAgICAgICAgY29tbWFuZCA9ICgKICAgICAgICAgICAgZiIvc2hhcmUvb3BlbmJhYmVsLTMuMS4xL2Jpbi9vYmFiZWwge2l9IC1ve3RhcmdldH0gLU8iCiAgICAgICAgICAgIGYiIC4vcG9zZXMve2ZpbGVfaWR9Xy57dGFyZ2V0fSAtbSIKICAgICAgICApCiAgICAgICAgc3VicHJvY2Vzcy5ydW4oY29tbWFuZCwgY3dkPWYie2ZpbGVfZGlyfSIsIHNoZWxsPVRydWUpCiAgICByZXR1cm4gIlN1Y2Nlc3NmdWxseSBjb21wbGV0ZWQuIgoKCmRlZiBzbWluYV9oaXN0b2dyYW0oc29ydGVkX1JFUywgc2F2ZT1GYWxzZSk6CiAgICAiIiJDcmVhdGVzIGhpc3RvZ3JhbSBvZiBkb2NraW5nIGZyb20gc21pbmEgb3V0cHV0CiAgICBBcmdzOgogICAgICAgIHNvcnRlZF9SRVMgKGxpc3QpOiBTb3J0ZWQgbGlzdCBvZiBhZmZpbml0eSB2YWx1ZXMgZnJvbSBzbWluYSBvdXRwdXQuCiAgICAgICAgc2F2ZSAoYm9vbCwgb3B0aW9uYWwpOiBTYXZlIHBsb3QgaW4gLi9pbWFnZS9zbWluYV9oaXN0b2dyYW0ucG5nCiAgICAiIiIKICAgIG5hbWUsIGJlbmVyZ3kgPSB6aXAoKnNvcnRlZF9SRVMuaXRlbXMoKSkKICAgIGJlbmVyZ3kgPSBucC5hcnJheSgoYmVuZXJneSksIGR0eXBlPW5wLmZsb2F0MzIpCiAgICBtZWFuID0gYmVuZXJneS5tZWFuKCkKICAgIGJlc3QgPSBiZW5lcmd5Lm1pbigpCiAgICB3b3JzdCA9IGJlbmVyZ3kubWF4KCkKICAgIGZpZywgYXhzID0gcGx0LnN1YnBsb3RzKDEsIHNoYXJleT1GYWxzZSwgc2hhcmV4PUZhbHNlLCB0aWdodF9sYXlvdXQ9VHJ1ZSkKICAgIGF4cy5hZGRfYXJ0aXN0KAogICAgICAgIEFuY2hvcmVkVGV4dCgKICAgICAgICAgICAgZiJUb3RhbDoge2xlbihuYW1lKX1cbk1lYW46IHttZWFuOi4yZn1cbkJlc3Q6IHtiZXN0Oi4yZn1cbldvcnN0OiIKICAgICAgICAgICAgZiIge3dvcnN0Oi4yZn0iLAogICAgICAgICAgICBsb2M9MSwKICAgICAgICApCiAgICApCiAgICBheHMuaGlzdChiZW5lcmd5KQogICAgYXhzLnlheGlzLnNldF9sYWJlbF90ZXh0KCJOdW1iZXIgb2YgRGF0YXNldHMiKQogICAgYXhzLnhheGlzLnNldF9sYWJlbF90ZXh0KCJCaW5kaW5nIEVuZXJneSBSYW5nZSIpCiAgICBheHMuc2V0X3RpdGxlKCJEaXN0cmlidXRpb24gb2YgYmluZGluZyBlbmVyZ3kiKQogICAgaWYgc2F2ZToKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoIi4vaW1hZ2VzIik6CiAgICAgICAgICAgIG9zLm1ha2VkaXJzKCIuL2ltYWdlcyIpCiAgICAgICAgcGx0LnNhdmVmaWcoIi4vaW1hZ2VzL3NtaW5hX2hpc3RvZ3JhbS5wbmciLCBkcGk9NjAwKQogICAgcGx0LnNob3coKQoKCmRlZiBzbWluYV9tb25pdG9yKHNtaW5hX291dHB1dF9tb25pdG9yLCBwbG90PUZhbHNlLCBzYXZlPUZhbHNlKToKICAgICIiIkRpc3BsYXkgc21pbmEgcHJvY2VzcyB3aGlsZSBlbnRlciBzbWluYSBzdGRvdXQKICAgIEFyZ3M6CiAgICAgICAgc21pbmFfb3V0cHV0X21vbml0b3IgKHN0ZG91dCk6IHN0ZG91dCBmcm9tIHFzdGF0L3FzdWIKICAgIFJldHVybnM6CiAgICAgICAgZGljdDogRGlzcGxheXMgcmVzdWx0IGluIGp1cHl0ZXIKICAgICIiIgogICAgUkVTID0ge30KICAgIGNvdW50ID0gMAogICAgZm9yIGkgaW4gc21pbmFfb3V0cHV0X21vbml0b3I6CiAgICAgICAgYWxnb19kaXIsIGFsZ29fbmFtZSwgYWxnb19mb3JtYXQgPSBnaXZlX2lkKGkpCiAgICAgICAgaWYgYWxnb19mb3JtYXQubG93ZXIoKSA9PSAicGRiIjoKICAgICAgICAgICAgd2l0aCBvcGVuKGksICJyIikgYXMgcmVhZF9zbWluYToKICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIHJlYWRfc21pbmE6CiAgICAgICAgICAgICAgICAgICAgaWYgbGluZVs6NV0gPT0gIk1PREVMIjoKICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyID0gbGluZVs1Ol0uc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIGVsaWYgIlJFTUFSSyIgaW4gbGluZToKICAgICAgICAgICAgICAgICAgICAgICAgZW5lcmd5ID0gZmxvYXQobGluZS5yc3BsaXQoIiAiKVstMV0uc3RyaXAoKSkKICAgICAgICAgICAgICAgICAgICAgICAgUkVTW2Yie2FsZ29fbmFtZX1fe251bWJlcn0iXSA9IGYie2VuZXJneX0iCiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ICs9IDEKICAgICAgICBlbGlmIGFsZ29fZm9ybWF0Lmxvd2VyKCkgPT0gInNkZiI6CiAgICAgICAgICAgIHBhdHRlcm5faWQgPSByIl5bYS16QS1aXVxTIgogICAgICAgICAgICBwYXR0ZXJuX2FmZmluaXR5ID0gciJePlxzPFthLXpBLVpdKz4iCiAgICAgICAgICAgIHdpdGggb3BlbihpLCAiciIpIGFzIHJlYWRfc21pbmE6CiAgICAgICAgICAgICAgICB3cml0ZV9hZmZpbml0eSA9IEZhbHNlCiAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiByZWFkX3NtaW5hOgogICAgICAgICAgICAgICAgICAgIGlmIHdyaXRlX2FmZmluaXR5OgogICAgICAgICAgICAgICAgICAgICAgICBlbmVyZ3kgPSBmbG9hdChsaW5lLnN0cmlwKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICMgcHJpbnQoZW5lcmd5KQogICAgICAgICAgICAgICAgICAgICAgICBSRVNbZiJ7YWxnb19uYW1lfV97bnVtYmVyfSJdID0gZiJ7ZW5lcmd5fSIKICAgICAgICAgICAgICAgICAgICAgICAgY291bnQgKz0gMQogICAgICAgICAgICAgICAgICAgICAgICB3cml0ZV9hZmZpbml0eSA9IEZhbHNlCiAgICAgICAgICAgICAgICAgICAgaWYgcmUubWF0Y2gocGF0dGVybl9pZCwgbGluZSk6CiAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlciA9IGxpbmUuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIGVsaWYgcmUubWF0Y2gocGF0dGVybl9hZmZpbml0eSwgbGluZSk6CiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlX2FmZmluaXR5ID0gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAiRmlsZSBmb3JtYXQgbm90IHN1cHBvcnRlZCB5ZXQuIFsncGRiJywgJ3NkZiddIgoKICAgIHByaW50KGYiVG90YWwgbnVtYmVyIG9mIHBvc2VzIGdlbmVyYXRlZDoge2NvdW50fSIpCiAgICBzb3J0ZWRfUkVTID0gZGljdChzb3J0ZWQoUkVTLml0ZW1zKCksIGtleT1sYW1iZGEgeDogeFsxXSkpCiAgICBwcmludCgiX19fX19fX19fX19fX0RldGFpbCBsaXN0X19fX19fX19fX19fX19fX1xuIikKICAgIGZvciBrZXksIHZhbHVlIGluIHNvcnRlZF9SRVMuaXRlbXMoKToKICAgICAgICBwcmludChrZXksICI6IiwgdmFsdWUpCiAgICBpZiBwbG90OgogICAgICAgIHNtaW5hX2hpc3RvZ3JhbShzb3J0ZWRfUkVTLCBzYXZlPXNhdmUpCgogICAgcmV0dXJuIHNvcnRlZF9SRVMKCgpkZWYgYXVjX3Bsb3QobW9kZWwsIFhfdGVzdCwgeV90ZXN0LCBzYXZlPUZhbHNlKToKICAgICIiIlBsb3QgQVVDIHBsb3QgZnJvbSBtb2RlbCwgYW5kIFhfdGV4dChkYXRhIHBvaW50KSB5X3Rlc3QobGFiZWwpLgogICAgQXJnczoKICAgICAgICBtb2RlbCAoc2tsZWFybiBvYmopXzogTW9kZWwgb2JqZWN0IGZyb20gc2tsZWFybiB0cmFpbmVkIG1vZGVsLgogICAgICAgIFhfdGVzdCAocGQuRGF0YUZyYW1lKTogRGF0YSBwb2ludCBmb3IgdGVzdC4KICAgICAgICB5X3Rlc3QgKHBkLkRhdGFGcmFtZSk6IExhYmVsIGZvciB0aGUgZGF0YSBwb2ludC4KICAgICAgICBzYXZlIChib29sLCBvcHRpb25hbCk6IFNhdmUgQVVDIHBsb3QuCiAgICAiIiIKICAgICMgYXNzZXJ0IGlzaW5zdGFuY2UobW9kZWwsIExpbmVhclJlZ3Jlc3Npb24pLCBmInttb2RlbH0gaXMgbm90IGEgdmFsaWQgbW9kZWwiCiAgICAjIGFzc2VydCBpc2luc3RhbmNlKFhfdGVzdCwgcGQuRGF0YUZyYW1lKSwgZiJ7WF90ZXN0fSBpcyBub3QgYSBEYXRhRnJhbWUiCiAgICAjIGFzc2VydCBpc2luc3RhbmNlKHlfdGVzdCwgcGQuRGF0YUZyYW1lKSwgZiJ7eV90ZXN0fSBpcyBub3QgYSBEYXRhRnJhbWUiCiAgICBtb2RlbF9yZWdyZXNzaW9uX3Byb2JhYmlsaXR5ID0gbW9kZWwucHJlZGljdF9wcm9iYShYX3Rlc3QpCiAgICBtb2RlbF9yZWdyZXNzaW9uX3Byb2JhYmlsaXR5ID0gbW9kZWxfcmVncmVzc2lvbl9wcm9iYWJpbGl0eVs6LCAxXQogICAgcmFuZG9tX3Byb2JhYmlsaXR5ID0gWzAgZm9yIF8gaW4gcmFuZ2UobGVuKHlfdGVzdCkpXQogICAgcmFuZG9tX2F1YyA9IHJvY19hdWNfc2NvcmUoeV90ZXN0LCByYW5kb21fcHJvYmFiaWxpdHkpCiAgICBtb2RlbF9hdWMgPSByb2NfYXVjX3Njb3JlKHlfdGVzdCwgbW9kZWxfcmVncmVzc2lvbl9wcm9iYWJpbGl0eSkKICAgIHByaW50KGYiUmFuZG9tOiBST0MgQVVDPXtyYW5kb21fYXVjfSIpCiAgICBwcmludChmIk1vZGVsOiBST0MgQVVDPXttb2RlbF9hdWN9IikKICAgIHJhbmRvbV9mYWxzZV9wb3NpdGl2ZV9yYXRlLCByYW5kb21fdHJ1ZV9wb3NpdGl2ZV9yYXRlLCBfID0gcm9jX2N1cnZlKAogICAgICAgIHlfdGVzdCwgcmFuZG9tX3Byb2JhYmlsaXR5CiAgICApCiAgICBtb2RlbF9mYWxzZV9wb3NpdGl2ZV9yYXRlLCBtb2RlbF90cnVlX3Bvc2l0aXZlX3JhdGUsIF8gPSByb2NfY3VydmUoCiAgICAgICAgeV90ZXN0LCBtb2RlbF9yZWdyZXNzaW9uX3Byb2JhYmlsaXR5CiAgICApCiAgICBwbHQucGxvdCgKICAgICAgICByYW5kb21fZmFsc2VfcG9zaXRpdmVfcmF0ZSwKICAgICAgICByYW5kb21fdHJ1ZV9wb3NpdGl2ZV9yYXRlLAogICAgICAgIGxpbmVzdHlsZT0iLS0iLAogICAgICAgIGxhYmVsPSJSYW5kb20iLAogICAgKQogICAgcGx0LnBsb3QoCiAgICAgICAgbW9kZWxfZmFsc2VfcG9zaXRpdmVfcmF0ZSwKICAgICAgICBtb2RlbF90cnVlX3Bvc2l0aXZlX3JhdGUsCiAgICAgICAgbWFya2VyPSIuIiwKICAgICAgICBsYWJlbD1mIk1vZGVsIChBVUM6e21vZGVsX2F1YzouMmZ9KSIsCiAgICApCiAgICBwbHQueGxhYmVsKCJGYWxzZSBQb3NpdGl2ZSBSYXRlIikKICAgIHBsdC55bGFiZWwoIlRydWUgUG9zaXRpdmUgUmF0ZSIpCiAgICBwbHQueGxpbSh4bWluPTAuMCkKICAgIHBsdC55bGltKHltaW49MC4wKQogICAgcGx0LnRpdGxlKCJST0MiKQogICAgcGx0LmxlZ2VuZCgpCiAgICBpZiBzYXZlOgogICAgICAgIHByZWZpeCA9ICJpbWFnZSIKICAgICAgICB3aGlsZSBvcy5wYXRoLmV4aXN0cyhmIi4vR2VuZXJhdGVkL2ltYWdlcy97cHJlZml4fS5wbmciKToKICAgICAgICAgICAgc3VmZml4ICs9IDEKICAgICAgICAgICAgbmFtZSA9IGYie3ByZWZpeH17c3VmZml4fS5wbmciCiAgICAgICAgcGx0LnNhdmVmaWcoIi4vR2VuZXJhdGVkL2ltYWdlcy97bmFtZX0iLCBkcGk9NjAwKQogICAgcGx0LnNob3coKQoKCmRlZiBzbWluYV9tb2RlbF9zY29yZSgKICAgIGZpbGVfcGF0aCwKICAgIG51bV9mZWF0dXJlcz0zLAogICAgaW50ZXJjZXB0PUZhbHNlLAogICAgdHNpemU9MC4zLAogICAgcGxvdF9hdWM9RmFsc2UsCiAgICBwbG90X3NhdmU9RmFsc2UsCik6CiAgICAiIiJHZW5lcmF0ZXMgcmVncmVzc2lvbiBtb2RlbCB1c2luZyBza2xlYXJuLiBXaWxsIFByaW50IG91dCBjb2VmZmljaWVudHMKICAgIEFyZ3M6CiAgICAgICAgZmlsZV9wYXRoIChzdHIpOiBjc3YvZXhjZWwgZmlsZSBwYXRoCiAgICAgICAgbnVtX2ZlYXR1cmVzIChpbnQsIG9wdGlvbmFsKTogTnVtYmVyIG9mIGZlYXR1cmVzIHRvIHVzZS4gRGVmYXVsdDogMwogICAgICAgIGludGVyY2VwdCAoYm9vbCwgb3B0aW9uYWwpOiBNZWFuIEVycm9yCiAgICAgICAgdHNpemUgKGZsb2F0LCBvcHRpb25hbCk6IFBlcmNlbnRhZ2Ugb2YgZGF0YXRvIHVzZSBmb3IgdGVzdC4gRGVmYXVsdCAwLjMoMzAlKQogICAgICAgIHBsb3RfYXVjIChib29sLCBvcHRpb25hbCk6IFBsb3QgUk9DIEFVQyBjdXJ2ZQogICAgICAgIHBsb3Rfc2F2ZSAoYm9vbCwgb3B0aW9uYWwpOiBTYXZlIFJPQyBBVUMgcGxvdAogICAgIiIiCiAgICB0cnk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShmaWxlX3BhdGgsIHN0cik6CiAgICAgICAgICAgIGZpbGVfZGlyLCBmaWxlX25hbWUsIGZpbGVfZm9ybWF0ID0gZ2l2ZV9pZChmaWxlX3BhdGgpCiAgICAgICAgICAgIHN1cHBvcnRlZF9maWxlX2Zvcm1hdCA9IFsiY3N2IiwgImV4Y2VsIl0gICMgZm9yIG5vdyB8IHNtaW5hIHJlc3VsdCBmaWxlCiAgICAgICAgICAgIGFzc2VydCBmaWxlX2Zvcm1hdCBpbiBzdXBwb3J0ZWRfZmlsZV9mb3JtYXQsICgKICAgICAgICAgICAgICAgICJOb3RlOiBGaWxlVHlwZSBFcnJvcjogTm90IHN1cHBvcnRlZCBmaWxlIGZvcm1hdC4gVXNlIgogICAgICAgICAgICAgICAgZiIge3N1cHBvcnRlZF9maWxlX2Zvcm1hdH0iCiAgICAgICAgICAgICkKICAgICAgICAgICAgaWYgZmlsZV9mb3JtYXQgPT0gImV4Y2VsIjoKICAgICAgICAgICAgICAgIGRmID0gcGQucmVhZF9leGNlbChmaWxlX3BhdGgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBkZiA9IHBkLnJlYWRfY3N2KGZpbGVfcGF0aCkKCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZSkKCiAgICBpZiBpc2luc3RhbmNlKGZpbGVfcGF0aCwgcGQuRGF0YUZyYW1lKToKICAgICAgICBkZiA9IGZpbGVfcGF0aAogICAgdHJ5OgogICAgICAgIFgsIHkgPSBkZi5pbG9jWzE6LCAxOi0yXSwgZGYuaWxvY1sxOiwgLTFdCiAgICAgICAgWCA9IHBkLkRhdGFGcmFtZShYKQogICAgICAgIGhlYWRlciA9IFguaWxvY1s6MCwgOl0KICAgICAgICBYLCB5ID0gbWFrZV9jbGFzc2lmaWNhdGlvbihuX2ZlYXR1cmVzPW51bV9mZWF0dXJlcykKICAgICAgICBYX3RyYWluLCBYX3Rlc3QsIHlfdHJhaW4sIHlfdGVzdCA9IHRyYWluX3Rlc3Rfc3BsaXQoCiAgICAgICAgICAgIFgsIHksIHRlc3Rfc2l6ZT10c2l6ZQogICAgICAgICkgICMgVE9ETyAvL2luY2x1ZGUgSy1Gb2xkIFRlc3QKICAgICAgICBtb2RlbCA9IExvZ2lzdGljUmVncmVzc2lvbihmaXRfaW50ZXJjZXB0PWludGVyY2VwdCkKICAgICAgICBtb2RlbC5maXQoWF90cmFpbiwgeV90cmFpbikgICMgVE9ET0QgYWNjZXB0IHVzZSBtb2RlbCBpbnB1dAogICAgICAgIHdlaWdodCA9IG1vZGVsLmNvZWZfCiAgICAgICAgd2VpZ2h0ID0gW2l0ZW0gZm9yIGkgaW4gd2VpZ2h0IGZvciBpdGVtIGluIGldCiAgICAgICAgY29uc29sZS5wcmludCgiW2JvbGQgY3lhbl1Nb2RlbCB3ZWlnaHRzIGFyZSA6flsvYm9sZCBjeWFuXVxuIikKICAgICAgICBmb3IgaGVhZCwgY29lZmYgaW4gemlwKGhlYWRlciwgd2VpZ2h0KToKICAgICAgICAgICAgcHJpbnQoY29lZmYsIGhlYWQsIGVuZD0iXG4iKQogICAgICAgIG1vZGVsLnByZWRpY3QoWF90ZXN0KQogICAgICAgIG1vZGVsLnByZWRpY3RfcHJvYmEoWF90ZXN0KQogICAgICAgIHNjb3JlID0gbW9kZWwuc2NvcmUoWF90ZXN0LCB5X3Rlc3QpCiAgICAgICAgcHJpbnQoZiJcbk1vZGVsIHNjb3JlOiB7c2NvcmV9IikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXI6CiAgICAgICAgcHJpbnQoZXIpCiAgICBpZiBwbG90X2F1YzoKICAgICAgICBhdWNfcGxvdChtb2RlbCwgWF90ZXN0LCB5X3Rlc3QsIHNhdmU9cGxvdF9zYXZlKQogICAgICAgICMgdHJhaW5fcGxvdChtb2RlbCwgWCwgeSwgWF90ZXN0LCB5X3Rlc3QpCiAgICByZXR1cm4gbW9kZWwKCgpkZWYgdHJhaW5fcGxvdChtb2RlbCwgWCwgeSwgWF90ZXN0LCB5X3Rlc3QpOgogICAgcGx0LmZpZ3VyZSgxLCBmaWdzaXplPSg0LCAzKSkKICAgIHBsdC5jbGYoKQogICAgcHJpbnQobGVuKFgpKQogICAgcHJpbnQobGVuKHkpKQogICAgcGx0LnNjYXR0ZXIoWC5yYXZlbCgpLCB5LCBjb2xvcj0iYmxhY2siLCB6b3JkZXI9MjApCiAgICAjIHBsdC5zY2F0dGVyKHlfdGVzdCwgWF90ZXN0Lmlsb2NbOiwwXS52YWx1ZXMpCiAgICBsb3NzID0gZXhwaXQoWF90ZXN0ICogbW9kZWwuY29lZl8gKyBtb2RlbC5pbnRlcmNlcHRfKS5yYXZlbCgpCiAgICBwbHQucGxvdChYX3Rlc3QsIGxvc3MsIGNvbG9yPSJyZWQiLCBsaW5ld2lkdGg9MykKCiAgICBvbHMgPSBMaW5lYXJSZWdyZXNzaW9uKCkKICAgIG9scy5maXQoWCwgeSkKICAgIHBsdC5wbG90KFhfdGVzdCwgb2xzLmNvZWZfICogWF90ZXN0ICsgb2xzLmludGVyY2VwdF8sIGxpbmV3aWR0aD0xKQogICAgcGx0LmF4aGxpbmUoMC41LCBjb2xvcj0iLjUiKQoKICAgIHBsdC55bGFiZWwoInkiKQogICAgcGx0LnhsYWJlbCgiWCIpCiAgICBwbHQueHRpY2tzKHJhbmdlKC01LCAxMCkpCiAgICBwbHQueXRpY2tzKFswLCAwLjUsIDFdKQogICAgcGx0LnlsaW0oLTAuMjUsIDEuMjUpCiAgICBwbHQueGxpbSgtNCwgMTApCiAgICBwbHQubGVnZW5kKAogICAgICAgICgiTG9naXN0aWMgUmVncmVzc2lvbiBNb2RlbCIsICJMaW5lYXIgUmVncmVzc2lvbiBNb2RlbCIpLAogICAgICAgIGxvYz0ibG93ZXIgcmlnaHQiLAogICAgICAgIGZvbnRzaXplPSJzbWFsbCIsCiAgICApCiAgICBwbHQudGlnaHRfbGF5b3V0KCkKICAgIHBsdC5zaG93KCkKCgpkZWYgaW5wdXRfY3VzdG9tX3Njb3JpbmcoKToKICAgICIiIkdVSSB3aW5kb3cgdG8gZW50ZXIgY3VzdG9tIHNjb3JpbmcgZnVuY3Rpb24iIiIKICAgICMgaW5pdGlhbGl6ZSBzb21lIG1zZyBhbmQgb3V0cHV0IGVudgogICAgb3V0cHV0X2NzZiA9IHdpZGdldHMuT3V0cHV0KCkKICAgIG1zZ19lbXB0eV9uYW1lID0gIkVudGVyIGFueSBuYW1lIGZvciB0aGUgZmlsZS4iCiAgICB3YXJuX2VtcHR5X25hbWUgPSB3aWRnZXRzLkhUTUwodmFsdWU9ZiI8Yj48Zm9udCBjb2xvcj0ncmVkJz57bXNnX2VtcHR5X25hbWV9PC9iPiIpCiAgICAjIHNhdmUgdGhlIGlucHV0IGN1c3RvbSBzY29yaW5nIHZhbHVlCiAgICBkZWYgc2F2ZV9zY29yaW5nKGRhdGEpOgogICAgICAgIG91dHB1dF9jc2YuY2xlYXJfb3V0cHV0KCkKICAgICAgICBtc2dfY29uZmlybV93YXJuID0gIlBsZWFzZSBjb25maXJtIGlmIHRoZSB2YWx1ZXMgYXJlIHJpZ2h0LiIKICAgICAgICBpbmZvcm1hdGlvbiA9IGlweXdpZGdldHMud2lkZ2V0cy5IVE1MKAogICAgICAgICAgICB2YWx1ZT1mIjxiPjxmb250IGNvbG9yPSdyZWQnPnttc2dfY29uZmlybV93YXJufTwvYj4iCiAgICAgICAgKQogICAgICAgIGdsb2JhbCBzY29yaW5nX2RhdGEKICAgICAgICBnbG9iYWwgdGVtcF9uYW1lCiAgICAgICAgdGVtcF9uYW1lID0gZmlsZV9uYW1lLnZhbHVlCiAgICAgICAgaWYgbm90IHRlbXBfbmFtZToKICAgICAgICAgICAgd2l0aCBvdXRwdXRfY3NmOgogICAgICAgICAgICAgICAgZGlzcGxheSh3YXJuX2VtcHR5X25hbWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3BsaXR0ZWQgPSBjdXN0b21fc2NvcmluZ19hcmVhLnZhbHVlLnNwbGl0KCJcbiIpCiAgICAgICAgICAgIHNjb3JpbmdfZGF0YSA9IFtdCiAgICAgICAgICAgIGZvciBzcGxpdCBpbiBzcGxpdHRlZDoKICAgICAgICAgICAgICAgIHNwbGl0ID0gc3BsaXQuc3RyaXAoKQogICAgICAgICAgICAgICAgc2NvcmluZ19kYXRhLmFwcGVuZChzcGxpdCkKICAgICAgICAgICAgd2l0aCBvdXRwdXRfY3NmOgogICAgICAgICAgICAgICAgcHJpbnQoZiJFbnRlcmVkIGZpbGUgbmFtZSA6IHt0ZW1wX25hbWV9IikKICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIHNjb3JpbmdfZGF0YToKICAgICAgICAgICAgICAgICAgICBpZiBzZWxlY3QgPT0gImN1c3RvbV9zY29yaW5nIjoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGxpbmUucnN0cmlwKCkpICE9IDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSwgaXRlbSA9IGxpbmUuc3BsaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJ7dmFsdWV9XHR7aXRlbX0iKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGxpbmUpCiAgICAgICAgICAgICAgICBkaXNwbGF5KGluZm9ybWF0aW9uKQoKICAgICMgd3JpdGVzIHRoZSBzYXZlIHNjb3JpbmcgZGF0YSB0byBhIGZpbGUKICAgIGRlZiBjb25maXJtX3Njb3JpbmcoZGF0YSk6CiAgICAgICAgb3V0cHV0X2NzZi5jbGVhcl9vdXRwdXQoKQogICAgICAgIGlmIG5vdCB0ZW1wX25hbWU6CiAgICAgICAgICAgIHdpdGggb3V0cHV0X2NzZjoKICAgICAgICAgICAgICAgIGRpc3BsYXkod2Fybl9lbXB0eV9uYW1lKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1zZ19zdWNjZXNzID0gIkNvbmZpcm1lZCBhbmQgU2F2ZWQhIgogICAgICAgICAgICBpbmZvcm1hdGlvbiA9IGlweXdpZGdldHMud2lkZ2V0cy5IVE1MKAogICAgICAgICAgICAgICAgdmFsdWU9ZiI8Yj48Zm9udCBjb2xvcj0nZ3JlZW4nPnttc2dfc3VjY2Vzc308L2I+IgogICAgICAgICAgICApCiAgICAgICAgICAgIGZpbGVfbmFtZV9zYXZlID0gdGVtcF9uYW1lCiAgICAgICAgICAgIGZpbGVfY29udGVudCA9IHNjb3JpbmdfZGF0YQogICAgICAgICAgICBpZiBzZWxlY3QgPT0gImN1c3RvbV9zY29yaW5nIjoKICAgICAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cygiLi9HZW5lcmF0ZWQvY3VzdG9tX2Z1bmN0aW9uIik6CiAgICAgICAgICAgICAgICAgICAgb3MubWFrZWRpcnMoIi4vR2VuZXJhdGVkL2N1c3RvbV9mdW5jdGlvbiIpCiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oCiAgICAgICAgICAgICAgICAgICAgZiIuL0dlbmVyYXRlZC9jdXN0b21fZnVuY3Rpb24ve2ZpbGVfbmFtZV9zYXZlfV9jc2YudHh0IiwgIncrIgogICAgICAgICAgICAgICAgKSBhcyB3cml0ZV9zY29yaW5nX2Z1bmN0aW9uOgogICAgICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIGZpbGVfY29udGVudDoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGxpbmUucnN0cmlwKCkpICE9IDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSwgaXRlbSA9IGxpbmUuc3BsaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJ7dmFsdWV9XHR7aXRlbX0iLCBmaWxlPXdyaXRlX3Njb3JpbmdfZnVuY3Rpb24pCgogICAgICAgICAgICAgICAgaW5mbyA9ICgKICAgICAgICAgICAgICAgICAgICBmImZpbGUgc2F2ZSBhdCAuL0dlbmVyYXRlZC9jdXN0b21fZnVuY3Rpb24ve2ZpbGVfbmFtZV9zYXZlfV9jc2YudHh0IgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKCIuL0dlbmVyYXRlZC9zbWluYV9pbnB1dCIpOgogICAgICAgICAgICAgICAgICAgIG9zLm1ha2VkaXJzKCIuL0dlbmVyYXRlZC9zbWluYV9pbnB1dCIpCiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oCiAgICAgICAgICAgICAgICAgICAgZiIuL0dlbmVyYXRlZC9zbWluYV9pbnB1dC97ZmlsZV9uYW1lX3NhdmV9X21jb25maWcudHh0IiwgIncrIgogICAgICAgICAgICAgICAgKSBhcyB3cml0ZV9jb25maWc6CiAgICAgICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gZmlsZV9jb250ZW50OgogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIntsaW5lfSIsIGZpbGU9d3JpdGVfY29uZmlnKQoKICAgICAgICAgICAgICAgIGluZm8gPSAoCiAgICAgICAgICAgICAgICAgICAgZiJmaWxlIHNhdmUgYXQgLi9HZW5lcmF0ZWQvc21pbmFfaW5wdXQve2ZpbGVfbmFtZV9zYXZlfV9tY29uZmlnLnR4dCIKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgd2l0aCBvdXRwdXRfY3NmOgogICAgICAgICAgICAgICAgcHJpbnQoaW5mbykKICAgICAgICAgICAgICAgIGRpc3BsYXkoaW5mb3JtYXRpb24pCgogICAgIyBkZWYgYWxsX2NsZWFyKGRhdGEpOgogICAgIyAgICB3aXRoIG91dHB1dF9jc2Y6CiAgICAjICAgICAgICBvdXRwdXRfY3NmLmNsZWFyX291dHB1dCgpCiAgICAjICN0ZXh0IGFyZWEgdG8gb2JzZXJ2ZSBhbGwgaW5wdXQgdGV4dAogICAgY29uZmlnX3BsYWNlaG9sZGVyID0gKAogICAgICAgICJQYXN0ZSBoZXJlXG4gICAgICAgIFxuICAgICAgICBTYW1wbGUgY29uZmlnLnR4dCBEb2NraW5nIHBhcmFtZXRlcnMgZmlsZVxuICAgICAiCiAgICAgICAgIiAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgI0lucHV0c1xuICAgICAgICByZWNlcHRvciA9IgogICAgICAgICIgLi8zTDZCX3Byb3QucGRicXRcbiAgICAgICAgbGlnYW5kID0gLi8zTDZCX2xpZy5wZGJxdFxuICAgICAgICAjT3V0cHV0c1xuICAgICAiCiAgICAgICAgIiAgIG91dCA9IDNMNkItbm93YXQtVmluYS5wZGJxdFxuICAgICAgICBsb2cgPSAzTDZCLW5vd2F0LVZpbmEubG9nXG4gICAgICAgIgogICAgICAgICIgI0JveCBjZW50ZXJcbiAgICAgICAgY2VudGVyX3ggPSA0LjUwMFxuICAgICAgICBjZW50ZXJfeSA9IC0yLjk0NFxuICAgICAgICIKICAgICAgICAiIGNlbnRlcl96ID0gLTUuMjUwXG4gICAgICAgICNCb3ggc2l6ZVxuICAgICAgICBzaXplX3ggPSA1MFxuICAgICAgICBzaXplX3kgPSIKICAgICAgICAiIDUwXG4gICAgICAgIHNpemVfeiA9IDUwXG4gICAgICAgICNQYXJhbWV0ZXJzXG4gICAgICAgIGV4aGF1c3RpdmVuZXNzID0gOFxuICAgIgogICAgICAgICIgICAgIHNlZWQgPSAxMjM0NTZcbiIKICAgICkKICAgIGNzZl9wbGFjZWhvbGRlciA9ICgKICAgICAgICAiIFBhc3RlIGhlcmVcbiAgICAgICAgXG4gICAgICAgICAgICBTYW1wbGUgZm9ybWF0IG9mIGN1c3RvbSBzY29yaW5nXG4gICAgICAgIgogICAgICAgICIgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAtMC4wMzU1NzkgICAiCiAgICAgICAgIiBnYXVzcyhvPTAsX3c9MC41LF9jPTgpXG4gICAgICAgIC0wLjAwNTE1NiAgICBnYXVzcyhvPTMsX3c9MixfYz04XG4gICAgICAgIgogICAgICAgICIgMC44NDAyNDUgICAgIHJlcHVsc2lvbihvPTAsX2M9OClcbiAgICAgICAgLTAuMDM1MDY5ICAgIgogICAgICAgICIgaHlkcm9waG9iaWMoZz0wLjUsX2I9MS41LF9jPTgpXG4gICAgICAgIC0wLjU4NzQzOSAgICIKICAgICAgICAiIG5vbl9kaXJfaF9ib25kKGc9LTAuNyxfYj0wLF9jPTgpXG4gICAgICAgIDEuOTIzICAgICAgICBudW1fdG9yc19kaXZcbiAgICAgICAiCiAgICAgICAgIiAtMTAwLjAgICAgICAgYXRvbV90eXBlX2dhdXNzaWFuKHQxPUNobG9yaW5lLHQyPVN1bGZ1cixvPTAsX3c9MyxfYz04KVxuIgogICAgKQoKICAgIGRlZiBldmFsdWF0ZShzZWxlY3RlZCk6CiAgICAgICAgb3V0cHV0X2NzZi5jbGVhcl9vdXRwdXQoKQogICAgICAgIGFyZWFfbGF5b3V0ID0gTGF5b3V0KHdpZHRoPSIxMDAlIiwgaGVpZ2h0PSI0MDBweCIsIGZsZXg9InJvdyIpCiAgICAgICAgZ2xvYmFsIHNlbGVjdAogICAgICAgIHNlbGVjdCA9IHNlbGVjdGVkCiAgICAgICAgaWYgc2VsZWN0ZWQgPT0gImN1c3RvbV9zY29yaW5nIjoKICAgICAgICAgICAgZ2xvYmFsIGN1c3RvbV9zY29yaW5nX2FyZWEKICAgICAgICAgICAgY3VzdG9tX3Njb3JpbmdfYXJlYSA9IHdpZGdldHMuVGV4dGFyZWEoCiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1jc2ZfcGxhY2Vob2xkZXIsCiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj0iRW50ZXI6IiwKICAgICAgICAgICAgICAgIGRpc2FibGVkPUZhbHNlLAogICAgICAgICAgICAgICAganVzdGlmeV9jb250ZW50PSJzcGFjZV9iZXR3ZWVuIiwKICAgICAgICAgICAgICAgIGNvbnRpbnVvdXNfdXBkYXRlPVRydWUsCiAgICAgICAgICAgICAgICBsYXlvdXQ9YXJlYV9sYXlvdXQsCiAgICAgICAgICAgICkKICAgICAgICBlbHNlOgogICAgICAgICAgICBjdXN0b21fc2NvcmluZ19hcmVhID0gd2lkZ2V0cy5UZXh0YXJlYSgKICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPWNvbmZpZ19wbGFjZWhvbGRlciwKICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJFbnRlcjoiLAogICAgICAgICAgICAgICAgZGlzYWJsZWQ9RmFsc2UsCiAgICAgICAgICAgICAgICBqdXN0aWZ5X2NvbnRlbnQ9InNwYWNlX2JldHdlZW4iLAogICAgICAgICAgICAgICAgY29udGludW91c191cGRhdGU9VHJ1ZSwKICAgICAgICAgICAgICAgIGxheW91dD1hcmVhX2xheW91dCwKICAgICAgICAgICAgKQogICAgICAgIGRpc3BsYXkoY3VzdG9tX3Njb3JpbmdfYXJlYSkKICAgICAgICBvdXRwdXRfY3NmLmNsZWFyX291dHB1dCgpCgogICAgc2VsZWN0X29wdGlvbiA9IHdpZGdldHMuUmFkaW9CdXR0b25zKAogICAgICAgIG9wdGlvbnM9WyJjdXN0b21fc2NvcmluZyIsICJtYW51YWxfY29uZmlnIl0sCiAgICAgICAgdmFsdWU9ImN1c3RvbV9zY29yaW5nIiwKICAgICAgICBkZXNjcmlwdGlvbj0iV2hhdDoiLAogICAgICAgIGRpc2FibGVkPUZhbHNlLAogICAgKQogICAgdWkgPSB3aWRnZXRzLkhCb3goW3NlbGVjdF9vcHRpb25dKQogICAgb3B0aW9ucyA9IHdpZGdldHMuaW50ZXJhY3RpdmVfb3V0cHV0KGV2YWx1YXRlLCB7InNlbGVjdGVkIjogc2VsZWN0X29wdGlvbn0pCiAgICBpbnN0cnVjdGlvbiA9IGlweXdpZGdldHMud2lkZ2V0cy5IVE1MKAogICAgICAgICI8Zm9udCBzaXplID0gND48Yj48Zm9udCBmYW1pbHk6IFRpbWVzIE5ldyBSb21hbj5Db3B5IGFuZCBQYXN0ZSB0aGUgc2NvcmluZyIKICAgICAgICAiIGZ1bmN0aW9uIGJlbG93IGFuZCBlbnRlcjwvYj48L2ZvbnQtZmFtaWx5PjwvZm9udCBzaXplPiIKICAgICkKICAgIGRpc3BsYXkoaW5zdHJ1Y3Rpb24pCiAgICAjIGJ1dHRvbnMgd2lkZ2V0cwogICAgZmlsZV9uYW1lID0gd2lkZ2V0cy5UZXh0KGRlc2NyaXB0aW9uPSJGaWxlbmFtZToiLCBwbGFjZWhvbGRlcj0iZmlsZSBuYW1lICIpCiAgICBzYXZlX2J1dHRvbiA9IHdpZGdldHMuQnV0dG9uKGRlc2NyaXB0aW9uPSJTYXZlIikKICAgIHNhdmVfYnV0dG9uLnN0eWxlLmJ1dHRvbl9jb2xvciA9ICJsaWdodGdyZWVuIgogICAgY29uZmlybV9idXR0b24gPSB3aWRnZXRzLkJ1dHRvbihkZXNjcmlwdGlvbj0iQ29uZmlybSIpCiAgICBjb25maXJtX2J1dHRvbi5zdHlsZS5idXR0b25fY29sb3IgPSAic2FsbW9uIgogICAgIyBjbGVhcl9idXR0b24gPSB3aWRnZXRzLkJ1dHRvbihkZXNjcmlwdGlvbj0iQ2xlYXIiKQogICAgIyBjbGVhcl9idXR0b24uc3R5bGUuYnV0dG9uX2NvbG9yID0gImxpZ2h0Z3JlZW4iCiAgICBkaXNwbGF5KCh3aWRnZXRzLlZCb3goW2ZpbGVfbmFtZSwgdWksIG9wdGlvbnNdKSksIG91dHB1dF9jc2YpCiAgICBkaXNwbGF5KCh3aWRnZXRzLkhCb3goW3NhdmVfYnV0dG9uLCBjb25maXJtX2J1dHRvbl0pKSkKICAgIHNhdmVfYnV0dG9uLm9uX2NsaWNrKHNhdmVfc2NvcmluZykKICAgIGNvbmZpcm1fYnV0dG9uLm9uX2NsaWNrKGNvbmZpcm1fc2NvcmluZykKICAgICMgY2xlYXJfYnV0dG9uLm9uX2NsaWNrKGFsbF9jbGVhcikKCgpkZWYgeGdfbW9kZWwoWCwgeSk6CiAgICBmcm9tIHNrbGVhcm4uZGF0YXNldHMgaW1wb3J0IG1ha2VfY2xhc3NpZmljYXRpb24KCiAgICBudW1fY2xhc3NlcyA9IDMKICAgIFgsIHkgPSBtYWtlX2NsYXNzaWZpY2F0aW9uKG5fc2FtcGxlcz0xMDAwLCBuX2luZm9ybWF0aXZlPTUsIG5fY2xhc3Nlcz1udW1fY2xhc3NlcykKICAgIGR0cmFpbiA9IHhnYi5ETWF0cml4KGRhdGE9WCwgbGFiZWw9eSkKICAgIG51bV9wYXJhbGxlbF90cmVlID0gNAogICAgbnVtX2Jvb3N0X3JvdW5kID0gMTYKICAgICMgdG90YWwgbnVtYmVyIG9mIGJ1aWx0IHRyZWVzIGlzIG51bV9wYXJhbGxlbF90cmVlICogbnVtX2NsYXNzZXMgKiBudW1fYm9vc3Rfcm91bmQKCiAgICAjIFdlIGJ1aWxkIGEgYm9vc3RlZCByYW5kb20gZm9yZXN0IGZvciBjbGFzc2lmaWNhdGlvbiBoZXJlLgogICAgYm9vc3RlciA9IHhnYi50cmFpbigKICAgICAgICB7Im51bV9wYXJhbGxlbF90cmVlIjogNCwgInN1YnNhbXBsZSI6IDAuNSwgIm51bV9jbGFzcyI6IDN9LAogICAgICAgIG51bV9ib29zdF9yb3VuZD1udW1fYm9vc3Rfcm91bmQsCiAgICAgICAgZHRyYWluPWR0cmFpbiwKICAgICkKCiAgICAjIFRoaXMgaXMgdGhlIHNsaWNlZCBtb2RlbCwgY29udGFpbmluZyBbMywgNykgZm9yZXN0cwogICAgIyBzdGVwIGlzIGFsc28gc3VwcG9ydGVkIHdpdGggc29tZSBsaW1pdGF0aW9ucyBsaWtlIG5lZ2F0aXZlIHN0ZXAgaXMgaW52YWxpZC4KICAgIHNsaWNlZDogeGdiLkJvb3N0ZXIgPSBib29zdGVyWzM6N10KCiAgICByZXR1cm4gW18gZm9yIF8gaW4gYm9vc3Rlcl0KCgpkZWYgeGdiX2Jvb3N0KGZpbGVfdHJhaW4sIGZpbGVfdGVzdCk6CiAgICBpbXBvcnQgeGdib29zdCBhcyB4Z2IKCiAgICBDVVJSRU5UX0RJUiA9IG9zLnBhdGguZGlybmFtZShfX2ZpbGVfXykKICAgIGR0cmFpbiA9IHhnYi5ETWF0cml4KG9zLnBhdGguam9pbihDVVJSRU5UX0RJUiwgImZpbGVfdHJhaW4iKSkKICAgIGR0ZXN0ID0geGdiLkRNYXRyaXgob3MucGF0aC5qb2luKENVUlJFTlRfRElSLCAiZmlsZV90ZXN0IikpCiAgICBwYXJhbSA9IHsKICAgICAgICAib2JqZWN0aXZlIjogImJpbmFyeTpsb2dpc3RpYyIsCiAgICAgICAgImJvb3N0ZXIiOiAiZ2JsaW5lYXIiLAogICAgICAgICJhbHBoYSI6IDAuMDAwMSwKICAgICAgICAibGFtYmRhIjogMSwKICAgIH0KICAgIHdhdGNobGlzdCA9IFsoZHRlc3QsICJldmFsIiksIChkdHJhaW4sICJ0cmFpbiIpXQogICAgbnVtX3JvdW5kID0gNAogICAgYnN0ID0geGdiLnRyYWluKHBhcmFtLCBkdHJhaW4sIG51bV9yb3VuZCwgd2F0Y2hsaXN0KQogICAgcHJlZHMgPSBic3QucHJlZGljdChkdGVzdCkKICAgIGxhYmVscyA9IGR0ZXN0LmdldF9sYWJlbCgpCiAgICBwcmludCgKICAgICAgICAiZXJyb3I9JWYiCiAgICAgICAgJSAoCiAgICAgICAgICAgIHN1bShpbnQocHJlZHNbaV0gPiAwLjUpICE9IGxhYmVsc1tpXSBmb3IgaSBpbiByYW5nZShsZW4ocHJlZHMpKSkKICAgICAgICAgICAgLyBmbG9hdChsZW4ocHJlZHMpKQogICAgICAgICkKICAgICkKCgpkZWYgcnVuX3NtaW5hKGRpcl9uYW1lXywgY29uZmlnX2ZpbGVfbmFtZSwgKiprd2FyZ3MpOgogICAgIiIiIENyZWF0ZXMgZm9sZGVyIHdpdGhpbiB0aGUgY3dkIHdpdGggdGhlIG5hbWUgaWQgYW5kIHN1YlwKICAgIGZvbGRlciBydW4gd2hlcmUgaXQgd2lsbCB3cml0ZSBzaC5BbHNvIGNyZWF0ZXMgYSBkdW1wIGZvbGRlclwKICAgIHdoZXJlIGVycm9yIGFuZCBvdXRwdXQgbG9nIHdpbGwgYmUgZHVtcGVkLgoKICAgICIiIgogICAgbW9kZSA9IGt3YXJncy5nZXQoIm1vZGUiLCBGYWxzZSkKICAgIGxvZyA9IGt3YXJncy5nZXQoImxvZyIsICJsb2cudHh0IikKICAgIG91dHB1dCA9IGt3YXJncy5nZXQoIm91dHB1dCIsICJvdXRwdXQuc2RmIikKICAgIGxvY2FsID0ga3dhcmdzLmdldCgibG9jYWwiLCBGYWxzZSkKICAgIGNwdV9udW0gPSBrd2FyZ3MuZ2V0KCJjcHUiLCAyKQogICAgam9iX25hbWUgPSBrd2FyZ3MuZ2V0KCJqb2JfbmFtZSIsIE5vbmUpCiAgICBzY29yaW5nID0ga3dhcmdzLmdldCgic2NvcmluZyIpCiAgICBjdXN0b20gPSBrd2FyZ3MuZ2V0KCJjdXN0b20iLCBGYWxzZSkKICAgIGVudGVyX291dHB1dCA9IGt3YXJncy5nZXQoImVudGVyX291dHB1dCIsIFRydWUpCiAgICBlbnRlcl9sb2cgPSBrd2FyZ3MuZ2V0KCJlbnRlcl9sb2ciLCBUcnVlKQogICAgY2x1c3RlciA9IGt3YXJncy5nZXQoImNsdXN0ZXIiLCBOb25lKQogICAgY2x1c3Rlcl9ncnAgPSBbImFsbC5xIiwgImdwMSIsICJncDIiXQogICAgaWYgKGNsdXN0ZXIgaXMgbm90IE5vbmUpIGFuZCAoY2x1c3RlciBub3QgaW4gY2x1c3Rlcl9ncnApOgogICAgICAgIHJldHVybiBmIkludmFsaWQgY2x1c3RlciBuYW1lLiBBdmFpbGFibGUgY2x1c3RlciBuYW1lczoge2NsdXN0ZXJfZ3JwfSIKICAgIG5hbWVfaWQgPSBjb25maWdfZmlsZV9uYW1lWzo0XS5sb3dlcigpICAjIEZJWAogICAgZGlyX25hbWVfY3dkID0gb3MuZ2V0Y3dkKCkKICAgIGRpcl9uYW1lID0gb3MucGF0aC5kaXJuYW1lKGRpcl9uYW1lXykKICAgIFBBVEggPSBrd2FyZ3MuZ2V0KCJQQVRIIiwgRmFsc2UpCiAgICBkaXJfbmFtZSA9IGYie2Rpcl9uYW1lfSIgaWYgUEFUSCBlbHNlIGYie2Rpcl9uYW1lX2N3ZH0iCgogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGYie2Rpcl9uYW1lfS9HZW5lcmF0ZWQvam9icy97bmFtZV9pZH0vcnVuIik6CiAgICAgICAgb3MubWFrZWRpcnMoZiJ7ZGlyX25hbWV9L0dlbmVyYXRlZC9qb2JzL3tuYW1lX2lkfS9ydW4iKQogICAgaWYgbG9jYWwgaXMgRmFsc2U6CiAgICAgICAgU01JTkFfUEFUSCA9ICIvc2hhcmUvdmluYS9zbWluYSIKICAgICAgICB3aXRoIG9wZW4oCiAgICAgICAgICAgIGYie2Rpcl9uYW1lfS9HZW5lcmF0ZWQvam9icy97bmFtZV9pZH0vcnVuL3tuYW1lX2lkfV9TTWluYS5zaCIsICJ3IgogICAgICAgICkgYXMgb3V0OgogICAgICAgICAgICBpZiBqb2JfbmFtZSBpcyBOb25lOgogICAgICAgICAgICAgICAgam9iX25hbWUgPSBuYW1lX2lkCiAgICAgICAgICAgIGlmIGpvYl9uYW1lWzBdLmlzZGlnaXQoKToKICAgICAgICAgICAgICAgIGpvYl9uYW1lID0gIlMiICsgam9iX25hbWUKICAgICAgICAgICAgcHJpbnQoZiIjJCAtTiB7am9iX25hbWV9IiwgZmlsZT1vdXQpCiAgICAgICAgICAgIHByaW50KCIjJCAtViIsIGZpbGU9b3V0KQogICAgICAgICAgICBwcmludCgiIyQgLVMgL2Jpbi9iYXNoIiwgZmlsZT1vdXQpCiAgICAgICAgICAgIGlmIGNsdXN0ZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwcmludChmIiMkIC1xIHtjbHVzdGVyfSIsIGZpbGU9b3V0KQogICAgICAgICAgICBwcmludChmIiMkIC1wZSB7Y3B1X251bX1jcHUge2NwdV9udW19IiwgZmlsZT1vdXQpCiAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmIntkaXJfbmFtZX0vR2VuZXJhdGVkL2pvYnMve25hbWVfaWR9L2R1bXAvIik6CiAgICAgICAgICAgICAgICBvcy5tYWtlZGlycyhmIntkaXJfbmFtZX0vR2VuZXJhdGVkL2pvYnMve25hbWVfaWR9L2R1bXAvIikKICAgICAgICAgICAgcHJpbnQoZiIjJCAtbyB7ZGlyX25hbWV9L0dlbmVyYXRlZC9qb2JzL3tuYW1lX2lkfS9kdW1wLyIsIGZpbGU9b3V0KQogICAgICAgICAgICBwcmludChmIiMkIC1lICB7ZGlyX25hbWV9L0dlbmVyYXRlZC9qb2JzL3tuYW1lX2lkfS9kdW1wLyIsIGZpbGU9b3V0KQogICAgICAgICAgICBwcmludCgiIyQgLWN3ZCIsIGZpbGU9b3V0KQoKICAgICAgICAgICAgIyBDb25kaXRpb25hbCB0byB3cml0ZSBsb2cgYW5kIG91dHB1dAogICAgICAgICAgICBlbnRlcl9sb2cgPSBmIi0tbG9nIHtsb2d9IiBpZiBlbnRlcl9sb2cgZWxzZSAiIgogICAgICAgICAgICBlbnRlcl9vdXRwdXQgPSBmIi0tb3V0IHtvdXRwdXR9IiBpZiBlbnRlcl9vdXRwdXQgZWxzZSAiIgogICAgICAgICAgICBpZiAobW9kZSBpcyBUcnVlKSBhbmQgKGN1c3RvbSBpcyBGYWxzZSk6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIntTTUlOQV9QQVRIfSAtLWNvbmZpZyIKICAgICAgICAgICAgICAgICAgICBmIiB7ZGlyX25hbWV9L0dlbmVyYXRlZC9zbWluYV9pbnB1dC97Y29uZmlnX2ZpbGVfbmFtZX0iCiAgICAgICAgICAgICAgICAgICAgZiIgLS1zY29yaW5nIHtzY29yaW5nfSAtLXNjb3JlX29ubHkge2VudGVyX2xvZ30ge2VudGVyX291dHB1dH0iLAogICAgICAgICAgICAgICAgICAgIGZpbGU9b3V0LAogICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgZWxpZiAobW9kZSBpcyBUcnVlKSBhbmQgKGN1c3RvbSBpcyBUcnVlKToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie1NNSU5BX1BBVEh9IC0tY29uZmlnIgogICAgICAgICAgICAgICAgICAgIGYiIHtkaXJfbmFtZX0vR2VuZXJhdGVkL3NtaW5hX2lucHV0L3tjb25maWdfZmlsZV9uYW1lfSIKICAgICAgICAgICAgICAgICAgICBmIiAtLWN1c3RvbV9zY29yaW5nIHtzY29yaW5nfSAtLXNjb3JlX29ubHkgIHtlbnRlcl9vdXRwdXR9IgogICAgICAgICAgICAgICAgICAgIGYiIHtlbnRlcl9sb2d9IiwKICAgICAgICAgICAgICAgICAgICBmaWxlPW91dCwKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgIGVsaWYgKG1vZGUgaXMgRmFsc2UpIGFuZCAoY3VzdG9tIGlzIEZhbHNlKToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie1NNSU5BX1BBVEh9IC0tY29uZmlnIgogICAgICAgICAgICAgICAgICAgIGYiIHtkaXJfbmFtZX0vR2VuZXJhdGVkL3NtaW5hX2lucHV0L3tjb25maWdfZmlsZV9uYW1lfSAtLXNjb3JpbmciCiAgICAgICAgICAgICAgICAgICAgZiIge3Njb3Jpbmd9ICB7ZW50ZXJfbG9nfSB7ZW50ZXJfb3V0cHV0fSAiLAogICAgICAgICAgICAgICAgICAgIGZpbGU9b3V0LAogICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgZWxpZiAobW9kZSBpcyBGYWxzZSkgYW5kIChjdXN0b20gaXMgVHJ1ZSk6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIntTTUlOQV9QQVRIfSAtLWNvbmZpZyIKICAgICAgICAgICAgICAgICAgICBmIiB7ZGlyX25hbWV9L0dlbmVyYXRlZC9zbWluYV9pbnB1dC97Y29uZmlnX2ZpbGVfbmFtZX0iCiAgICAgICAgICAgICAgICAgICAgZiIgLS1jdXN0b21fc2NvcmluZyB7c2NvcmluZ30gIHtlbnRlcl9sb2d9IHtlbnRlcl9vdXRwdXR9ICIsCiAgICAgICAgICAgICAgICAgICAgZmlsZT1vdXQsCiAgICAgICAgICAgICAgICApCgogICAgICAgIGNvbW1hbmQgPSBmInFzdWIge2Rpcl9uYW1lfS9HZW5lcmF0ZWQvam9icy97bmFtZV9pZH0vcnVuL3tuYW1lX2lkfV9TTWluYS5zaCIKICAgIGVsc2U6CiAgICAgICAgaWYgY3VzdG9tIGlzIEZhbHNlOgogICAgICAgICAgICBjb21tYW5kID0gKAogICAgICAgICAgICAgICAgZiJzbWluYSAtLWNvbmZpZyB7ZGlyX25hbWV9L0dlbmVyYXRlZC9zbWluYV9pbnB1dC97Y29uZmlnX2ZpbGVfbmFtZX0iCiAgICAgICAgICAgICAgICBmIiAtLXNjb3Jpbmcge3Njb3Jpbmd9IHtlbnRlcl9sb2d9IHtlbnRlcl9vdXRwdXR9IgogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY29tbWFuZCA9ICgKICAgICAgICAgICAgICAgIGYic21pbmEgLS1jb25maWcge2Rpcl9uYW1lfS9HZW5lcmF0ZWQvc21pbmFfaW5wdXQve2NvbmZpZ19maWxlX25hbWV9IgogICAgICAgICAgICAgICAgZiIgLS1jdXN0b21fc2NvcmluZyB7c2NvcmluZ30gIHtlbnRlcl9sb2d9IHtlbnRlcl9vdXRwdXR9IgogICAgICAgICAgICApCgogICAgc3VicHJvY2Vzcy5ydW4oY29tbWFuZCwgY3dkPWYie2Rpcl9uYW1lfS9HZW5lcmF0ZWQvam9icy97bmFtZV9pZH0iLCBzaGVsbD1UcnVlKQoKICAgIHJldHVybiAiU3VjY2VzZnVsbHkgY29tcGxldGVkLiIKCgojIFJFQ09SRFMgT0YgQUxMIFNDT1JJTkcgRlVOQ1RJT04KIyBTRiA9IFsgICJhZDRfc2NvcmluZyIsCiMgICAgICAgICJkZWZhdWx0IiwKIyAgICAgICAgImRrb2VzX2Zhc3QiLAojICAgICAgICAiZGtvZXNfc2NvcmluZyIsCiMgICAgICAgICJka29lc19zY29yaW5nX29sZCIsCiMgICAgICAgICJ2aW5hIiwKIyAgICAgICAgInZpbmFyZG8iLAojICAgIF0KCiMgQ1NGID0gWyJjdXN0b20iXSAjIGZvciBjdXN0b20gc2NvcmluZyAgYW5kIHBhc3MgY3VzdG9tX3Njb3JpbmdfZmlsZT1QQVRIIHRvIHRoZSBmdW5jdGlvbgojIE90aGVyd2lzZSBhbGwgdGhlIG90aGVyIFNGIHdpbGwgYmUgcnVuIGJ1dCB3aWxsIGJlIGNhbGN1bGF0ZSB3aXRoIGNzZgojICBmb3IgbnVtZXJvdXMgdGltZQoKCmRlZiBzbWluYV9ydW4ocHJvdGVpbl9saXN0LCBsaWdhbmRfbGlzdCwgKiprd2FyZ3MpOgoKICAgICIiIlByZXBhcmVzIGNvbmZpZyBmaWxlIGZvciBzbWluYSB3aGVuIGVudGVyIHByb3RlcmluIGFuZCBsaWdhbmQKICAgIEFib3ZlIHNoX3J1biBmdW5jdGlvbiBtdXN0IGJlIGluaXRpYWxlemVkIGJlZm9yZSBpbiBub3RlYm9vayIiIgoKICAgIFNGID0ga3dhcmdzLmdldCgiU0YiKQogICAgaWYgbm90IGlzaW5zdGFuY2UoU0YsIGxpc3QpOgogICAgICAgIHJldHVybiAiU3VwcGxpZWQgU0YgaXMgbm90IGEgbGlzdCIKICAgIGNsdXN0ZXIgPSBrd2FyZ3MuZ2V0KCJjbHVzdGVyIiwgTm9uZSkKICAgIGNsdXN0ZXJfZ3JwID0gWyJhbGwucSIsICJncDEiLCAiZ3AyIl0KICAgIGlmIChjbHVzdGVyIGlzIG5vdCBOb25lKSBhbmQgKGNsdXN0ZXIgbm90IGluIGNsdXN0ZXJfZ3JwKToKICAgICAgICByZXR1cm4gZiJJbnZhbGlkIGNsdXN0ZXIgbmFtZS4gQXZhaWxhYmxlIGNsdXN0ZXIgbmFtZXM6IHtjbHVzdGVyX2dycH0iCiAgICBhdXRvYm94ID0ga3dhcmdzLmdldCgiYXV0b2JveCIsIE5vbmUpCiAgICBpZiBpc2luc3RhbmNlKGF1dG9ib3gsIGxpc3QpOgogICAgICAgIGF1dG9ib3ggPSBhdXRvYm94WzBdCiAgICBtYW51YWxfY29uZmlnID0ga3dhcmdzLmdldCgibWFudWFsX2NvbmZpZyIsIE5vbmUpCiAgICBpZiBpc2luc3RhbmNlKG1hbnVhbF9jb25maWcsIGxpc3QpOgogICAgICAgIG1hbnVhbF9jb25maWcgPSBtYW51YWxfY29uZmlnWzBdCiAgICBydW4gPSBrd2FyZ3MuZ2V0KCJydW4iLCBGYWxzZSkKICAgIG1vZGUgPSBrd2FyZ3MuZ2V0KCJtb2RlIiwgRmFsc2UpCiAgICBsb2NhbCA9IGt3YXJncy5nZXQoImxvY2FsIiwgRmFsc2UpCiAgICBqb2JfbmFtZSA9IGt3YXJncy5nZXQoImpvYl9uYW1lIiwgTm9uZSkKICAgIE5VTV9NT0RFUyA9IGt3YXJncy5nZXQoIm51bV9tb2RlcyIsIDEwKQogICAgRVhIQVVTVElWRSA9IGt3YXJncy5nZXQoImV4aGF1c3RpdmUiLCA1MCkKICAgIEVORVJHWV9SQU5HRSA9IGt3YXJncy5nZXQoImVuZXJneV9yYW5nZSIsIDEwKQogICAgU0VFRCA9IGt3YXJncy5nZXQoInNlZWQiLCBOb25lKQogICAgQVVUT0JPWF9QQUQgPSBrd2FyZ3MuZ2V0KCJwYWQiLCA0KQogICAgQ1BVX05VTSA9IGt3YXJncy5nZXQoImNwdSIsIDgpCiAgICBub21hdGNoID0ga3dhcmdzLmdldCgibWF0Y2giLCBGYWxzZSkKICAgIE9VVF9GT1JNQVQgPSBrd2FyZ3MuZ2V0KCJvdXRfZm9ybWF0IiwgInNkZiIpCiAgICBjdXN0b20gPSBrd2FyZ3MuZ2V0KCJjdXN0b20iLCBGYWxzZSkKCiAgICAjIGlmIENVU1RPTV9TQ09SRSBpcyBub3QgTm9uZToKICAgICMgICAgQ1NGX0ZMQUcgPSBUcnVlCiAgICAjIGVsc2U6CiAgICAjICAgIENTRl9GTEFHID0gRmFsc2UKCiAgICBkZWYgd3JpdGVfY29uZmlnKAogICAgICAgIHJlY2VwdG9yLAogICAgICAgIGxpZ2FuZCwKICAgICAgICBjb25maWdfZmlsZV9uYW1lLAogICAgICAgIG91dHB1dF9maWxlX25hbWUsCiAgICAgICAgbG9nX2ZpbGVfbmFtZSwKICAgICAgICAjIHNjb3Jpbmc9Tm9uZSwgIyBNb3ZlZCB0byBDTEkKICAgICk6CiAgICAgICAgIiIiV3JpdGVzIGNvbmZpZyBpbnRvIG5ldyBmaWxlcywgaWYgYWxyZWFkeSBcCiAgICAgICAgZXhpc3QgYXBwZW5kIHRvIGl0LiIiIgoKICAgICAgICAjIGRpcl9uYW1lID0gb3MucGF0aC5kaXJuYW1lKHJlY2VwdG9yKQogICAgICAgIGRpcl9uYW1lID0gb3MuZ2V0Y3dkKCkKCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGYie2Rpcl9uYW1lfS9HZW5lcmF0ZWQvc21pbmFfaW5wdXQiKToKICAgICAgICAgICAgb3MubWFrZWRpcnMoZiJ7ZGlyX25hbWV9L0dlbmVyYXRlZC9zbWluYV9pbnB1dC8iKQogICAgICAgIHdpdGggb3BlbigKICAgICAgICAgICAgZiJ7ZGlyX25hbWV9L0dlbmVyYXRlZC9zbWluYV9pbnB1dC97Y29uZmlnX2ZpbGVfbmFtZX0iLCAidysiCiAgICAgICAgKSBhcyBjb25maWdfZmlsZToKCiAgICAgICAgICAgICMgcmVxdWlyZWQgY29uZmlnIGFyZ3VtZW50cwogICAgICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICBwcmludChmInJlY2VwdG9yID0ge3JlY2VwdG9yfSAiLCBmaWxlPWNvbmZpZ19maWxlKQogICAgICAgICAgICBwcmludChmImxpZ2FuZCA9IHtsaWdhbmR9IiwgZmlsZT1jb25maWdfZmlsZSkKICAgICAgICAgICAgaWYgYXV0b2JveCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHByaW50KGYiYXV0b2JveF9saWdhbmQgPSB7YXV0b2JveH0iLCBmaWxlPWNvbmZpZ19maWxlKQogICAgICAgICAgICAgICAgcHJpbnQoZiJhdXRvYm94X2FkZCA9IHtBVVRPQk9YX1BBRH0iLCBmaWxlPWNvbmZpZ19maWxlKQoKICAgICAgICAgICAgIyBPcHRpb25hbHMgY29uICAjIE1PVkVEIFRPIENMSQogICAgICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICBwcmludChmIm91dCA9IHtvdXRwdXRfZmlsZV9uYW1lfSIsIGZpbGU9Y29uZmlnX2ZpbGUpCiAgICAgICAgICAgIHByaW50KGYibG9nID0ge2xvZ19maWxlX25hbWV9IiwgZmlsZT1jb25maWdfZmlsZSkKICAgICAgICAgICAgIyBwcmludChmInNjb3JpbmcgPSB7c2NvcmluZ30iLCBmaWxlPWNvbmZpZ19maWxlKSAgIyMgY2hhbmdlIHRvIHJ1biBpbiBDTEkKCiAgICAgICAgICAgICMgTWlzYyhvcHRpb25hbCkgY29uZmlncwogICAgICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgICMgaWYgQ1VTVE9NX1NDT1JFIGlzIG5vdCBOb25lOiAgIyMgTU9WRUQgVE8gQ0xJCiAgICAgICAgICAgICMgICAgcHJpbnQoZiJjdXN0b21fc2NvcmluZyA9IHtDVVNUT01fU0NPUkV9IiwgZmlsZT1jb25maWdfZmlsZSkKICAgICAgICAgICAgIyBpZiBTTUlOQV9NT0RFIGlzIG5vdCBOb25lOgogICAgICAgICAgICAjICAgIHByaW50KGYie1NNSU5BX01PREV9IiwgZmlsZT1jb25maWdfZmlsZSkKCiAgICAgICAgICAgIHByaW50KGYiY3B1ID0ge0NQVV9OVU19IiwgZmlsZT1jb25maWdfZmlsZSkKICAgICAgICAgICAgaWYgU0VFRCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHByaW50KGYiXG5cbnNlZWQgPSB7U0VFRH0iLCBmaWxlPWNvbmZpZ19maWxlKQogICAgICAgICAgICBwcmludChmImV4aGF1c3RpdmVuZXNzID0ge0VYSEFVU1RJVkV9IiwgZmlsZT1jb25maWdfZmlsZSkKICAgICAgICAgICAgIyBpZiBDVVNUT01fU0NPUkUgaXMgTm9uZTogIyMgY2hhbmdlIHRvIHJ1biBpbiBDTEkKICAgICAgICAgICAgcHJpbnQoZiJudW1fbW9kZXMgPSB7TlVNX01PREVTfSIsIGZpbGU9Y29uZmlnX2ZpbGUpCiAgICAgICAgICAgIHByaW50KGYiZW5lcmd5X3JhbmdlID0ge0VORVJHWV9SQU5HRSB9IiwgZmlsZT1jb25maWdfZmlsZSkKCiAgICBmb3Igc2NvcmluZyBpbiBTRjoKICAgICAgICBmb3IgbGlnYW5kIGluIGxpZ2FuZF9saXN0OgogICAgICAgICAgICBwcm90ZWluX2RpciwgcHJvdGVpbl9pZCwgcHJvdF9mb3JtYXQgPSBnaXZlX2lkKHByb3RlaW5fbGlzdFswXSkKICAgICAgICAgICAgbGlnYW5kX2RpciwgbGlnYW5kX2lkLCBsaWdfZm9ybWF0ID0gZ2l2ZV9pZChsaWdhbmQpCiAgICAgICAgICAgIGlmIGN1c3RvbToKICAgICAgICAgICAgICAgIF9kaXIsIF9uYW1lLCBfZm9ybWF0ID0gZ2l2ZV9pZChzY29yaW5nKQogICAgICAgICAgICAgICAgc2NvcmluZyA9IF9uYW1lCiAgICAgICAgICAgIGlmIHByb3RlaW5faWRbOjRdLmxvd2VyKCkgPT0gbGlnYW5kX2lkWzo0XS5sb3dlcigpIG9yIChub21hdGNoID09IFRydWUpOgogICAgICAgICAgICAgICAgb3V0cHV0X2ZpbGVfbmFtZSA9IGxpZ2FuZF9pZCArIGYiX291dHB1dF97c2NvcmluZ30ue09VVF9GT1JNQVR9IgogICAgICAgICAgICAgICAgbG9nX2ZpbGVfbmFtZSA9IGxpZ2FuZF9pZCArIGYiX2xvZ197c2NvcmluZ30udHh0IgogICAgICAgICAgICAgICAgaWYgbWFudWFsX2NvbmZpZyBpcyBOb25lOgoKICAgICAgICAgICAgICAgICAgICBjb25maWdfZmlsZV9uYW1lID0gbGlnYW5kX2lkLmxvd2VyKCkgKyBmIl9jb25maWdfe3Njb3Jpbmd9LnR4dCIKICAgICAgICAgICAgICAgICAgICBlbnRlcl9vdXRwdXQgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgZW50ZXJfbG9nID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgIHdyaXRlX2NvbmZpZygKICAgICAgICAgICAgICAgICAgICAgICAgcHJvdGVpbl9saXN0WzBdLAogICAgICAgICAgICAgICAgICAgICAgICBsaWdhbmQsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ19maWxlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dF9maWxlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ19maWxlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZWxzZToKCiAgICAgICAgICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgICAgICAgICBtYW51YWxfY29uZmlnX2RpciwKICAgICAgICAgICAgICAgICAgICAgICAgbWFudWFsX2NvbmZpZ19uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBtYW51YWxfY29uZmlnX2Zvcm1hdCwKICAgICAgICAgICAgICAgICAgICApID0gZ2l2ZV9pZChtYW51YWxfY29uZmlnKQogICAgICAgICAgICAgICAgICAgIGNvbmZpZ19maWxlX25hbWUgPSBmInttYW51YWxfY29uZmlnX25hbWV9LnttYW51YWxfY29uZmlnX2Zvcm1hdH0iCiAgICAgICAgICAgICAgICAgICAgaWYgIm91dHB1dCIgaW4gb3BlbihtYW51YWxfY29uZmlnKS5yZWFkKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGVudGVyX291dHB1dCA9IEZhbHNlCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgZW50ZXJfb3V0cHV0ID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgIGlmICJsb2ciIGluIG9wZW4obWFudWFsX2NvbmZpZykucmVhZCgpOgogICAgICAgICAgICAgICAgICAgICAgICBlbnRlcl9sb2cgPSBGYWxzZQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGVudGVyX2xvZyA9IFRydWUKCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludCgiUHJvdGVpbiBhbmQgbGlnYW5kIHByZWZpeCBbNCBsZXR0ZXJdIGRpZG50IG1hdGNoIikKICAgICAgICAgICAgaWYgY3VzdG9tOgogICAgICAgICAgICAgICAgc2NvcmluZyA9IGYie19kaXJ9L3tfbmFtZX0ue19mb3JtYXR9IgogICAgICAgICAgICBpZiBydW4gaXMgVHJ1ZSBhbmQgbW9kZSBpcyBUcnVlOgogICAgICAgICAgICAgICAgcnVuX3NtaW5hKAogICAgICAgICAgICAgICAgICAgIHByb3RlaW5fZGlyLAogICAgICAgICAgICAgICAgICAgIGNvbmZpZ19maWxlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgc2NvcmluZz1zY29yaW5nLAogICAgICAgICAgICAgICAgICAgIG1vZGU9bW9kZSwKICAgICAgICAgICAgICAgICAgICBsb2NhbD1sb2NhbCwKICAgICAgICAgICAgICAgICAgICAjIGNwdT1DUFVfTlVNLAogICAgICAgICAgICAgICAgICAgICMgam9iX25hbWU9am9iX25hbWUsCiAgICAgICAgICAgICAgICAgICAgY3VzdG9tPWN1c3RvbSwKICAgICAgICAgICAgICAgICAgICBsb2c9bG9nX2ZpbGVfbmFtZSwKICAgICAgICAgICAgICAgICAgICBvdXRwdXQ9b3V0cHV0X2ZpbGVfbmFtZSwKICAgICAgICAgICAgICAgICAgICBlbnRlcl9vdXRwdXQ9ZW50ZXJfb3V0cHV0LAogICAgICAgICAgICAgICAgICAgIGVudGVyX2xvZz1lbnRlcl9sb2csCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVsaWYgcnVuIGlzIFRydWUgYW5kIG1vZGUgaXMgRmFsc2U6CiAgICAgICAgICAgICAgICBydW5fc21pbmEoCiAgICAgICAgICAgICAgICAgICAgcHJvdGVpbl9kaXIsCiAgICAgICAgICAgICAgICAgICAgY29uZmlnX2ZpbGVfbmFtZSwKICAgICAgICAgICAgICAgICAgICBzY29yaW5nPXNjb3JpbmcsCiAgICAgICAgICAgICAgICAgICAgbG9jYWw9bG9jYWwsCiAgICAgICAgICAgICAgICAgICAgY3B1PUNQVV9OVU0sCiAgICAgICAgICAgICAgICAgICAgam9iX25hbWU9am9iX25hbWUsCiAgICAgICAgICAgICAgICAgICAgY3VzdG9tPWN1c3RvbSwKICAgICAgICAgICAgICAgICAgICBvdXRwdXQ9b3V0cHV0X2ZpbGVfbmFtZSwKICAgICAgICAgICAgICAgICAgICBsb2c9bG9nX2ZpbGVfbmFtZSwKICAgICAgICAgICAgICAgICAgICBlbnRlcl9vdXRwdXQ9ZW50ZXJfb3V0cHV0LAogICAgICAgICAgICAgICAgICAgIGVudGVyX2xvZz1lbnRlcl9sb2csCiAgICAgICAgICAgICAgICAgICAgUEFUSD1UcnVlLAogICAgICAgICAgICAgICAgICAgIGNsdXN0ZXI9Y2x1c3RlciwKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICJSdW4gY29tbWFuZCB3YXMgbm90IHBhc3NlZCBzbyBvbmx5IGNyZWF0ZWQgdGhlIgogICAgICAgICAgICAgICAgICAgICIgY29uZmlnIGFuZCBzaCBmaWxlIGJ1dCBub3QgZXhlY3V0ZWQiCiAgICAgICAgICAgICAgICApCiAgICAgICAgIyBwcmludChiYXNlX25hbWUpCiAgICByZXR1cm4gIlN1Y2Nlc2Z1bGx5IGNvbXBsZXRlZC4iCgoKZGVmIHZpZXdfYWZmaW5pdHkoc29ydGVkX1JFUywga2V5d29yZCk6CiAgICBkZiA9IHBkLkRhdGFGcmFtZSgKICAgICAgICBbCiAgICAgICAgICAgIChrZXksIHZhbHVlKQogICAgICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBzb3J0ZWRfUkVTLml0ZW1zKCkKICAgICAgICAgICAgaWYgZiJ7a2V5d29yZH0iIGluIGtleS5sb3dlcigpCiAgICAgICAgXSwKICAgICAgICBjb2x1bW5zPVsiUG9zZSIsICJBZmZpbml0eSJdLAogICAgKQogICAgcmV0dXJuIGRmCgoKZGVmIHNtaW5hX291dHB1dF9kZihzb3J0ZWRfUkVTKToKICAgIHJldHVybiBwZC5EYXRhRnJhbWUoCiAgICAgICAgWyhrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiBzb3J0ZWRfUkVTLml0ZW1zKCldLAogICAgICAgIGNvbHVtbnM9WyJQb3NlIiwgIkFmZmluaXR5Il0sCiAgICApCgoKZGVmIHJtc2RfbWF0cml4KAogICAgcmVmLCBsZW5ndGg9Miwga2V5PSJNQVRSSVgiLCB2ZXJib3NlPUZhbHNlLCBwbG90PVRydWUsIHNhdmU9RmFsc2UsIGFubm90PUZhbHNlCik6CiAgICBfcm1zZF9saXN0ID0gaXRlcnRvb2xzLmNvbWJpbmF0aW9ucyhyZWYsIGxlbmd0aCkKICAgIGNvbHMgPSBbIlJlZmVyZW5jZSIsICJQb3NlIiwgIlJNU0QiXQogICAgZGYgPSBwZC5EYXRhRnJhbWUoY29sdW1ucz1jb2xzKQogICAgZm9yIGNvdW50LCBpIGluIGVudW1lcmF0ZShfcm1zZF9saXN0KToKICAgICAgICByZWYsIGNvbmYgPSBsaXN0KFtpWzBdXSksIGxpc3QoW2lbMV1dKQogICAgICAgIHggPSBybXNkX2NhbGN1bGF0b3IocmVmLCBjb25mLCBub21hdGNoPVRydWUsIGtleT1rZXksIHZlcmJvc2U9RmFsc2UpCiAgICAgICAgaWYgdmVyYm9zZToKICAgICAgICAgICAgcHJpbnQoZiJ7Y291bnR9LiB7eH0iLCBzZXA9IiAiLCBmbHVzaD1UcnVlKQogICAgICAgIHgxLCB4MiwgeDMgPSB4LnNwbGl0KCJcdCIpCiAgICAgICAgZGYubG9jW2NvdW50XSA9IFt4MSwgeDIsIHgzXQoKICAgIG1kZiA9IGRmLnBpdm90KGluZGV4PSJSZWZlcmVuY2UiLCBjb2x1bW5zPSJQb3NlIiwgdmFsdWVzPSJSTVNEIikKICAgIG1kZi5maWxsbmEoMCkKICAgIG1kZiA9IG1kZi5hc3R5cGUoZmxvYXQpCiAgICBpZiBwbG90OgogICAgICAgICMgcGx0LmZpZ3VyZShmaWdzaXplPVsxNSwgOF0pCiAgICAgICAgaG1hcCA9IHNucy5oZWF0bWFwKG1kZiwgYW5ub3Q9YW5ub3QpCiAgICAgICAgaG1hcC5zZXRfdGl0bGUoIlJNU0QgTUFUUklYIikKICAgICAgICBpZiBzYXZlOgogICAgICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoIi4vR2VuZXJhdGVkL2ltYWdlcy8iKToKICAgICAgICAgICAgICAgIG9zLm1ha2VkaXJzKCIuL0dlbmVyYXRlZC9pbWFnZXMvIikKICAgICAgICAgICAgZmlnID0gaG1hcC5maWd1cmUKICAgICAgICAgICAgaW1hZ2UgPSBmIi4vR2VuZXJhdGVkL2ltYWdlcy97a2V5fS5qcGciCiAgICAgICAgICAgIGZpZy5zYXZlZmlnKGltYWdlLCBkcGk9NjAwKQogICAgICAgICAgICBwcmludChmIlNhdmVkICEge2ltYWdlfSIpCiAgICByZXR1cm4gbWRmCg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACLPAAAAAAAAIs8AAAAAAAAAAAAAAAA8L8"
				]
			]
		}
	],
	"build_system": "",
	"build_system_choices":
	[
		[
			[
				[
					"Packages/Python/Python.sublime-build",
					""
				],
				[
					"Packages/Python/Python.sublime-build",
					"Syntax Check"
				]
			],
			[
				"Packages/Python/Python.sublime-build",
				"Syntax Check"
			]
		]
	],
	"build_varint": "",
	"command_palette":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"doc",
				"AutoDocstring: Current"
			],
			[
				"install",
				"Package Control: Install Package"
			],
			[
				"fix",
				"Python Fix Imports"
			],
			[
				"inde",
				"Indentation: Convert to Spaces"
			]
		],
		"width": 0.0
	},
	"console":
	{
		"height": 0.0,
		"history":
		[
		]
	},
	"distraction_free":
	{
		"menu_visible": true,
		"show_minimap": false,
		"show_open_files": false,
		"show_tabs": false,
		"side_bar_visible": false,
		"status_bar_visible": false
	},
	"expanded_folders":
	[
		"/Z/home/lab09/SPACE/Rahul-Iikwon",
		"/Z/home/lab09/SPACE/Rahul-Iikwon/csfdock"
	],
	"file_history":
	[
		"/Z/home/lab09/SPACE/Rahul-Iikwon/Generated/jobs/3eml/3eml_ligand_output_dkoes_scoring_old.pdb",
		"/Z/home/lab09/SPACE/Rahul-Iikwon/Generated/jobs/3eml/run/3eml_SMina.sh",
		"/Z/home/lab09/SPACE/Rahul-Iikwon/csfdock/DVisualize.py",
		"/Z/home/lab09/SPACE/Rahul-Iikwon/csfdock/Project.py",
		"/Z/home/lab09/SPACE/Rahul-Iikwon/csfdock/DockingTools.py",
		"/Z/home/lab09/DOCKER/CSF/DATA/Actives/6nzp_active_complete.sdf",
		"/Z/home/lab09/POSTGRES/docker-compose.yml",
		"/Z/home/lab09/DOCKER/CSF/DATA/Inactive/6nzp_decoy_complete.sdf",
		"/Z/home/lab09/DOCKER/CSF/DATA/Inactive/6nzp_decoy_complete_fix.sdf",
		"/Z/home/lab09/DOCKER/CSF/data/Inactive/dude-decoys/decoys/6nzp_all_decoys.smi",
		"/Z/home/lab09/DOCKER/CSF/scores.txt",
		"/Z/home/lab09/DOCKER/6NZP/Generated/data/6nzp_best.pdbqt",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/Generated/2rgp.pdb",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/DATA/membrane.pdb",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/Scripts/utils.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/Scripts/ar2a_v3.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/Scripts/MolView.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/Scripts/ServerPath.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/Scripts/DVisualize.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/Scripts/DockingTools.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/Scripts/__init__.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/Scripts/main.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/ar2a_v3.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/DockingTools.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/data/6NZP/Utility.py",
		"/Z/home/lab09/DOCKER/gpu-jupyter/.build/start.sh",
		"/Z/home/lab09/DOCKER/gpu-jupyter/build_push_all.sh",
		"/Z/home/lab09/DOCKER/gpu-jupyter/.build/docker-stacks/base-notebook/start.sh",
		"/Z/home/lab09/DOCKER/gpu-jupyter/.build/docker-stacks/base-notebook/Dockerfile.ppc64le.patch",
		"/Z/home/lab09/DOCKER/gpu-jupyter/.build/docker-stacks/base-notebook/Dockerfile",
		"/Z/home/lab09/DOCKER/gpu-jupyter/.build/Dockerfile",
		"/Z/home/lab09/DOCKER/Rahul-IIkwon/ar2a_v3.py",
		"/Z/home/lab09/DOCKER/Rahul-IIkwon/KinaseModules.py",
		"/Z/home/lab09/DOCKER/Rahul-IIkwon/ar2r.py",
		"/Z/home/lab09/DOCKER/DEV/Kinase_CLassifier/KC/KinaseModules.py",
		"/Z/home/lab09/DOCKER/Rahul-IIkwon/RawData/smiles/Conformer3D_CID_2244.sdf"
	],
	"find":
	{
		"height": 27.0
	},
	"find_in_files":
	{
		"height": 0.0,
		"where_history":
		[
		]
	},
	"find_state":
	{
		"case_sensitive": false,
		"find_history":
		[
			"obabel",
			"Nomatch",
			"dir_name_"
		],
		"highlight": true,
		"in_selection": false,
		"preserve_case": false,
		"regex": false,
		"replace_history":
		[
			"nomatch",
			"dir_name"
		],
		"reverse": false,
		"scrollbar_highlights": true,
		"show_context": true,
		"use_buffer2": true,
		"use_gitignore": true,
		"whole_word": false,
		"wrap": true
	},
	"groups":
	[
		{
			"sheets":
			[
				{
					"buffer": 0,
					"file": "Project.py",
					"semi_transient": true,
					"settings":
					{
						"buffer_size": 10100,
						"regions":
						{
						},
						"selection":
						[
							[
								0,
								0
							]
						],
						"settings":
						{
							"bracket_highlighter.busy": false,
							"bracket_highlighter.locations":
							{
								"close":
								{
								},
								"icon":
								{
								},
								"open":
								{
								},
								"unmatched":
								{
								}
							},
							"bracket_highlighter.regions":
							[
								"bh_double_quote",
								"bh_double_quote_center",
								"bh_double_quote_open",
								"bh_double_quote_close",
								"bh_double_quote_content",
								"bh_square",
								"bh_square_center",
								"bh_square_open",
								"bh_square_close",
								"bh_square_content",
								"bh_default",
								"bh_default_center",
								"bh_default_open",
								"bh_default_close",
								"bh_default_content",
								"bh_curly",
								"bh_curly_center",
								"bh_curly_open",
								"bh_curly_close",
								"bh_curly_content",
								"bh_c_define",
								"bh_c_define_center",
								"bh_c_define_open",
								"bh_c_define_close",
								"bh_c_define_content",
								"bh_angle",
								"bh_angle_center",
								"bh_angle_open",
								"bh_angle_close",
								"bh_angle_content",
								"bh_tag",
								"bh_tag_center",
								"bh_tag_open",
								"bh_tag_close",
								"bh_tag_content",
								"bh_unmatched",
								"bh_unmatched_center",
								"bh_unmatched_open",
								"bh_unmatched_close",
								"bh_unmatched_content",
								"bh_round",
								"bh_round_center",
								"bh_round_open",
								"bh_round_close",
								"bh_round_content",
								"bh_regex",
								"bh_regex_center",
								"bh_regex_open",
								"bh_regex_close",
								"bh_regex_content",
								"bh_single_quote",
								"bh_single_quote_center",
								"bh_single_quote_open",
								"bh_single_quote_close",
								"bh_single_quote_content"
							],
							"syntax": "Packages/Python/Python.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 1,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 1,
					"file": "DockingTools.py",
					"selected": true,
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 37840,
						"regions":
						{
						},
						"selection":
						[
							[
								13647,
								13644
							]
						],
						"settings":
						{
							"auto_complete": false,
							"bracket_highlighter.busy": false,
							"bracket_highlighter.locations":
							{
								"close":
								{
									"1":
									[
										13645,
										13646
									]
								},
								"icon":
								{
									"1":
									[
										"Packages/BracketHighlighter/icons/round_bracket.png",
										"region.yellowish"
									]
								},
								"open":
								{
									"1":
									[
										13531,
										13532
									]
								},
								"unmatched":
								{
								}
							},
							"bracket_highlighter.regions":
							[
								"bh_double_quote",
								"bh_double_quote_center",
								"bh_double_quote_open",
								"bh_double_quote_close",
								"bh_double_quote_content",
								"bh_square",
								"bh_square_center",
								"bh_square_open",
								"bh_square_close",
								"bh_square_content",
								"bh_default",
								"bh_default_center",
								"bh_default_open",
								"bh_default_close",
								"bh_default_content",
								"bh_curly",
								"bh_curly_center",
								"bh_curly_open",
								"bh_curly_close",
								"bh_curly_content",
								"bh_c_define",
								"bh_c_define_center",
								"bh_c_define_open",
								"bh_c_define_close",
								"bh_c_define_content",
								"bh_angle",
								"bh_angle_center",
								"bh_angle_open",
								"bh_angle_close",
								"bh_angle_content",
								"bh_tag",
								"bh_tag_center",
								"bh_tag_open",
								"bh_tag_close",
								"bh_tag_content",
								"bh_unmatched",
								"bh_unmatched_center",
								"bh_unmatched_open",
								"bh_unmatched_close",
								"bh_unmatched_content",
								"bh_round",
								"bh_round_center",
								"bh_round_open",
								"bh_round_close",
								"bh_round_content",
								"bh_regex",
								"bh_regex_center",
								"bh_regex_open",
								"bh_regex_close",
								"bh_regex_content",
								"bh_single_quote",
								"bh_single_quote_center",
								"bh_single_quote_open",
								"bh_single_quote_close",
								"bh_single_quote_content"
							],
							"syntax": "Packages/Python/Python.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 14940.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		}
	],
	"incremental_find":
	{
		"height": 27.0
	},
	"input":
	{
		"height": 39.0
	},
	"layout":
	{
		"cells":
		[
			[
				0,
				0,
				1,
				1
			]
		],
		"cols":
		[
			0.0,
			1.0
		],
		"rows":
		[
			0.0,
			1.0
		]
	},
	"menu_visible": true,
	"output.black":
	{
		"height": 126.0
	},
	"output.exec":
	{
		"height": 78.0
	},
	"output.find_results":
	{
		"height": 0.0
	},
	"output.mdpopups":
	{
		"height": 0.0
	},
	"pinned_build_system": "",
	"project": "Rahul-iikwon.sublime-project",
	"replace":
	{
		"height": 50.0
	},
	"save_all_on_build": true,
	"select_file":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"select_project":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"select_symbol":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"selected_group": 0,
	"settings":
	{
	},
	"show_minimap": true,
	"show_open_files": true,
	"show_tabs": true,
	"side_bar_visible": true,
	"side_bar_width": 121.0,
	"status_bar_visible": true,
	"template_settings":
	{
	}
}
